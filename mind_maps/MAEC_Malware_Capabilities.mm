<map version="1.0.1">
<!-- To view this file, download free mind mapping software FreeMind from http://freemind.sourceforge.net -->
<node BACKGROUND_COLOR="#00ccff" CREATED="1367952710657" ID="ID_50716996" MODIFIED="1389726050959" TEXT="Malware Capabilities">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Behavioral and Structural Properties of Malicious Code, Christopher Kruegel, http://www.cs.ucsb.edu/~chris/research/doc/malware05_behavior.pdf
    </p>
  </body>
</html>
</richcontent>
<font BOLD="true" NAME="SansSerif" SIZE="24"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1367952821953" ID="ID_723897181" MODIFIED="1389278145726" POSITION="left" TEXT="Self-Defense">
<arrowlink DESTINATION="ID_723897181" ENDARROW="Default" ENDINCLINATION="0;0;" ID="Arrow_ID_237392638" STARTARROW="None" STARTINCLINATION="0;0;"/>
<linktarget COLOR="#b0b0b0" DESTINATION="ID_723897181" ENDARROW="Default" ENDINCLINATION="0;0;" ID="Arrow_ID_237392638" SOURCE="ID_723897181" STARTARROW="None" STARTINCLINATION="0;0;"/>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1368018612360" ID="ID_599163588" MODIFIED="1389278164452" TEXT="Anti Reverse-Engineering">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ccccff" CREATED="1368018759520" ID="ID_224604105" MODIFIED="1389278165940" TEXT="Anti-Behavioral Analysis">
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<attribute NAME="Description" VALUE="The Anti-Behavioral Analysis mechanism is intended to capture the various objectives and methods that malware may attempt to achieve in terms of preventing itself from being analyzed using behavioral analysis techniques, such as sandboxing."/>
<attribute NAME="Sources" VALUE=""/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1373396036048" ID="ID_1934430568" MODIFIED="1389278167764" TEXT="Anti-VM">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1326820865530" FOLDED="true" ID="ID_202195017" MODIFIED="1389278160845" TEXT="Detect Execution in VM">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369322933181" ID="ID_1645063862" MODIFIED="1373918254195" TEXT="Timing Checks">
<attribute_layout NAME_WIDTH="116" VALUE_WIDTH="116"/>
<attribute NAME="Affected Hypervisors" VALUE="ALL"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369322890015" ID="ID_187213668" MODIFIED="1373918255677" TEXT="Invalid x86 Instruction Exception Handling">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.fireeye.com/blog/technical/2011/01/the-dead-giveaways-of-vm-aware-malware.html
    </p>
  </body>
</html></richcontent>
<attribute_layout NAME_WIDTH="116" VALUE_WIDTH="116"/>
<attribute NAME="Affected Hypervisors" VALUE="Virtual PC"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369327408380" FOLDED="true" ID="ID_398954782" MODIFIED="1389278160845" TEXT="Driver Checks">
<arrowlink DESTINATION="ID_398954782" ENDARROW="Default" ENDINCLINATION="0;0;" ID="Arrow_ID_627700634" STARTARROW="None" STARTINCLINATION="0;0;"/>
<linktarget COLOR="#b0b0b0" DESTINATION="ID_398954782" ENDARROW="Default" ENDINCLINATION="0;0;" ID="Arrow_ID_627700634" SOURCE="ID_398954782" STARTARROW="None" STARTINCLINATION="0;0;"/>
<attribute_layout NAME_WIDTH="116" VALUE_WIDTH="116"/>
<attribute NAME="Affected Hypervisors" VALUE="VMWare"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1369327420972" FOLDED="true" ID="ID_1088482403" MODIFIED="1389278160844" TEXT="Hard Drive Driver">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369327460285" ID="ID_831305167" MODIFIED="1373400486104" TEXT="DiskVMware_Virtual_IDE_Hard_ Drive">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://vrt-blog.snort.org/2009/10/how-does-malware-know-difference.html
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1369327434968" FOLDED="true" ID="ID_959405113" MODIFIED="1389278160844" TEXT="Video Driver">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369327471272" ID="ID_1257339921" MODIFIED="1373400488228" TEXT="DriverDesc VMware SVGA II">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://vrt-blog.snort.org/2009/10/how-does-malware-know-difference.html
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1369327445171" FOLDED="true" ID="ID_1818216543" MODIFIED="1389278160844" TEXT="Mouse Driver">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369327479347" ID="ID_1716252241" MODIFIED="1373400489954" TEXT="%WINDIR%\system32\drivers\vmmouse.sys">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://vrt-blog.snort.org/2009/10/how-does-malware-know-difference.html
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369322855654" ID="ID_697884210" MODIFIED="1373918258094" TEXT="Backdoor I/O">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.fireeye.com/blog/technical/2011/01/the-dead-giveaways-of-vm-aware-malware.html
    </p>
  </body>
</html></richcontent>
<attribute_layout NAME_WIDTH="116" VALUE_WIDTH="116"/>
<attribute NAME="Affected Hypervisors" VALUE="VMWare"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327410205157" ID="ID_1564765637" MODIFIED="1373918259322" TEXT="LDTR Checks">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://go.eset.com/us/resources/white-papers/TDL3-Analysis.pdf
    </p>
  </body>
</html></richcontent>
<attribute_layout NAME_WIDTH="116" VALUE_WIDTH="116"/>
<attribute NAME="Affected Hypervisors" VALUE="??"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1326820898594" ID="ID_1483623393" MODIFIED="1374006028100" TEXT="Prevent Execution in VM">
<font NAME="SansSerif" SIZE="13"/>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1373396041794" ID="ID_266845690" MODIFIED="1389278168532" TEXT="Anti-Sandbox">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1369322549868" FOLDED="true" ID="ID_852085240" MODIFIED="1389278160844" TEXT="Detect Sandbox Environment">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369322706572" ID="ID_205504592" MODIFIED="1373918275917" TEXT="dbgHelp.dll Detection">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.fireeye.com/blog/technical/2011/01/the-dead-giveaways-of-vm-aware-malware.html
    </p>
  </body>
</html></richcontent>
<attribute_layout NAME_WIDTH="114" VALUE_WIDTH="114"/>
<attribute NAME="Affected Sandboxes" VALUE="ThreatExpert"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369322751806" ID="ID_552438091" MODIFIED="1373918277303" TEXT="Product Key Comparison">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.fireeye.com/blog/technical/2011/01/the-dead-giveaways-of-vm-aware-malware.html
    </p>
  </body>
</html></richcontent>
<attribute_layout NAME_WIDTH="114" VALUE_WIDTH="163"/>
<attribute NAME="Affected Sandboxes" VALUE="JoeBox, GFI Sandbox, Anubis"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1370454792497" FOLDED="true" ID="ID_1297804802" MODIFIED="1389278160844" TEXT="Overload Sandbox">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1370454823729" ID="ID_1988438186" MODIFIED="1373399937520" TEXT="sleep(0) Loop">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://joe4security.blogspot.ch/2013/06/overloading-sandboxes-new-generic.html
    </p>
  </body>
</html></richcontent>
<attribute NAME="Affected Sandboxes" VALUE="All Sandboxes"/>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ccccff" CREATED="1373469569726" ID="ID_370385451" MODIFIED="1389278166781" STYLE="fork" TEXT="Anti-Code Analysis">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      I think this should be called &quot;Anti Code Analysis&quot; instead of &quot;Anti Source Code Analysis&quot;
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<attribute NAME="Description" VALUE="The Anti-Code Analysis mechanism is intended to capture the various objectives and methods that malware may implement to prevent its source code being analyzed, such as through the use of a disassembler."/>
<attribute NAME="Sources" VALUE=""/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1373394946617" ID="ID_865651030" MODIFIED="1389278169326" TEXT="Anti-Debugging">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373395017480" FOLDED="true" ID="ID_1959263358" MODIFIED="1389278160843" TEXT="Detect Debugging">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368037187921" FOLDED="true" ID="ID_1615860906" MODIFIED="1389278160843" TEXT="API Call Checking">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1304865608531" ID="ID_897014010" MODIFIED="1372179640131" TEXT="nt*.exe: IsDebuggerPresent()"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368037703930" ID="ID_1230825620" MODIFIED="1372179640131" TEXT="nt*.exe: CheckRemoteDebuggerPresent() "/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368037755092" ID="ID_1968773236" MODIFIED="1372179640131" TEXT="nt*.exe: NtQueryInformationProcess(ProcessDebugPort)"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368037842752" ID="ID_612311790" MODIFIED="1372179640131" TEXT="nt*.exe: NtQueryInformationProcess(ProcessDebugObjectHandle)"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368037842752" ID="ID_1997670444" MODIFIED="1372179640131" TEXT="nt*.exe: NtQueryInformationProcess(SystemKernelDebuggerInformation)"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368037953133" ID="ID_461383793" MODIFIED="1372179640131" TEXT="nt*.exe: RtlQueryProcessDebugInformation()"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368038015809" ID="ID_1587813347" MODIFIED="1372179640131" TEXT="nt*.exe: OutputDebugString()"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327263329451" ID="ID_295942679" MODIFIED="1373395252898" TEXT="ntdll.dll:{Nt,Zw}SetInformationThread()"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327263441220" ID="ID_242798937" MODIFIED="1373401689596" TEXT="kernel32.dll!CloseHandle()"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327263449340" ID="ID_1024147777" MODIFIED="1373401704212" TEXT="ntdll.dll:{Nt,Zw}Close()"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368038189630" ID="ID_1964791620" MODIFIED="1372170431147" TEXT="Hardware Breakpoints"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368038227477" ID="ID_222301515" MODIFIED="1372170431147" TEXT="Device Name Checks"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368038367685" ID="ID_1200641195" MODIFIED="1372170431146" TEXT="Heap Flags"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368038430191" FOLDED="true" ID="ID_141412169" MODIFIED="1389278160843" TEXT="Execution Timing">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368038444209" ID="ID_1050588670" MODIFIED="1372179656017" TEXT="RDTSC"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368038453537" ID="ID_1078708678" MODIFIED="1372179656018" TEXT="RDPMC"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368038458793" ID="ID_1707721350" MODIFIED="1372179656018" TEXT="RDMSR"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368038476810" ID="ID_126651976" MODIFIED="1372179656018" TEXT="nt*.exe: GetTickCount()"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368038496027" ID="ID_15851632" MODIFIED="1372179656018" TEXT="nt*.exe: GetLocalTime() "/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368038504106" ID="ID_479256484" MODIFIED="1372179656018" TEXT="nt*.exe: GetSystemTime()"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368038476810" ID="ID_318645623" MODIFIED="1372179656018" TEXT="nt*.exe: QueryPerformanceCounter()"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368038698343" ID="ID_725058530" MODIFIED="1372179656018" TEXT="winmm: timeGetTime"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368038739970" ID="ID_1877503142" MODIFIED="1372179657579" TEXT="Thread Hiding"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368038794441" ID="ID_621559091" MODIFIED="1372170431145" TEXT="Instruction Counting"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368038970098" FOLDED="true" ID="ID_197538086" MODIFIED="1389278160842" TEXT="Self-Debugging">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327263514205" ID="ID_407755273" MODIFIED="1373395192064" TEXT="kernel32.dll:DebugActiveProcess()"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327263530797" ID="ID_1840585191" MODIFIED="1373395192065" TEXT="ntdll.dll:DbgUiDebugActiveProcess()"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327263553501" ID="ID_1550945090" MODIFIED="1373395192064" TEXT="ntdll.dll:{Nt,Zw}DebugActiveProcess()"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327263388355" ID="ID_1529074072" MODIFIED="1373401546851" TEXT="UnhandledExceptionFilter"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373401832362" FOLDED="true" ID="ID_134969967" MODIFIED="1389278160842" TEXT="PEB Checking">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327263239858" ID="ID_1939383139" MODIFIED="1373401874923" TEXT="PEB.IsDebugged">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.symantec.com/connect/articles/windows-anti-debug-reference
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327263255146" ID="ID_2518077" MODIFIED="1373401873353" TEXT="PEB.NtGlobalFlags">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.symantec.com/connect/articles/windows-anti-debug-reference
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373395019675" FOLDED="true" ID="ID_1610675446" MODIFIED="1389278160842" TEXT="Prevent Debugging">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378649130967" ID="ID_1166302277" MODIFIED="1378649207434" STYLE="fork" TEXT="Use Killer Thread">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      kills malicius program if it seems to be running with a debugger; The MAL: A Malware Analysis Lexicon
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1368029357807" ID="ID_1660856473" MODIFIED="1389278169979" TEXT="Anti-Disassembly">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373379901408" FOLDED="true" ID="ID_1762591780" MODIFIED="1389278160842" TEXT="Defeat Linear Disassembler">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368035253626" ID="ID_1969990338" MODIFIED="1373380344506" TEXT="Garbage Bytes">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: <a href="http://research.dissect.pe/docs/blackhat2012-paper.pdf">http://research.dissect.pe/docs/blackhat2012-paper.pdf</a>
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368035259945" FOLDED="true" ID="ID_646769338" MODIFIED="1389278160842" TEXT="Program Control Flow Change">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: <a href="http://research.dissect.pe/docs/blackhat2012-paper.pdf">http://research.dissect.pe/docs/blackhat2012-paper.pdf</a>
    </p>
  </body>
</html></richcontent>
<node BACKGROUND_COLOR="#cccc00" CREATED="1368035270778" ID="ID_1827319436" MODIFIED="1372179792545" TEXT="Direct"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1368035278440" ID="ID_120192100" MODIFIED="1372179798185" TEXT="Indirect"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368035945519" ID="ID_1698286923" MODIFIED="1373380404341" TEXT="Default Function Return Address Modification">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: <a href="http://research.dissect.pe/docs/blackhat2012-paper.pdf">http://research.dissect.pe/docs/blackhat2012-paper.pdf</a>
    </p>
    <p>
      
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368035310942" FOLDED="true" ID="ID_971562714" MODIFIED="1389278160841" TEXT="Flow Redirection">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: <a href="http://research.dissect.pe/docs/blackhat2012-paper.pdf">http://research.dissect.pe/docs/blackhat2012-paper.pdf</a>
    </p>
    <p>
      
    </p>
  </body>
</html></richcontent>
<node BACKGROUND_COLOR="#cccc00" CREATED="1368035320029" ID="ID_748498089" MODIFIED="1372179777856" TEXT="Redirection into other instructions"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1368035328478" ID="ID_1126848281" MODIFIED="1372179777856" TEXT="Redirection into self"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368035283807" FOLDED="true" ID="ID_580497434" MODIFIED="1389278160841" TEXT="Fake Conditional Jumps">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: <a href="http://research.dissect.pe/docs/blackhat2012-paper.pdf">http://research.dissect.pe/docs/blackhat2012-paper.pdf</a>
    </p>
    <p>
      
    </p>
  </body>
</html></richcontent>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368035289854" ID="ID_335564234" MODIFIED="1372179767811" TEXT="XOR"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368035294688" ID="ID_231990405" MODIFIED="1372179767811" TEXT="STC"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368035299006" ID="ID_1382506783" MODIFIED="1372179767811" TEXT="CLC"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373379908574" FOLDED="true" ID="ID_1907918653" MODIFIED="1389278160841" TEXT="Defeat Flow-oriented (Recursive Traversal) Disassembler">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368035253626" ID="ID_214435882" MODIFIED="1373380344506" TEXT="Garbage Bytes">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: <a href="http://research.dissect.pe/docs/blackhat2012-paper.pdf">http://research.dissect.pe/docs/blackhat2012-paper.pdf</a>
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368035945519" ID="ID_160247828" MODIFIED="1373380404341" TEXT="Default Function Return Address Modification">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: <a href="http://research.dissect.pe/docs/blackhat2012-paper.pdf">http://research.dissect.pe/docs/blackhat2012-paper.pdf</a>
    </p>
    <p>
      
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368035310942" FOLDED="true" ID="ID_1746040434" MODIFIED="1389278160841" TEXT="Flow Redirection">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: <a href="http://research.dissect.pe/docs/blackhat2012-paper.pdf">http://research.dissect.pe/docs/blackhat2012-paper.pdf</a>
    </p>
    <p>
      
    </p>
  </body>
</html></richcontent>
<node BACKGROUND_COLOR="#cccc00" CREATED="1368035320029" ID="ID_1568603682" MODIFIED="1372179777856" TEXT="Redirection into other instructions"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1368035328478" ID="ID_848390343" MODIFIED="1372179777856" TEXT="Redirection into self"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368035283807" FOLDED="true" ID="ID_1265624491" MODIFIED="1389278160841" TEXT="Fake Conditional Jumps">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      inserts into a false branch appears conditional but is really unconditional; ITW: <a href="http://research.dissect.pe/docs/blackhat2012-paper.pdf">http://research.dissect.pe/docs/blackhat2012-paper.pdf</a>
    </p>
  </body>
</html></richcontent>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368035289854" ID="ID_442508124" MODIFIED="1372179767811" TEXT="XOR"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368035294688" ID="ID_848392049" MODIFIED="1372179767811" TEXT="STC"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368035299006" ID="ID_378112634" MODIFIED="1372179767811" TEXT="CLC"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378653677368" ID="ID_1510873401" MODIFIED="1378653768604" STYLE="fork" TEXT="Interleaving Code">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Splits code into sections that are rearranged and connected by unconditional jumps; The MAL: A Malware Analysis Lexicon, CMU.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378486563095" FOLDED="true" ID="ID_1665599724" MODIFIED="1389278160841" STYLE="fork" TEXT="Defeat Call Graph Generation">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://fumalwareanalysis.blogspot.com/2012/01/malware-analysis-tutorial-10-tricks-for.html
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378486576197" ID="ID_706224577" MODIFIED="1378652175829" STYLE="fork" TEXT="Two-Layer Function Return">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378655613306" ID="ID_510494595" MODIFIED="1378655670529" STYLE="fork" TEXT="Obfuscate Imports">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Non-standard import table or otherwise hidden system calls
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378655744495" ID="ID_666707228" MODIFIED="1378655804576" STYLE="fork" TEXT="Restructure Arrays">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      obfuscates arrays by concatenating, interleaving, splitting, changing direction
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1367953155541" ID="ID_1146654785" MODIFIED="1389278171110" TEXT="Code Obfuscation">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373470052264" ID="ID_697784992" MODIFIED="1389621824675" TEXT="Obfuscate Runtime Code">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371239274781" ID="ID_263702696" MODIFIED="1378484643863" TEXT="Code Compression (Packing)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;http://www.recon.cx/2011/schedule/events/118.en.html
    </p>
  </body>
</html></richcontent>
<attribute_layout NAME_WIDTH="179" VALUE_WIDTH="696"/>
<attribute NAME="Layering" VALUE="Multiple Code Layer (LZMA Algorithm/PECOFF Processing), Single Code Layer"/>
<attribute NAME="Compression Algorithm" VALUE="Known, Custom"/>
<attribute NAME="Algorithm Usage" VALUE="Multiple Algorithms, Single Algorithm"/>
<attribute NAME="Encryption Algorithm" VALUE="Known, Custom"/>
<attribute NAME="Stub Code Location" VALUE="Separate Section, PE Header"/>
<attribute NAME="Stub Code Redirections" VALUE="Code Insertion over Specific Part of Uncompressed Stream in the First Section, Code Insertion at the End of Compressed Data"/>
<attribute NAME="Custom PECoff Table Processing" VALUE="Compressed Imports, Compressed Resources, Compressed Relocations"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371239328775" ID="ID_1601879186" MODIFIED="1378484975083" TEXT="Code Encryption">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.recon.cx/2011/schedule/events/118.en.html; http://blog.malwarebytes.org/intelligence/2013/03/obfuscation-malwares-best-friend/
    </p>
  </body>
</html></richcontent>
<attribute_layout NAME_WIDTH="117" VALUE_WIDTH="422"/>
<attribute NAME="Encryption Algorithm" VALUE="Known, Custom"/>
<attribute NAME="Layering" VALUE="Multiple Code Layer (LZMA Algorithm/PECOFF Processing), Single Code Layer"/>
<attribute NAME="Known Algorithm" VALUE="ROT13, Base64, XOR"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371239344883" ID="ID_1982735039" MODIFIED="1378485684696" TEXT="Virtualization Obfuscation">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.recon.cx/2011/schedule/events/118.en.html
    </p>
    <p>
      http://www.cs.arizona.edu/~debray/Publications/ccs-unvirtualize.pdf
    </p>
  </body>
</html></richcontent>
<attribute_layout NAME_WIDTH="33" VALUE_WIDTH="116"/>
<attribute NAME="Type" VALUE="Commercial, Custom"/>
<attribute NAME="Tool" VALUE="Themida, VMProtect"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371239471541" FOLDED="true" ID="ID_231553771" MODIFIED="1389712467469" TEXT="Entry Point Obfuscation">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1371239297001" ID="ID_1918510779" MODIFIED="1373475046149" TEXT="Polymorphic Decryptor/Entry">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.recon.cx/2011/schedule/events/118.en.html
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1371239493931" ID="ID_1847715487" MODIFIED="1373475047898" TEXT="Polymorphic Entry Point/Fake Identity">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.recon.cx/2011/schedule/events/118.en.html
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378486681857" FOLDED="true" ID="ID_681748189" MODIFIED="1389712469313" STYLE="fork" TEXT="Encoded Table Use">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://fumalwareanalysis.blogspot.com/2012/01/malware-analysis-tutorial-10-tricks-for.html
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378486717528" ID="ID_446060586" MODIFIED="1378658674233" STYLE="fork" TEXT="Invoke NTDLL System Calls">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378658684237" ID="ID_469460620" MODIFIED="1378658711733" STYLE="fork" TEXT="Spaghetti Packer Use">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373470114289" FOLDED="true" ID="ID_1805209585" MODIFIED="1389621820158" STYLE="fork" TEXT="Obfuscate Instructions">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      instructions are chosen to make RE more difficult.&#160;&#160;AKA &quot;computation transformation&quot;
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<attribute NAME="Applicable File Types" VALUE="PE/COFF"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1367953173052" ID="ID_1014606828" MODIFIED="1378652019340" TEXT="Function Call Substitution">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://research.dissect.pe/docs/blackhat2012-paper.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368031087033" ID="ID_1198628049" MODIFIED="1378652019340" TEXT="Stealth Import Win API">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://research.dissect.pe/docs/blackhat2012-paper.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368031094873" ID="ID_1929235212" MODIFIED="1378652019340" TEXT="PEB -&gt; LDR Address Resolving">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://research.dissect.pe/docs/blackhat2012-paper.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368031113248" ID="ID_660517754" MODIFIED="1378652019341" TEXT="Push Pop Math">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://research.dissect.pe/docs/blackhat2012-paper.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368031119807" ID="ID_1161529171" MODIFIED="1378652019341" TEXT="Instruction Substitution (Push Ret)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://research.dissect.pe/docs/blackhat2012-paper.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368031161173" ID="ID_1453515479" MODIFIED="1378652019341" TEXT="Register Reassignment">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://research.dissect.pe/docs/blackhat2012-paper.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368031174228" ID="ID_1993962407" MODIFIED="1378652019341" TEXT="Subroutine Reordering">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://research.dissect.pe/docs/blackhat2012-paper.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368031189067" ID="ID_727525660" MODIFIED="1378652019341" TEXT="Code Transposition">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://research.dissect.pe/docs/blackhat2012-paper.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368031247983" FOLDED="true" ID="ID_1750776583" MODIFIED="1389278160839" TEXT="Dead Code Insertion">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://research.dissect.pe/docs/blackhat2012-paper.pdf
    </p>
  </body>
</html></richcontent>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368031256504" ID="ID_351897081" MODIFIED="1378652019341" TEXT="NOP"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378649311972" ID="ID_680088216" MODIFIED="1378649361763" STYLE="fork">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ADD AL,0
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378658351888" ID="ID_1231822480" MODIFIED="1382624275343" STYLE="fork" TEXT="Transform Control Flow">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Modify original control flow structure (removing control flow info or adding new control flow statements) to make functionally equivalent program that is more difficult to understand; the MAL: A Malware Analysis Lexicon, CMU.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ccccff" CREATED="1368018652551" ID="ID_653214386" MODIFIED="1389278163657" TEXT="Anti-Removal">
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<attribute NAME="Description" VALUE="The Anti-Removal mechanism is intended to capture the various objectives and methods malware may implement to prevent itself and its components from being removed from a system, such as through the prevention of key files from being deleted."/>
<attribute NAME="Sources" VALUE=""/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1326820621847" ID="ID_1148810539" MODIFIED="1374005668885" TEXT="Prevent Memory Access">
<font NAME="SansSerif" SIZE="14"/>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1373389973072" ID="ID_248095954" MODIFIED="1389278173044" TEXT="Prevent Malware Artifact Deletion">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1326820583831" FOLDED="true" ID="ID_772153759" MODIFIED="1389278160839" TEXT="Prevent Registry Deletion">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326820741552" FOLDED="true" ID="ID_1558355127" MODIFIED="1389278160839" TEXT="Inline/IAT/EAT Hooking">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326820757248" ID="ID_114833901" MODIFIED="1373390456990" TEXT="ZwEnumerateValueKey(), ZwDeleteKey(), ZwDeleteValueKey(), ZwSetValueKey()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.symantec.com/avcenter/reference/techniques.of.adware.and.spyware.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326820754128" ID="ID_26920271" MODIFIED="1373390595904" TEXT="Periodic Check/Recreation">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://go.eset.com/us/resources/white-papers/TDL3-Analysis.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1326820559871" FOLDED="true" ID="ID_365482625" MODIFIED="1389278160839" TEXT="Prevent File Deletion">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327271665440" FOLDED="true" ID="ID_1638210802" MODIFIED="1389278160838" TEXT="Inline/IAT/EAT Hooking">
<node BACKGROUND_COLOR="#cccc00" CREATED="1327271658096" FOLDED="true" ID="ID_471731674" MODIFIED="1389278160838" TEXT="Userspace">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327271660056" ID="ID_1457157069" MODIFIED="1372179450959" TEXT="ZwSetInformationFile"/>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1327271651824" ID="ID_342513429" MODIFIED="1372179461762" TEXT="Kernel"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1327270540290" FOLDED="true" ID="ID_1429600050" MODIFIED="1389278160838" TEXT="Prevent API Unhooking">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327270544698" ID="ID_113482533" MODIFIED="1373399987074" TEXT="Periodic Check/Recreation">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.prevx.com/blog/168/SpyEye-the-infostealing-trojan-leader.html
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1373389990927" ID="ID_1063783395" MODIFIED="1389278173830" TEXT="Prevent Malware Artifact Access">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1326820564551" ID="ID_71580514" MODIFIED="1374006053020" TEXT="Prevent Registry Access">
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1326820543470" FOLDED="true" ID="ID_384734041" MODIFIED="1389278160838" TEXT="Prevent File Access">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326905806924" FOLDED="true" ID="ID_1867193241" MODIFIED="1389278160838" TEXT="Inline/IAT/EAT Hooking">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326905815460" ID="ID_1016825011" MODIFIED="1373390423110" TEXT="Userspace"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326905813172" ID="ID_879645329" MODIFIED="1372179471789" TEXT="Kernel"/>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ccccff" CREATED="1304619559685" ID="ID_1610807793" MODIFIED="1389278175372" TEXT="Anti-Detection">
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372790239301" ID="ID_1926387409" MODIFIED="1389366302960" TEXT="Hide Malware Artifacts">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372790271683" FOLDED="true" ID="ID_473282883" MODIFIED="1389366336831" TEXT="Hide File System Artifacts">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1305669843026" FOLDED="true" ID="ID_1604476839" MODIFIED="1389278160837" TEXT="Raw sector storage">
<node BACKGROUND_COLOR="#cccc00" CREATED="1372791011918" ID="ID_1269800924" MODIFIED="1373988533836" TEXT="Kernel (Ring 0)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://go.eset.com/us/resources/white-papers/TDL3-Analysis.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1304619980758" FOLDED="true" ID="ID_1128902201" MODIFIED="1389278160837" TEXT="IO Request Packet (IRP) Filtering">
<node CREATED="1327099647643" ID="ID_381670888" MODIFIED="1327099661694" TEXT="Also See Inline Hooking"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1372791011918" FOLDED="true" ID="ID_1059362829" MODIFIED="1389278160837" TEXT="Kernel (Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326825107800" ID="ID_1087728089" MODIFIED="1373988547330" TEXT="Register Filter Driver">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_stuxnet_dossier.pdf
    </p>
    <p>
      ITW:http://av-school.com/blogs/comment/201 (Trojan.Win32.DNSChanger.imv)
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1327066099255" FOLDED="true" ID="ID_1345527395" MODIFIED="1389278160837" TEXT="DKOM">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326825162840" ID="ID_1751014867" MODIFIED="1373988567515" TEXT="Hook nt!pIofCallDriver() function pointer&#xa;(arguable if DKOM or not, since it&apos;s just a single global)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.sunbeltsecurity.com/dl/WhatMakesRustocksTick.pdf
    </p>
    <p>
      ITW: http://www.reconstructer.org/papers/Hunting%20rootkits%20with%20Windbg.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326825122896" ID="ID_866930225" MODIFIED="1373988577166" TEXT="KOH - Hook DRIVER_OBJECT.MajorFunction[] function pointers&#xa;for a target driver&apos;s DRIVER_OBJECT">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: He4Hook src - he4dev.e1.bmstu.ru/__he4hook_v21a_20021110.zip
    </p>
    <p>
      ITW: http://av-school.com/blogs/comment/201 (Backdoor.Win32.Sinowal.c)
    </p>
    <p>
      ITW: http://www.f-secure.com/weblog/archives/00001393.html
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327066173239" ID="ID_1313541254" MODIFIED="1373988616565" TEXT="KOH - Hook DRIVER_OBJECT.DriverStartIO">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://blogs.technet.com/b/mmpc/archive/2011/06/22/don-t-write-it-read-it-instead.aspx
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326807856992" FOLDED="true" ID="ID_1449114887" MODIFIED="1389278160835" TEXT="Hooking ALL System Calls...&#xa;to intercept only NtQueryDirectoryFile(), NtReadFile(),&#xa;NtVdmControl()">
<node BACKGROUND_COLOR="#cccc00" CREATED="1372791079307" FOLDED="true" ID="ID_651941134" MODIFIED="1389278160835" TEXT="Kernel (Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326807920009" ID="ID_774890696" MODIFIED="1372180272147" TEXT="Hook IDT index 0x2E&#xa;(Windows &lt;= 2000)"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326822424860" ID="ID_20667364" MODIFIED="1372180272145" TEXT="Inline hook nt*.exe:KiSystemService()&#xa;(Windows &lt;= 2000)"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326807944329" ID="ID_625886959" MODIFIED="1373988657788" TEXT="Modify IA32_SYSENTER_EIP &#xa;model specific register (MSR)&#xa;(Windows &gt;= XP)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: I know there used to be a PoC in butler's folder on rootkit.com since I used it in the class
    </p>
    <p>
      ITW (&quot;Rustock A&quot;)http://www.sunbeltsecurity.com/dl/WhatMakesRustocksTick.pdf
    </p>
    <p>
      ITW: (&quot;Rustock B&quot;)http://www.reconstructer.org/papers/Hunting%20rootkits%20with%20Windbg.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326808011618" ID="ID_813197987" MODIFIED="1372180272139" TEXT="Inline hook nt*.exe:KiFastCallEntry()&#xa;(Windows &gt;= XP)"/>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326894520111" FOLDED="true" ID="ID_1458635414" MODIFIED="1389278160834" TEXT="Userspace&#xa;(Ring 3)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326808011618" ID="ID_1556193236" MODIFIED="1373988636795" TEXT="Hook KUSER_SHARED_DATA&#xa;(code &lt; XPSP2, function pointer &gt;= XPSP2)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://uninformed.org/index.cgi?v=3&amp;a=4&amp;p=22
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1304619851957" FOLDED="true" ID="ID_758305175" MODIFIED="1389278160833" TEXT="System Service Descriptor Table (SSDT) Hooking&#xa;of NtQueryDirectoryFile(), NtReadFile(), NtVdmControl()">
<font NAME="SansSerif" SIZE="12"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1372791456156" FOLDED="true" ID="ID_1741292665" MODIFIED="1389278160833" TEXT="Kernel (Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326808074076" ID="ID_1625768004" MODIFIED="1372180300221" TEXT="(&quot;default&quot; SSDT hooking)&#xa;Modify table pointed to by nt!KiServiceTable (&quot;normal SSDT&quot;) or &#xa;win32k!W32pServiceTable (&quot;shadow SSDT&quot;) symbols to hook function pointers."/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326822582820" ID="ID_16951551" MODIFIED="1372180300219" TEXT="DKOM table pointed to by nt!KeServiceDescriptorTable or &#xa;nt!KeServiceDescriptorTableShadow symbols. These symbols point &#xa;at a SystemServiceDescriptorTable struct. Modify ServiceTableBase &#xa;field (offset 0) to point at non-default SSDT with hooked function pointers."/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326823333311" ID="ID_377680" MODIFIED="1373988707607" TEXT="DKOM thread objects to point Tcb.ServiceTable field at location&#xa;other than those pointed to by nt!KeServiceDescriptorTable{Shadow}&#xa;and have the pointed to SystemServiceDescriptorTable structure&apos;s&#xa;ServiceTableBase point to a non-default SSDT with hooked function pointers">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://moyix.blogspot.com/2008/08/auditing-system-call-table.html
    </p>
    <p>
      http://code.google.com/p/volatility/wiki/CommandReference#ssdt
    </p>
    <p>
      ITW: http://av-school.com/blogs/comment/201 (Rootkit.Win32.Agent.hki)
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1304619836966" FOLDED="true" ID="ID_1413819269" MODIFIED="1389278160832" TEXT="Inline/Import Address Table (IAT)/Export Address Table(EAT) Hooking">
<node BACKGROUND_COLOR="#cccc00" CREATED="1372791456156" FOLDED="true" ID="ID_1071973485" MODIFIED="1389278160832" TEXT="Kernel (Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326825648260" ID="ID_142075798" MODIFIED="1373988722484" TEXT="nt*.exe:{Zw,Nt}QueryDirectoryFile()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_stuxnet_dossier.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326807806440" ID="ID_207488984" MODIFIED="1373988729267" TEXT="nt*.exe:{Zw,Nt}ReadFile()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_stuxnet_dossier.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326912588011" ID="ID_186351903" MODIFIED="1373988770071" TEXT="nt*.exe:{Nt,Zw}VdmControl()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW/TUT:http://vxheavens.com/lib/vhf00.html
    </p>
    <p>
      ITW:http://www.prevx.com/blog/168/SpyEye-the-infostealing-trojan-leader.html
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327014996223" ID="ID_384699968" MODIFIED="1373988780492" TEXT="nt*.exe:IofCallDriver() + IRP filtering">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.securelist.com/en/analysis/204792131/TDSS
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327014996223" ID="ID_1974444798" MODIFIED="1373988791019" TEXT="nt*.exe:IofCompleteRequest() + IRP filtering">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.securelist.com/en/analysis/204792131/TDSS
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326894520111" ID="ID_920655047" MODIFIED="1372791542422" TEXT="Userspace&#xa;(Ring 3)"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1308052727981" ID="ID_43139193" MODIFIED="1373988804812" TEXT="NTFS Alternate Data Streams">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: (&quot;Rustock A&quot;) http://www.f-secure.com/weblog/archives/archive-062006.html
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326810006893" ID="ID_245584467" MODIFIED="1373988817317" TEXT="Set HIDDEN and/or SYSTEM (not shown by default) filesystem attributes">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      cite:http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/attrib.mspx?mfr=true
    </p>
    <p>
      
    </p>
    <p>
      cite: http://www.blackhat.com/presentations/bh-europe-04/bh-eu-04-erdelyi/bh-eu-04-erdelyi.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1304619836966" FOLDED="true" ID="ID_500842710" MODIFIED="1389278160832" TEXT="Inline/Import Address Table (IAT)/Export Address Table(EAT) Hooking">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326894520111" FOLDED="true" ID="ID_1904641228" MODIFIED="1389278160831" TEXT="Userspace&#xa;(Ring 3)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1304621721261" ID="ID_718933452" MODIFIED="1373988829314" TEXT="kernel32.dll:FindFirstFile{A,W}()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.symantec.com/avcenter/reference/techniques.of.adware.and.spyware.pdf
    </p>
    <p>
      ITW:http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_stuxnet_dossier.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1304865756634" ID="ID_1804409573" MODIFIED="1373988860438" TEXT="kernel32.dll:FindFirstFileEx{A,W}()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.symantec.com/avcenter/reference/techniques.of.adware.and.spyware.pdf
    </p>
    <p>
      ITW:http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_stuxnet_dossier.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1304865766484" ID="ID_928312625" MODIFIED="1373988873962" TEXT="kernel32.dll:FindNextFile{A,W}()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.symantec.com/avcenter/reference/techniques.of.adware.and.spyware.pdf
    </p>
    <p>
      ITW:http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_stuxnet_dossier.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326825648260" ID="ID_506087179" MODIFIED="1373988882899" TEXT="ntdll.dll:{Zw,Nt}QueryDirectoryFile()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_stuxnet_dossier.pdf
    </p>
    <p>
      ITW/TUT:http://vxheavens.com/lib/vhf00.html
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326807806440" ID="ID_1456850646" MODIFIED="1373988894075" TEXT="ntdll.dll:{Zw,Nt}ReadFile()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_stuxnet_dossier.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326912588011" ID="ID_613291929" MODIFIED="1373988902745" TEXT="ntdll.dll:{Nt,Zw}VdmControl()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW/TUT:http://vxheavens.com/lib/vhf00.html
    </p>
    <p>
      ITW:http://www.prevx.com/blog/168/SpyEye-the-infostealing-trojan-leader.html
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372790280480" FOLDED="true" ID="ID_1350731311" MODIFIED="1389278160831" TEXT="Hide Registry Artifacts">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1304619821222" FOLDED="true" ID="ID_1538676493" MODIFIED="1389278160829" TEXT="System Service Descriptor Table (SSDT) Hooking&#xa;of NtEnumerateKey(), NtEnumerateValueKey()" VSHIFT="9">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326915207420" FOLDED="true" ID="ID_1281711735" MODIFIED="1389278160828" TEXT="Kernel&#xa;(Ring 0)">
<node CREATED="1326894017309" ID="ID_1230416843" MODIFIED="1326915530808" TEXT="(See Hiding Files/Directories)"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326807856992" FOLDED="true" ID="ID_876659585" MODIFIED="1389278160827" TEXT="Hooking ALL System Calls...&#xa;to intercept NtEnumerateKey(), &#xa;NtEnumerateValueKey() syscalls">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326915207420" FOLDED="true" ID="ID_562765694" MODIFIED="1389278160826" TEXT="Kernel&#xa;(Ring 0)">
<node CREATED="1326894017309" ID="ID_221682625" MODIFIED="1326915530808" TEXT="(See Hiding Files/Directories)"/>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326915210796" FOLDED="true" ID="ID_1014465444" MODIFIED="1389278160825" TEXT="Userspace&#xa;(Ring 3)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326808011618" ID="ID_707683021" MODIFIED="1373989039566" TEXT="Hook KUSER_SHARED_DATA&#xa;(code &lt; XPSP2, function pointer &gt;= XPSP2)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://uninformed.org/index.cgi?v=3&amp;a=4&amp;p=22
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326915336237" FOLDED="true" ID="ID_177172684" MODIFIED="1389278160825" TEXT="Inline/IAT/EAT Hooking">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326915207420" FOLDED="true" ID="ID_1508473780" MODIFIED="1389278160823" TEXT="Kernel&#xa;(Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326820431383" ID="ID_1362938178" MODIFIED="1373989049785" TEXT="nt*.exe:{Nt,Zw}EnumerateValueKey()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.symantec.com/avcenter/reference/techniques.of.adware.and.spyware.pdf
    </p>
    <p>
      ITW:http://av-school.com/blogs/comment/201 (Rootkit.Win32.Agent.hki)
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326915155444" ID="ID_1670059331" MODIFIED="1373989060703" TEXT="nt*.exe:{Nt,Zw}EnumerateKey()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW/TUT:http://vxheavens.com/lib/vhf00.html
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327075967469" ID="ID_1774578713" MODIFIED="1373989068370" TEXT="nt*.exe:{Nt,Zw}SaveKey{Ex}()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://web.archive.org/web/20061017030019/http://www.rootkit.com/newsread.php?newsid=420
    </p>
    <p>
      ITW:http://www.securelist.com/en/analysis/204792131/TDSS
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327075967469" ID="ID_13508132" MODIFIED="1373989076769" TEXT="nt*.exe:{Nt,Zw}SaveMergedKeys()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://web.archive.org/web/20061017030019/http://www.rootkit.com/newsread.php?newsid=420
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327076047957" ID="ID_679172325" MODIFIED="1373989083043" TEXT="nt*.exe:{Nt,Zw}DeviceIoControlFile()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://web.archive.org/web/20061017030019/http://www.rootkit.com/newsread.php?newsid=420
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327250044917" ID="ID_136239359" MODIFIED="1373989093211" TEXT="nt*.exe:CMEnumerateKey()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.mcafee.com/threat-intelligence/malware/default.aspx?id=141447
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326915210796" FOLDED="true" ID="ID_1765842607" MODIFIED="1389278160822" TEXT="Userspace&#xa;(Ring 3)">
<node BACKGROUND_COLOR="#cccc00" CREATED="1304619703960" FOLDED="true" ID="ID_1012823093" MODIFIED="1389278160822" TEXT="Inline/IAT Hooking">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326811049573" ID="ID_86343566" MODIFIED="1373989163828" TEXT="advapi32.dll:RegEnumKey{Ex}{A,W}()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.symantec.com/avcenter/reference/techniques.of.adware.and.spyware.pdf
    </p>
    <p>
      ITW: vanquish - http://www.blackhat.com/presentations/bh-usa-04/bh-us-04-butler/bh-us-04-butler.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327075886620" ID="ID_1926865209" MODIFIED="1373989171568" TEXT="advapi32.dll:RegEnumValue{A,W}()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.symantec.com/avcenter/reference/techniques.of.adware.and.spyware.pdf
    </p>
    <p>
      ITW: vanquish - http://www.blackhat.com/presentations/bh-usa-04/bh-us-04-butler/bh-us-04-butler.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327075887891" ID="ID_1157206046" MODIFIED="1373989180900" TEXT="advapi32.dll:RegQueryMultipleValues{A,W}()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.symantec.com/avcenter/reference/techniques.of.adware.and.spyware.pdf
    </p>
    <p>
      ITW: vanquish - http://www.blackhat.com/presentations/bh-usa-04/bh-us-04-butler/bh-us-04-butler.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326820431383" ID="ID_715694540" MODIFIED="1373989187800" TEXT="ntdll.dll:{Nt,Zw}EnumerateValueKey()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.symantec.com/avcenter/reference/techniques.of.adware.and.spyware.pdf
    </p>
    <p>
      ITW:http://av-school.com/blogs/comment/201 (Rootkit.Win32.Agent.hki)
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326915155444" ID="ID_858044747" MODIFIED="1373989193747" TEXT="ntdll.dll:{Nt,Zw}EnumerateKey()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW/TUT:http://vxheavens.com/lib/vhf00.html
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327075967469" ID="ID_1322372929" MODIFIED="1373989204974" TEXT="ntdll.dll:{Nt,Zw}SaveKey()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://web.archive.org/web/20061017030019/http://www.rootkit.com/newsread.php?newsid=420
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327075967469" ID="ID_698408151" MODIFIED="1373989215071" TEXT="ntdll.dll:{Nt,Zw}SaveMergedKeys()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://web.archive.org/web/20061017030019/http://www.rootkit.com/newsread.php?newsid=420
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327076047957" ID="ID_80800783" MODIFIED="1373989221556" TEXT="ntdll.dll:{Nt,Zw}DeviceIoControlFile()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://web.archive.org/web/20061017030019/http://www.rootkit.com/newsread.php?newsid=420
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1304865921955" FOLDED="true" ID="ID_1629877509" MODIFIED="1389278160821" TEXT="Call your own CmRegisterCallback{Ex}()&#xa;(and prevent subsequent registered functions from being called)">
<node BACKGROUND_COLOR="#cccc00" CREATED="1372794243621" ID="ID_1778998368" MODIFIED="1373998627387" TEXT="Kernel (Ring 0)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      I think you can hide with kernel callbacks, but I need to confirm by writing some code
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327008926289" FOLDED="true" ID="ID_1312516873" MODIFIED="1389278160820" TEXT="DKOM">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326915207420" FOLDED="true" ID="ID_1224605539" MODIFIED="1389278160819" TEXT="Kernel&#xa;(Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327008740989" ID="ID_1010095904" MODIFIED="1372180423196" TEXT="Kernel Object Hooking (KOH)&#xa;Hook someone else&apos;s data structures which get&#xa;created by them calling CmRegisterCallback{Ex}()&#xa;"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1304619613420" FOLDED="true" ID="ID_493569270" MODIFIED="1389278160819" TEXT="Hide Open Network Ports">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1308052955642" FOLDED="true" ID="ID_1576676114" MODIFIED="1389278160819" TEXT="DKOM">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326894944377" ID="ID_277021157" MODIFIED="1373998642678" TEXT="Kernel&#xa;(Ring 0)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &quot;Modifying tables of open ports in TCPIP.SYS&quot; - How? http://www.thefengs.com/wuchang/work/courses/cs410/slides/Chapter8_KernelRootkits.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327089764505" FOLDED="true" ID="ID_850549089" MODIFIED="1389278160819" TEXT="IRP Filtering">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326894944377" FOLDED="true" ID="ID_1021771586" MODIFIED="1389278160818" TEXT="Kernel&#xa;(Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326825107800" ID="ID_341027875" MODIFIED="1373998653909" TEXT="Register Filter Driver">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.securelist.com/en/analysis/204792131/TDSS
    </p>
    <p>
      (need confirmation it was this not hooking existing pointers)
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1305669818354" ID="ID_1468596" MODIFIED="1373998661330" TEXT="DriverObject Major Function Hooking">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: TCPIRPHook - analysis of it here: http://dl.acm.org/citation.cfm?id=1691138.1691160
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326916407527" FOLDED="true" ID="ID_1632332040" MODIFIED="1389278160818" TEXT="Inline/IAT/EAT Hooking">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326894944377" FOLDED="true" ID="ID_604593301" MODIFIED="1389278160816" TEXT="Kernel&#xa;(Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327014328097" ID="ID_1323961836" MODIFIED="1373310219857" TEXT="Wherever WriteFile() ends up? NtWriteFile?"/>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326894948281" FOLDED="true" ID="ID_638215674" MODIFIED="1389278160815" TEXT="Userspace&#xa;(Ring 3)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326891494441" ID="ID_1272720196" MODIFIED="1373998677801" TEXT="Iphlpapi.dll:GetTcpTable()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.phrack.org/issues.html?issue=62&amp;id=12
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326891630756" ID="ID_415670015" MODIFIED="1373998683507" TEXT="user32.dll:CharToOemBuff{A,W}()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.phrack.org/issues.html?issue=62&amp;id=
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326891731219" ID="ID_1818273167" MODIFIED="1373998693908" TEXT="kernel32.dll:WriteFile{Ex?}()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.phrack.org/issues.html?issue=62&amp;id=12
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326891897269" ID="ID_1537677146" MODIFIED="1373998701329" TEXT="Iphlpapi.dll:AllocateAndGetTcpExTableFromStack()&#xa;(Windows XP -&gt; Windows 2003 only)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.phrack.org/issues.html?issue=62&amp;id=12
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326892006566" ID="ID_1259353700" MODIFIED="1373998732509" TEXT="Iphlpapi.dll:GetExtendedTcpTable()&#xa;(Windows &gt; {Vista, XP SP 2}) ">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://msdn.microsoft.com/en-us/library/windows/desktop/aa365928(v=vs.85).aspx
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1304619669023" FOLDED="true" ID="ID_1629684581" MODIFIED="1389366356587" TEXT="Hide Network Traffic">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      (from host-based firewalls/sniffers)
    </p>
  </body>
</html>
</richcontent>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327013700681" FOLDED="true" ID="ID_1945006632" MODIFIED="1389278160815" TEXT="DKOM">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326894984977" FOLDED="true" ID="ID_640391762" MODIFIED="1389278160814" TEXT="Kernel&#xa;(Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1304865442657" ID="ID_1183862141" MODIFIED="1373998826889" TEXT="KOH - Modify NDIS_MINIPORT_CHARACTERISTICS.SendPacketsHandler function pointer">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.f-secure.com/weblog/archives/00001393.html
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326916533984" ID="ID_1048487094" MODIFIED="1373998835957" TEXT="KOH - Modify NDIS_PROTOCOL_CHARACTERISTICS">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://web.archive.org/web/20061017030751/http://www.rootkit.com/newsread.php?newsid=219
    </p>
    <p>
      PoC (uay rootkit) http://web.archive.org/web/20061017031147/http://www.rootkit.com/newsread.php?newsid=445
    </p>
    <p>
      PoC:http://blackhat.com/presentations/bh-usa-06/BH-US-06-Tereshkin.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326895009458" FOLDED="true" ID="ID_596110269" MODIFIED="1389278160814" TEXT="IRP filtering">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326894984977" FOLDED="true" ID="ID_1880137413" MODIFIED="1389278160812" TEXT="Kernel&#xa;(Ring 0)">
<node BACKGROUND_COLOR="#cccc00" CREATED="1327066099255" FOLDED="true" ID="ID_1782187401" MODIFIED="1389278160812" TEXT="DKOM">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326825162840" ID="ID_1447723820" MODIFIED="1372180694131" TEXT="Hook nt!pIofCallDriver() function pointer ?&#xa;(arguable if DKOM or not, since it&apos;s just a single global)"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326825122896" ID="ID_586440658" MODIFIED="1373998850170" TEXT="KOH - Hook DRIVER_OBJECT.MajorFunction[] function pointers&#xa;for a target driver&apos;s DRIVER_OBJECT">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://web.archive.org/web/20061017030751/http://www.rootkit.com/newsread.php?newsid=253
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327066173239" ID="ID_49891695" MODIFIED="1372180694129" TEXT="KOH - Hook DRIVER_OBJECT.DriverStartIO() ?"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326825107800" ID="ID_1069113309" MODIFIED="1372180671830" TEXT="Register Filter Driver"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327019427230" FOLDED="true" ID="ID_1198967943" MODIFIED="1389278160812" TEXT="Register as Network Filter Driver">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326894984977" FOLDED="true" ID="ID_625067130" MODIFIED="1389278160811" TEXT="Kernel&#xa;(Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327019362062" ID="ID_222084419" MODIFIED="1373998873048" TEXT="Transport Driver Interface (TDI) driver">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      (not hidden from wireshark, maybe from some personal firewalls)
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327019490959" ID="ID_269919938" MODIFIED="1372180710399" TEXT="Network Driver Interface Specification (NDIS) Protocol Driver"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326835857528" ID="ID_1505913446" MODIFIED="1373998883371" TEXT="NDIS Intermediate Driver">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      (hidden from wireshark - generic)
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327019495463" ID="ID_1379829608" MODIFIED="1373998890445" TEXT="NDIS Miniport Driver">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      (hidden from wireshark - hw specific?)
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327019362062" ID="ID_1485071792" MODIFIED="1372180710398" TEXT="Windows Filtering Platform (WFP) driver"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327019539432" FOLDED="true" ID="ID_410291159" MODIFIED="1389278160811" TEXT="Talk Directly to NIC">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326894984977" ID="ID_1943335484" MODIFIED="1373998908352" TEXT="Kernel&#xa;(Ring 0)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: https://www.blackhat.com/html/bh-usa-08/brief-bh-usa-08-ss-NIC.html
    </p>
    <p>
      http://www.cs.ucf.edu/~czou/research/Chipset%20Backdoor-AsiaCCS09.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1389366353243" MODIFIED="1389366353243" TEXT="(from host-based firewalls/sniffers)"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378658773626" ID="ID_860936043" MODIFIED="1384279733330" STYLE="fork" TEXT="Obfuscate Artifact Properties">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      create incorrect timestamps to confuse analysts; the MAL: A Malware Analysis Lexicon, CMU.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<attribute NAME="Property" VALUE="Timestamp (timestomping)"/>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1326895149837" FOLDED="true" ID="ID_828039787" MODIFIED="1389713085835" TEXT="Hide Executing Code">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1304619623102" FOLDED="true" ID="ID_1276770839" MODIFIED="1389278160810" TEXT="Hide Processes">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1304620055590" FOLDED="true" ID="ID_1465601006" MODIFIED="1389278160810" TEXT="Inline/IAT/EAT Hooking">
<node BACKGROUND_COLOR="#cccc00" CREATED="1327067190923" FOLDED="true" ID="ID_1360877810" MODIFIED="1389278160808" TEXT="Userspace&#xa;(Ring 3)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326811929618" ID="ID_1843527106" MODIFIED="1373998934287" TEXT="ntdll.dll:{Nt,Zw}QuerySystemInformation()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.symantec.com/avcenter/reference/stories.from.the.drm.world.pdf
    </p>
    <p>
      ITW:http://www.phrack.org/issues.html?issue=62&amp;id=12
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326893795944" ID="ID_1770180632" MODIFIED="1373998941325" TEXT="ntdll.dll:{Nt,Zw}OpenProcess">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: hxdef -&#160;&#160; http://www.blackhat.com/presentations/bh-usa-04/bh-us-04-butler/bh-us-04-butler.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326811990714" ID="ID_1871924733" MODIFIED="1373998952561" TEXT="kernel32.dll:OpenProcess()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.symantec.com/avcenter/reference/stories.from.the.drm.world.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327069417749" ID="ID_55127550" MODIFIED="1373998958628" TEXT="{psapi.dll,kernel32.dll}:EnumProcesses()&#xa;&#xa;http://msdn.microsoft.com/en-us/library/windows/desktop/ms682629(v=vs.85).aspx&#xa;&quot;Kernel32.dll on Windows 7 and Windows Server 2008 R2;&#xa;Psapi.dll if PSAPI_VERSION=1 on Windows 7 and Windows Server 2008 R2;&#xa;Psapi.dll on Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP&quot;">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://www.f-secure.com/weblog/archives/KimmoKasslin_VB2005_proceedings.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326891210340" ID="ID_731187765" MODIFIED="1373998966175" TEXT="user32.dll:SendMessage{A,W}">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.phrack.org/issues.html?issue=62&amp;id=12
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327067871967" ID="ID_1702913610" MODIFIED="1373998974052" TEXT="kernel32.dll:Process32First() and/or kernel32.dll:CreateToolhelp32Snapshot() ">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Process32First() - http://msdn.microsoft.com/en-us/library/windows/desktop/ms684834(v=vs.85).aspx
    </p>
    <p>
      CreateToolHelp32Snapshot() - http://msdn.microsoft.com/en-us/library/windows/desktop/ms682489(v=vs.85).aspx
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327067884312" ID="ID_461087749" MODIFIED="1373998982636" TEXT="kernel32.dll:Process32Next() and/or kernel32.dll:CreateToolhelp32Snapshot() ">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Process32Next() - http://msdn.microsoft.com/en-us/library/windows/desktop/ms684836(v=vs.85).aspx
    </p>
    <p>
      CreateToolHelp32Snapshot() - http://msdn.microsoft.com/en-us/library/windows/desktop/ms682489(v=vs.85).aspx
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1373297441518" FOLDED="true" ID="ID_1938823592" MODIFIED="1389278160808" TEXT="Kernel (Ring 0) ">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326811929618" ID="ID_1033115726" MODIFIED="1373998994110" TEXT="nt*.exe:{Nt,Zw}QuerySystemInformation()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.symantec.com/avcenter/reference/stories.from.the.drm.world.pdf
    </p>
    <p>
      ITW:http://www.phrack.org/issues.html?issue=62&amp;id=12
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326893795944" ID="ID_673771159" MODIFIED="1373999000557" TEXT="nt*.exe:{Nt,Zw}OpenProcess">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: hxdef -&#160;&#160; http://www.blackhat.com/presentations/bh-usa-04/bh-us-04-butler/bh-us-04-butler.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326807856992" FOLDED="true" ID="ID_1725427859" MODIFIED="1389278160807" TEXT="Hooking ALL System Calls...&#xa;to intercept only NtOpenProcess(),NtQuerySystemInformation()">
<node BACKGROUND_COLOR="#cccc00" CREATED="1327067190923" FOLDED="true" ID="ID_123413674" MODIFIED="1389278160806" TEXT="Userspace&#xa;(Ring 3)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326808011618" ID="ID_222734827" MODIFIED="1373999008937" TEXT="Hook KUSER_SHARED_DATA&#xa;(code &lt; XPSP2, function pointer &gt;= XPSP2)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://uninformed.org/index.cgi?v=3&amp;a=4&amp;p=22
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1373297441518" FOLDED="true" ID="ID_1279379612" MODIFIED="1389278160805" TEXT="Kernel (Ring 0) ">
<node CREATED="1326894017309" ID="ID_1615279951" MODIFIED="1326894026272" TEXT="(See Hiding FIles/Directories)"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1304620050845" FOLDED="true" ID="ID_945901900" MODIFIED="1389278160805" TEXT="DKOM">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326896973015" ID="ID_1904716645" MODIFIED="1373999029755" TEXT="Unlink from EPROCESS.ActiveProcessLinks linked list">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://www.blackhat.com/presentations/bh-usa-04/bh-us-04-butler/bh-us-04-butler.pdf
    </p>
    <p>
      PoC: (return-oriented rootkit PoC) http://www.usenix.org/event/sec09/tech/full_papers/hund.pdf
    </p>
    <p>
      ITW: http://www.symantec.com/avcenter/reference/when.malware.meets.rootkits.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327079855396" ID="ID_1926527086" MODIFIED="1373999037021" TEXT="Unlink from csrss.exe HANDLE_TABLE.HandleTableList linked list">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://web.archive.org/web/20061017031244/http://www.rootkit.com/newsread.php?newsid=307
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327080376009" ID="ID_778292145" MODIFIED="1373999045138" TEXT="Remove from PspCidTable">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:(FUTo) http://web.archive.org/web/20061017023101/http://www.rootkit.com/newsread.php?newsid=433
    </p>
    <p>
      PoC: http://www.blackhat.com/presentations/bh-europe-06/bh-eu-06-Silberman-Butler.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327067227923" ID="ID_1609551166" MODIFIED="1373297339370" TEXT="KOH - Hook someone else&apos;s data structures  &#xa;which get created by them calling  &#xa;PsSetCreateProcessNotifyRoutine{Ex}()"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327068798279" ID="ID_392885355" MODIFIED="1373297430806" TEXT="Call your own PsSetCreateProcessNotifyRoutine{Ex}() &#xa;(and prevent subsequent registered functions from being called)"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1326893574678" FOLDED="true" ID="ID_566778568" MODIFIED="1389278160805" TEXT="Hide Threads">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326893684039" FOLDED="true" ID="ID_1865855604" MODIFIED="1389278160805" TEXT="Inline/IAT/EAT Hooking">
<node BACKGROUND_COLOR="#cccc00" CREATED="1327066998793" FOLDED="true" ID="ID_339839732" MODIFIED="1389278160804" TEXT="Userspace&#xa;(Ring 3)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326893693695" ID="ID_1452050215" MODIFIED="1373999092784" TEXT="ntdll.dll:{Nt,Zw}OpenThreadToken">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: hxdef http://www.blackhat.com/presentations/bh-usa-04/bh-us-04-butler/bh-us-04-butler.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327067871967" ID="ID_108653816" MODIFIED="1373999100500" TEXT="kernel32.dll:Thread32First() and/or kernel32.dll:CreateToolhelp32Snapshot() ">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Thread32First() - http://msdn.microsoft.com/en-us/library/windows/desktop/ms686728(v=vs.85).aspx
    </p>
    <p>
      CreateToolHelp32Snapshot() - http://msdn.microsoft.com/en-us/library/windows/desktop/ms682489(v=vs.85).aspx
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327067884312" ID="ID_197152591" MODIFIED="1373999108373" TEXT="kernel32.dll:Thread32Next() and/or kernel32.dll:CreateToolhelp32Snapshot() ">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Thread32Next() - http://msdn.microsoft.com/en-us/library/windows/desktop/ms686731(v=vs.85).aspx
    </p>
    <p>
      CreateToolHelp32Snapshot() - http://msdn.microsoft.com/en-us/library/windows/desktop/ms682489(v=vs.85).aspx
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1373046070614" FOLDED="true" ID="ID_974714334" MODIFIED="1389278160803" TEXT="Kernel (Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326893693695" ID="ID_1933737423" MODIFIED="1373999116096" TEXT="nt*.exe:{Nt,Zw}OpenThreadToken">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: hxdef http://www.blackhat.com/presentations/bh-usa-04/bh-us-04-butler/bh-us-04-butler.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327070694420" ID="ID_884601679" MODIFIED="1372180958239" TEXT="nt*.exe:SwapContext()"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326893671767" FOLDED="true" ID="ID_908263343" MODIFIED="1389278160803" TEXT="DKOM">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327067050241" ID="ID_969523825" MODIFIED="1372180958241" TEXT="KOH - Hook someone else&apos;s data structures &#xa;which get created by them calling &#xa;PsSetCreateThreadNotifyRoutine()"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327071047919" FOLDED="true" ID="ID_1556088643" MODIFIED="1389278160803" TEXT="Implement Independent Thread Scheduler">
<node BACKGROUND_COLOR="#cccc00" CREATED="1373046168268" ID="ID_919504029" MODIFIED="1373999129406" TEXT="Kernel (Ring 0)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://web.archive.org/web/20061017030605/http://www.rootkit.com/newsread.php?newsid=235
    </p>
    <p>
      http://www.rootkit.com/vault/90210/phide2.zip (gone)
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326807856992" FOLDED="true" ID="ID_541675786" MODIFIED="1389278160802" TEXT="Hooking ALL System Calls...&#xa;to intercept only NtReadFile()">
<node BACKGROUND_COLOR="#cccc00" CREATED="1327066998793" FOLDED="true" ID="ID_1381487520" MODIFIED="1389278160801" TEXT="Userspace&#xa;(Ring 3)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326808011618" ID="ID_880877391" MODIFIED="1373999139078" TEXT="Hook KUSER_SHARED_DATA&#xa;(code &lt; XPSP2, function pointer &gt;= XPSP2)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://uninformed.org/index.cgi?v=3&amp;a=4&amp;p=22
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1373045861261" FOLDED="true" ID="ID_513183078" MODIFIED="1389278160800" TEXT="Kernel (Ring 0)">
<node CREATED="1326894017309" ID="ID_991969676" MODIFIED="1326894026272" TEXT="(See Hiding FIles/Directories)"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327068824191" FOLDED="true" ID="ID_1553304659" MODIFIED="1389278160799" TEXT="Call your own PsSetCreateThreadNotifyRoutine()&#xa;(and prevent subsequent registered functions from being called) ">
<node BACKGROUND_COLOR="#cccc00" CREATED="1327066995793" ID="ID_795554909" MODIFIED="1373294754720" TEXT="Kernel&#xa;(Ring 0)"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1304619643575" FOLDED="true" ID="ID_1563399144" MODIFIED="1389278160799" TEXT="Hide Userspace Libraries">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1304865474631" FOLDED="true" ID="ID_1322266620" MODIFIED="1389278160799" TEXT="DKOM">
<node BACKGROUND_COLOR="#cccc00" CREATED="1373046144572" FOLDED="true" ID="ID_1422133309" MODIFIED="1389278160799" TEXT="Kernel (Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326809415111" ID="ID_743342284" MODIFIED="1373999168167" TEXT="VAD modification">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Not a good description of the possibility
    </p>
    <p>
      but just offhandedly mentioned here:
    </p>
    <p>
      https://media.blackhat.com/bh-us-11/Butler/BH_US_11_ButlerMurdock_Physical_Memory_Forensics-WP.pdf
    </p>
    <p>
      Need a better ref
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327067050241" ID="ID_1954423249" MODIFIED="1372181062110" TEXT="KOH - Hook someone else&apos;s data structures &#xa;which get created by them calling &#xa;PsSetLoadImageNotifyRoutine()"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326809275502" ID="ID_205357977" MODIFIED="1373999194327" TEXT="Unlink from LDR_DATA_TABLE_ENTRY.{InLoadOrder, InMemoryOrder, InitilizationOrder} linked lists&#xa;aka &quot;PEB Hooking&quot;&#xa;(pointed to by TEB-&gt;PEB-&gt;Ldr)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.phrack.org/issues.html?issue=62&amp;id=12
    </p>
    <p>
      http://www.phrack.org/issues.html?issue=65&amp;id=10
    </p>
    <p>
      (PEB hooking from kernel not covered, but PEB is accessible from kernel too)
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326912749188" FOLDED="true" ID="ID_828801793" MODIFIED="1389278160799" TEXT="Inline/IAT/EAT Hooking">
<node BACKGROUND_COLOR="#cccc00" CREATED="1373045289173" FOLDED="true" ID="ID_1013347192" MODIFIED="1389278160798" TEXT="Kernel (Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326892719142" ID="ID_727745290" MODIFIED="1373999210311" TEXT="nt*.exe:{Nt,Zw}QuerySystemInformation()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Mentioned, but not PoCed in
    </p>
    <p>
      http://www.phrack.org/issues.html?issue=62&amp;id=12
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327089994153" ID="ID_94860240" MODIFIED="1373999208693" TEXT="nt*.exe:{Nt,Zw}FlushInstructionCache">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.securelist.com/en/analysis/204792131/TDSS
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1373045356598" FOLDED="true" ID="ID_83805630" MODIFIED="1389278160798" TEXT="Userspace (Ring 3)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326892719142" ID="ID_972911316" MODIFIED="1373999222020" TEXT="ntdll.dll:{Zw,Nt}QuerySystemInformation()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Mentioned, but not PoCed in
    </p>
    <p>
      http://www.phrack.org/issues.html?issue=62&amp;id=12
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327067870800" ID="ID_378752863" MODIFIED="1373999229629" TEXT="{psapi.dll,kernel32.dll}:EnumProcessModules{Ex}()&#xa;&#xa;http://msdn.microsoft.com/en-us/library/windows/desktop/ms682631(v=vs.85).aspx&#xa;&quot;Kernel32.dll on Windows 7 and Windows Server 2008 R2;&#xa;Psapi.dll (if PSAPI_VERSION=1) on Windows 7 and Windows Server 2008 R2;&#xa;Psapi.dll on Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP&quot;">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Mentioned, but not PoCed in
    </p>
    <p>
      http://www.phrack.org/issues.html?issue=62&amp;id=12
    </p>
    <p>
      EnumProcessModules -
    </p>
    <p>
      http://msdn.microsoft.com/en-us/library/windows/desktop/ms682631(v=vs.85).aspx
    </p>
    <p>
      EnumProcessModulesEx - http://msdn.microsoft.com/en-us/library/windows/desktop/ms682631(v=vs.85).aspx
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327067871967" ID="ID_1109869041" MODIFIED="1373999240641" TEXT="kernel32.dll:Module32First() and/or kernel32.dll:CreateToolhelp32Snapshot() ">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Mentioned, but not PoCed in
    </p>
    <p>
      http://www.phrack.org/issues.html?issue=62&amp;id=12
    </p>
    <p>
      CreateToolHelp32Snapshot() - http://msdn.microsoft.com/en-us/library/windows/desktop/ms682489(v=vs.85).aspx
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327067884312" ID="ID_136844945" MODIFIED="1373999247444" TEXT="kernel32.dll:Module32Next() and/or kernel32.dll:CreateToolhelp32Snapshot() ">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Mentioned, but not PoCed in
    </p>
    <p>
      http://www.phrack.org/issues.html?issue=62&amp;id=12
    </p>
    <p>
      CreateToolHelp32Snapshot() - http://msdn.microsoft.com/en-us/library/windows/desktop/ms682489(v=vs.85).aspx
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1305379655833" FOLDED="true" ID="ID_227623601" MODIFIED="1389278160798" TEXT="Copy to dynamically allocated memory and unload module">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326912648867" ID="ID_175917534" MODIFIED="1373294498653" TEXT="Kernel&#xa;(Ring 0)"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326912653090" ID="ID_136158290" MODIFIED="1373294498103" TEXT="Userspace&#xa;(Ring 3)"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327068824191" ID="ID_799911437" MODIFIED="1373294618300" TEXT="Call your own PsSetImageLoadNotifyRoutine()&#xa;(and prevent subsequent registered functions from being called) "/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326809275502" FOLDED="true" ID="ID_513389482" MODIFIED="1389278160797" TEXT="Unlink from LDR_DATA_TABLE_ENTRY.{InLoadOrder, InMemoryOrder, InitilizationOrder} linked lists&#xa;aka &quot;PEB Hooking&quot;&#xa;(pointed to by TEB-&gt;PEB-&gt;Ldr)">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326912653090" ID="ID_1004389233" MODIFIED="1373999264120" TEXT="Userspace&#xa;(Ring 3)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.phrack.org/issues.html?issue=62&amp;id=12
    </p>
    <p>
      http://www.phrack.org/issues.html?issue=65&amp;id=10
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1304619633865" FOLDED="true" ID="ID_1754797704" MODIFIED="1389278160797" TEXT="Hide Kernel Modules">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1305371479605" FOLDED="true" ID="ID_1117061443" MODIFIED="1389278160796" TEXT="DKOM">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326892534403" ID="ID_27614597" MODIFIED="1373999328714" TEXT="Unlink from LDR_DATA_TABLE_ENTRY.{InLoadOrder, InMemoryOrder, InitilizationOrder} linked lists&#xa;(pointed to by PsLoadedModulesList and any DRIVER_OBJECT.DriverSection)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: (Where was the original PoC?)
    </p>
    <p>
      ITW:http://www.securelist.com/en/analysis/204792131/TDSS
    </p>
    <p>
      ITW:http://www.antirootkit.com/articles/Nailuj-Rootkit-Analysis/index.htm
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1305379618317" FOLDED="true" ID="ID_1959005210" MODIFIED="1389278160796" TEXT="Copy to dynamically allocated memory and unload module">
<node BACKGROUND_COLOR="#cccc00" CREATED="1327077187911" ID="ID_1193714201" MODIFIED="1373999336076" TEXT="Kernel&#xa;(Ring 0)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: He4Hook src - he4dev.e1.bmstu.ru/__he4hook_v21a_20021110.zip
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1326808521031" FOLDED="true" ID="ID_669624185" MODIFIED="1389278160796" TEXT="Hide Services">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326894709937" FOLDED="true" ID="ID_1853307928" MODIFIED="1389278160796" TEXT="Hiding Registry Keys Created by Service Control Manager">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326895023138" FOLDED="true" ID="ID_1383286189" MODIFIED="1389278160795" TEXT="Kernel&#xa;(Ring 0)">
<node CREATED="1326894727993" ID="ID_400940647" MODIFIED="1326894735605" TEXT="See Hiding Registry Keys"/>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326895026242" FOLDED="true" ID="ID_337277287" MODIFIED="1389278160793" TEXT="Userspace&#xa;(Ring 3)">
<node CREATED="1326894727993" ID="ID_1438929139" MODIFIED="1326894735605" TEXT="See Hiding Registry Keys"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326808536082" FOLDED="true" ID="ID_300015410" MODIFIED="1389278160793" TEXT="Inline/IAT/EAT Hooking">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326808549010" ID="ID_148395013" MODIFIED="1373999451522" TEXT="advapi32.dll:EnumServiceStatus{A,W}()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.symantec.com/avcenter/reference/techniques.of.adware.and.spyware.pdf
    </p>
    <p>
      ITW: vanquish -&#160; http://www.blackhat.com/presentations/bh-usa-04/bh-us-04-butler/bh-us-04-butler.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327076444394" FOLDED="true" ID="ID_627088375" MODIFIED="1389278160793" TEXT="Modify Data in Services.exe">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326895026242" ID="ID_671892616" MODIFIED="1373999459571" TEXT="Userspace&#xa;(Ring 3)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://web.archive.org/web/20061017030616/http://www.rootkit.com/newsread.php?newsid=419
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372788826351" FOLDED="true" ID="ID_474497297" MODIFIED="1389278160793" TEXT="Add Service Triggers">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326895026242" ID="ID_1379500666" MODIFIED="1373999469682" TEXT="Userspace&#xa;(Ring 3)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: https://isc.sans.edu/diary/Wipe+the+drive!++Stealthy+Malware+Persistence+-+Part+3/15448
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1326895265299" FOLDED="true" ID="ID_410888910" MODIFIED="1389278160793" TEXT="Execute Before/External to Kernel/Hypervisor">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      (But still on main CPU,( -3 &lt; Ring &lt;= -1))
    </p>
  </body>
</html></richcontent>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326895282787" FOLDED="true" ID="ID_813871268" MODIFIED="1389278160792" TEXT="Infect BIOS&#xa;(&quot;Ring -2.5&quot;)">
<node BACKGROUND_COLOR="#cccc00" CREATED="1327001270788" ID="ID_1141823030" MODIFIED="1373999351577" TEXT="Unsigned BIOS">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: ACPI Tables - http://www.blackhat.com/presentations/bh-federal-06/BH-Fed-06-Heasman.pdf
    </p>
    <p>
      PoC: http://www.coresecurity.com/files/attachments/Persistent_BIOS_Infection_CanSecWest09.pdf
    </p>
    <p>
      ITW: http://blog.webroot.com/2011/09/13/mebromi-the-first-bios-rootkit-in-the-wild/
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1327001274811" ID="ID_943978760" MODIFIED="1373999356129" TEXT="Signed BIOS">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://invisiblethingslab.com/resources/bh09usa/Attacking%20Intel%20BIOS.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326895337564" FOLDED="true" ID="ID_1566710809" MODIFIED="1389278160790" TEXT="Infect SMRAM&#xa;(&quot;Ring -2&quot;)">
<node BACKGROUND_COLOR="#cccc00" CREATED="1327001254011" ID="ID_83634939" MODIFIED="1373999367879" TEXT="SMRAM Unlocked">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.115.2702
    </p>
    <p>
      PoC:http://www.cs.ucf.edu/~czou/research/SMM-Rootkits-Securecom08.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1327001284947" FOLDED="true" ID="ID_905525105" MODIFIED="1389278160790" TEXT="SMRAM Locked">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://invisiblethingslab.com/resources/misc09/smm_cache_fun.pdf
    </p>
    <p>
      PoC: http://invisiblethingslab.com/resources/bh08/part2-full.pdf
    </p>
  </body>
</html></richcontent>
<node CREATED="1327011712267" ID="ID_1112156930" MODIFIED="1327011717407" TEXT="See Infect BIOS"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326895294172" FOLDED="true" ID="ID_834295740" MODIFIED="1389278160789" TEXT="Infect Master Boot Record(MBR)&#xa;(&quot;Ring -1.5&quot;)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: bootroot - http://www.eeye.com/Resources/Security-Center/Research/Tools/BootRoot
    </p>
    <p>
      PoC: stoned - http://www.blackhat.com/presentations/bh-usa-09/KLEISSNER/BHUSA09-Kleissner-StonedBootkit-SLIDES.pdf
    </p>
    <p>
      ITW: http://www2.gmer.net/mbr/
    </p>
    <p>
      ITW: http://www.prevx.com/blog/154/TDL-rootkit-x-goes-in-the-wild.html
    </p>
  </body>
</html></richcontent>
<node CREATED="1327012262299" ID="ID_1484887284" MODIFIED="1327012266318" TEXT="See Infect BIOS"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326895313324" ID="ID_1916416569" MODIFIED="1373999401796" TEXT="Infect Volume Boot Record(VBR)&#xa;(&quot;Ring -1.5&quot;)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.securelist.com/en/blog/517/Cybercriminals_switch_from_MBR_to_NTFS
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327001545491" ID="ID_1478026529" MODIFIED="1373999408794" TEXT="Create new partition/VBR&#xa;(&quot;Ring -1.5&quot;)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://blog.eset.com/2011/10/18/tdl4-rebooted
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326895321700" FOLDED="true" ID="ID_1269986136" MODIFIED="1389278160787" TEXT="Infect/Escape VMM Where One Exists&#xa;(&quot;Ring -1&quot;)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://invisiblethingslab.com/resources/bh08/part1.pdf
    </p>
    <p>
      ITW: http://www.blackhat.com/presentations/bh-usa-09/KORTCHINSKY/BHUSA09-Kortchinsky-Cloudburst-SLIDES.pdf
    </p>
    <p>
      PoC: https://media.defcon.org/dc-19/presentations/Elhage/DEFCON-19-Elhage-Virtualization-Under-Attack.pdf
    </p>
  </body>
</html></richcontent>
<node CREATED="1327012202418" ID="ID_1783244740" MODIFIED="1327012250535" TEXT="See Infect BIOS, Infect MBR, Infect/Create VBR"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327002909056" FOLDED="true" ID="ID_1385979373" MODIFIED="1389278160786" TEXT="Inject VMM Where None Exists&#xa;(Ring -1)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://www.blackhat.com/presentations/bh-usa-06/BH-US-06-Rutkowska.pdf
    </p>
    <p>
      PoC: http://www.blackhat.com/presentations/bh-usa-06/BH-US-06-Zovi.pdf
    </p>
    <p>
      PoC: http://esec-lab.sogeti.com/dotclear/public/publications/11-recon-virtdbg_slides.pdf
    </p>
  </body>
</html></richcontent>
<node CREATED="1327012329356" ID="ID_1486929674" MODIFIED="1327012330543" TEXT="See Infect BIOS, Infect MBR, Infect/Create VBR"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373314722298" FOLDED="true" ID="ID_1175133507" MODIFIED="1389278160786" TEXT="Execute Non-Main CPU Code">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      (Anything executing on separate processor)
    </p>
    <p>
      (&quot;Ring -3&quot;)
    </p>
  </body>
</html></richcontent>
<font NAME="SansSerif" SIZE="13"/>
<attribute NAME="Method" VALUE="Device Infection, Native Support/Injection"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1384271355221" FOLDED="true" ID="ID_1151427937" MODIFIED="1389278160786" TEXT="Native Support/Injection">
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327013219967" ID="ID_928685061" MODIFIED="1373999532653" TEXT="Run Code on GPU">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Technique natively supported by vendors
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326896184992" ID="ID_1409170396" MODIFIED="1373999539419" TEXT="Run Code on Chipset&#xa;(Intel Active Management Technology - AMT)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://invisiblethingslab.com/resources/bh09usa/Ring%20-3%20Rootkits.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1384271355221" FOLDED="true" ID="ID_1125466106" MODIFIED="1389278160786" TEXT="Device Infection">
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327002041187" ID="ID_129861008" MODIFIED="1384271809257" TEXT="Infect Embedded Controller Firmware">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://www.youtube.com/watch?v=tmZ4yXuDSNc
    </p>
    <p>
      PoC: http://esec-lab.sogeti.com/dotclear/public/publications/11-recon-stickyfingers_slides.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327002165054" ID="ID_1224266097" MODIFIED="1384271809264" TEXT="Infect Keyboard Firmware">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://www.blackhat.com/presentations/bh-usa-09/CHEN/BHUSA09-Chen-RevAppleFirm-PAPER.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327002046323" ID="ID_796798282" MODIFIED="1384271809270" TEXT="Infect NIC Firmware">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://www.alchemistowl.org/arrigo/Papers/Arrigo-Triulzi-PACSEC08-Project-Maux-II.pdf
    </p>
    <p>
      PoC: http://www.ssi.gouv.fr/IMG/pdf/csw-trustnetworkcard.pdf
    </p>
    <p>
      PoC: http://esec-lab.sogeti.com/dotclear/public/publications/11-recon-nicreverse_slides.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327013210215" ID="ID_57858999" MODIFIED="1384271809276" TEXT="Infect Battery Charge Controller">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://media.blackhat.com/bh-us-11/Miller/BH_US_11_Miller_Battery_Firmware_Public_WP.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327002157662" FOLDED="true" ID="ID_1346157399" MODIFIED="1389278160785" TEXT="Infect GPU Firmware">
<node CREATED="1327013410345" ID="ID_712408041" MODIFIED="1327013414621" TEXT="No PoCs yet?"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327013502514" ID="ID_704656752" MODIFIED="1384271809292" TEXT="Reflashing PCI Expansion ROM">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      No PoCs yet? Talked about here but not really implemented (despite title)
    </p>
    <p>
      http://www.blackhat.com/presentations/bh-dc-07/Heasman/Paper/bh-dc-07-Heasman-WP.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373313156053" FOLDED="true" ID="ID_1028262554" MODIFIED="1389278160785" TEXT="Execute Stealthy Code">
<font NAME="SansSerif" SIZE="13"/>
<attribute NAME="Location" VALUE="Kernel (ring 0), Userspace (ring 3)"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326808786699" FOLDED="true" ID="ID_1259662392" MODIFIED="1389278160785" TEXT="Load Userspace (injected) Code">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326915260124" FOLDED="true" ID="ID_1210608088" MODIFIED="1389278160784" TEXT="Kernel&#xa;(Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326808956029" ID="ID_911810880" MODIFIED="1374000181164" TEXT="ntoskrnl.exe:ZwWriteVirtualMemory()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.f-secure.com/weblog/archives/KimmoKasslin_VB2005_proceedings.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326915256740" FOLDED="true" ID="ID_1539213027" MODIFIED="1389278160782" TEXT="Userspace&#xa;(Ring 3)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326808850539" ID="ID_643821610" MODIFIED="1374000191453" TEXT="kernel32.dll:WriteProcessMemory()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.f-secure.com/weblog/archives/KimmoKasslin_VB2005_proceedings.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326808860084" ID="ID_916728890" MODIFIED="1374000201617" TEXT="user32.dll:SetWindowsHookEx()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.f-secure.com/weblog/archives/KimmoKasslin_VB2005_proceedings.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326808904804" ID="ID_1551187511" MODIFIED="1374000205969" TEXT="kernel32.dll:CreateRemoteThread{Ex}()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.f-secure.com/weblog/archives/KimmoKasslin_VB2005_proceedings.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326808913388" ID="ID_1552918475" MODIFIED="1374000211399" TEXT="kernel32.dll:{Wow64}SetThreadContext()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.f-secure.com/weblog/archives/KimmoKasslin_VB2005_proceedings.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326808867220" ID="ID_1063368000" MODIFIED="1374000221243" TEXT="AppInit_DLLs registry key">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.symantec.com/avcenter/reference/techniques.of.adware.and.spyware.pdf
    </p>
    <p>
      http://www.f-secure.com/weblog/archives/KimmoKasslin_VB2005_proceedings.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1304626453286" FOLDED="true" ID="ID_1315319072" MODIFIED="1389278160782" TEXT="Load Kernel Code">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326928393707" FOLDED="true" ID="ID_1163859002" MODIFIED="1389278160780" TEXT="Kernel&#xa;(Ring 0)">
<node BACKGROUND_COLOR="#cccc00" CREATED="1327268193557" FOLDED="true" ID="ID_59154230" MODIFIED="1389278160780" TEXT="Service Control Manager">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Officially Supported Mechanism
    </p>
    <p>
      http://msdn.microsoft.com/en-us/library/windows/desktop/ms685150(v=vs.85).aspx
    </p>
  </body>
</html></richcontent>
<node BACKGROUND_COLOR="#cccc00" CREATED="1327268222661" FOLDED="true" ID="ID_834110583" MODIFIED="1389278160779" TEXT="Bypassing Signed Kernel Requirement&#xa;(Required by Windows &gt;= Vista)">
<node BACKGROUND_COLOR="#cccc00" CREATED="1327268333669" FOLDED="true" ID="ID_1860199106" MODIFIED="1389278160779" TEXT="Disable Code Signing Enforcement">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327268354446" ID="ID_38400206" MODIFIED="1373999976397" TEXT="Use Legitimate Microsoft BCDEdit Tool&#xa;to Modify Boot Configuration Data">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.securelist.com/en/blog/11266/Rootkit_Banker_now_also_to_64_bit
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327268395758" ID="ID_480279743" MODIFIED="1373999982920" TEXT="Directly Modify Boot Configuration Data">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://go.eset.com/us/resources/white-papers/The_Evolution_of_TDL.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1327269526140" FOLDED="true" ID="ID_1721699894" MODIFIED="1389278160778" TEXT="Inline Hook">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327269442059" ID="ID_1550823959" MODIFIED="1373999987317" TEXT="Winload.exe:I_CheckImageHashInCatalog()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.prevx.com/blog/172/TDL-rootkit-is-coming-back-stronger-than-before.html
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326896599769" ID="ID_1585956044" MODIFIED="1374000077176" TEXT="Direct memory modification via \Device\PhysicalMemory&#xa;(Windows &lt; {Vista, 2003 SP1})">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://www.phrack.org/ show.php?p=59&amp;a=16
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1304865608531" ID="ID_322857212" MODIFIED="1374000094167" TEXT="nt*.exe:{Nt,Zw}LoadDriver()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.codeproject.com/KB/system/DLoad.aspx
    </p>
    <p>
      ITW (zeroaccess/max++) http://www.securelist.com/en/blog/493/MAX_sets_its_sights_on_x64_platforms
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327265793111" ID="ID_348330196" MODIFIED="1374000103483" TEXT="Winspool.drv:AddPrintProvidor{A,W}()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW(TDL/TDSS roundabout way to call NtLoadDriver()) -
    </p>
    <p>
      http://go.eset.com/us/resources/white-papers/TDL3-Analysis.pdf
    </p>
    <p>
      ITW:http://go.eset.com/us/resources/white-papers/The_Evolution_of_TDL.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1304865593376" ID="ID_1764231696" MODIFIED="1374000109657" TEXT="{Nt,Zw}SetSystemInformation() (to map into memory) &#xa;(Optionally + IoCreateDriver() (to create DRIVER_OBJECT))">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://seclists.org/bugtraq/2000/Aug/408
    </p>
    <p>
      ITW: (Zero Access Trojan) http://hbgary.com/martin-pillion-blog
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327018394874" ID="ID_1667453876" MODIFIED="1374000117365" TEXT="nt*.exe:{Nt,Zw}SystemDebugControl&#xa;(Windows &lt; Vista)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      POC:http://www.blackhat.com/presentations/bh-usa-07/Lindsay/Whitepaper/bh-usa-07-lindsay-WP.pdf
    </p>
    <p>
      ITW(userspace):http://pxnow.prevx.com/content/blog/carberp-a_modular_information_stealing_trojan.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327019286525" ID="ID_456603226" MODIFIED="1372181444494" TEXT="Dynamically mapping file to memory"/>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326928397947" FOLDED="true" ID="ID_72411548" MODIFIED="1389278160777" TEXT="Userspace&#xa;(Ring 3)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326896599769" ID="ID_1076142415" MODIFIED="1374000138646" TEXT="Direct memory modification via \Device\PhysicalMemory&#xa;(Windows &lt; {Vista, 2003 SP1})">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://www.phrack.org/ show.php?p=59&amp;a=16
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1304865608531" ID="ID_1797572070" MODIFIED="1374000146827" TEXT="ntdll.dll:{Nt,Zw}LoadDriver()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.codeproject.com/KB/system/DLoad.aspx
    </p>
    <p>
      ITW(TDL/TDSS roundabout, by way of AddPrintProvidor/AddPrintProcessor) -
    </p>
    <p>
      http://go.eset.com/us/resources/white-papers/TDL3-Analysis.pdf
    </p>
    <p>
      ITW (zeroaccess/max++) http://www.securelist.com/en/blog/493/MAX_sets_its_sights_on_x64_platforms
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327018394874" ID="ID_574073032" MODIFIED="1374000152790" TEXT="ntdll.dll:{Nt,Zw}SystemDebugControl&#xa;(Windows &lt; Vista)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      POC:http://www.blackhat.com/presentations/bh-usa-07/Lindsay/Whitepaper/bh-usa-07-lindsay-WP.pdf
    </p>
    <p>
      ITW:http://pxnow.prevx.com/content/blog/carberp-a_modular_information_stealing_trojan.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1304865593376" ID="ID_710880044" MODIFIED="1374000159273" TEXT="ntdll.dll:{Nt,Zw}SetSystemInformation() (to map into memory)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://seclists.org/bugtraq/2000/Aug/408
    </p>
    <p>
      ITW: (Zero Access Trojan) http://hbgary.com/martin-pillion-blog
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1304865487167" ID="ID_729993237" MODIFIED="1374000170117" TEXT="Service Control Manager">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      citation: http://msdn.microsoft.com/en-us/library/ms685150(v=vs.85).aspx
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1326895234219" FOLDED="true" ID="ID_1508540290" MODIFIED="1389366320615" TEXT="Anti-Memory Forensics">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1327068176042" FOLDED="true" ID="ID_1919281337" MODIFIED="1389278160777" TEXT="Prevent Physical Memory Aquisition">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326897666079" ID="ID_1517483316" MODIFIED="1373294382717" TEXT="IOMMU"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326895424021" ID="ID_79658128" MODIFIED="1373999602967" TEXT="MTTR/IORR manipulation">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://www.blackhat.com/presentations/bh-dc-07/Rutkowska/Presentation/bh-dc-07-Rutkowska-up.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1327068324076" FOLDED="true" ID="ID_229487399" MODIFIED="1389278160777" TEXT="Feed Misinformation During Physical Memory Aquisition">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326895424021" ID="ID_938726917" MODIFIED="1373999612417" TEXT="MTTR/IORR manipulation">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC:http://www.blackhat.com/presentations/bh-dc-07/Rutkowska/Presentation/bh-dc-07-Rutkowska-up.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1326808173287" FOLDED="true" ID="ID_729710016" MODIFIED="1389278160776" TEXT="Hide Arbitrary Virtual Memory">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326892917103" FOLDED="true" ID="ID_1814962827" MODIFIED="1389278160776" TEXT="Inline/IAT/EAT Hooking">
<node BACKGROUND_COLOR="#cccc00" CREATED="1327068380556" FOLDED="true" ID="ID_1229984958" MODIFIED="1389278160776" TEXT="Userspace (Ring 3)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326892890047" ID="ID_618704510" MODIFIED="1373999634299" TEXT="ntdll.dll:{Nt,Zw}ReadVirtualMemory()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: (hxdef) - http://www.blackhat.com/presentations/bh-usa-04/bh-us-04-butler/bh-us-04-butler.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326895913185" ID="ID_306337273" MODIFIED="1373999643902" TEXT="ntdll.dll:{Nt,Zw}MapViewOfSection()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Rootkit Arsenal Book page 515
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1327068383436" FOLDED="true" ID="ID_417549167" MODIFIED="1389278160776" TEXT="Kernel (Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326892890047" ID="ID_141426042" MODIFIED="1373999654477" TEXT="nt*.exe:{Nt,Zw}ReadVirtualMemory()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: (hxdef) - http://www.blackhat.com/presentations/bh-usa-04/bh-us-04-butler/bh-us-04-butler.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326895913185" ID="ID_1478660752" MODIFIED="1373999659644" TEXT="nt*.exe:{Nt,Zw}MapViewOfSection()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Rootkit Arsenal Book page 515
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327261618537" ID="ID_276612117" MODIFIED="1373999665473" TEXT="nt*.exe:KiDebugRoutine">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://blogs.mcafee.com/mcafee-labs/memory-forging-attempt-by-a-rootkit.
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326892929719" FOLDED="true" ID="ID_671867502" MODIFIED="1389278160776" TEXT="DKOM">
<node BACKGROUND_COLOR="#cccc00" CREATED="1327068383436" FOLDED="true" ID="ID_1663804027" MODIFIED="1389278160776" TEXT="Kernel (Ring 0)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326895969186" ID="ID_1421026022" MODIFIED="1373999678116" TEXT="Manipulate Page Directories/Tables">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: (shadow walker) http://www.phrack.org/issues.html?issue=63&amp;id=8
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326809415111" ID="ID_592368161" MODIFIED="1373999684783" TEXT="VAD modification">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Not a good description of the possibility
    </p>
    <p>
      but just offhandedly mentioned here:
    </p>
    <p>
      https://media.blackhat.com/bh-us-11/Butler/BH_US_11_ButlerMurdock_Physical_Memory_Forensics-WP.pdf
    </p>
    <p>
      Need a better ref
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1327068183818" FOLDED="true" ID="ID_27476997" MODIFIED="1389278160774" TEXT="Exploit Tool Weaknesses&#xa;to Hide Information">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326809275502" ID="ID_226103225" MODIFIED="1373999878712" TEXT="PEB hooking">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.phrack.org/issues.html?issue=62&amp;id=12
    </p>
    <p>
      http://www.phrack.org/issues.html?issue=65&amp;id=10
    </p>
    <p>
      (PEB hooking from kernel not covered, but PEB is accessible from kernel too)
    </p>
    <p>
      (mentioned as weakness of volatility's DllDump in https://media.blackhat.com/bh-us-11/Butler/BH_US_11_ButlerMurdock_Physical_Memory_Forensics-WP.pdf)
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326809415111" ID="ID_1050887642" MODIFIED="1373999884669" TEXT="VAD modification">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Not a good description of the possibility
    </p>
    <p>
      but just offhandedly mentioned here:
    </p>
    <p>
      https://media.blackhat.com/bh-us-11/Butler/BH_US_11_ButlerMurdock_Physical_Memory_Forensics-WP.pdf
    </p>
    <p>
      Need a better ref
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373294110090" FOLDED="true" ID="ID_1996785341" MODIFIED="1389278160774" TEXT="Modify Data Structures (?)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327086525604" ID="ID_53194947" MODIFIED="1373999892955" TEXT="Modify POOL_HEADER">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://jessekornblum.com/presentations/ts10.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327087961309" ID="ID_1680268881" MODIFIED="1373999899558" TEXT="Modify DRIVER_OBJECT">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://web.archive.org/web/20061017031417/http://www.rootkit.com/newsread.php?newsid=316
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327088782446" ID="ID_1142935828" MODIFIED="1373999912010" TEXT="Modify LDR_DATA_TABLE_ENTRY">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://web.archive.org/web/20061017031417/http://www.rootkit.com/newsread.php?newsid=316
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327097335205" ID="ID_1000103401" MODIFIED="1373999918488" TEXT="Modify DISPATCH_HEADER.{Type,Size}">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://www.blackhat.com/presentations/bh-dc-07/Walters/Paper/bh-dc-07-Walters-WP.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327098076252" ID="ID_643355778" MODIFIED="1373999924309" TEXT="Modify OBJECT_HEADER.Type">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://uninformed.org/index.cgi?v=4&amp;a=2&amp;p=22
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1373393046095" ID="ID_214398863" MODIFIED="1389366321741" TEXT="Security Software Evasion">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1326900886371" FOLDED="true" ID="ID_709297112" MODIFIED="1389278160774" TEXT="Prevent Native API Hooking">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327018284841" FOLDED="true" ID="ID_1733683362" MODIFIED="1389278160774" TEXT="Unhook SSDT">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326900890763" ID="ID_1318405543" MODIFIED="1373393192848" TEXT="Kernel">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://pxnow.prevx.com/content/blog/carberp-a_modular_information_stealing_trojan.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327261829062" FOLDED="true" ID="ID_966540878" MODIFIED="1389278160774" TEXT="Remove Filter Drivers">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326900890763" ID="ID_1754339476" MODIFIED="1373393182940" TEXT="Kernel">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://blogs.mcafee.com/mcafee-labs/a-new-variant-of-generic-rootkitd
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327016449462" FOLDED="true" ID="ID_609492513" MODIFIED="1389278160773" TEXT="Restore .text section from disk">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326900900699" ID="ID_1146516455" MODIFIED="1373393211092" TEXT="Userspace">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://go.eset.com/us/resources/white-papers/TDL3-Analysis.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1373469166242" ID="ID_1554493743" MODIFIED="1389366322894" TEXT="Self-Modification">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373554593539" ID="ID_853284942" MODIFIED="1382631513280" STYLE="fork" TEXT="Encrypt Self">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<attribute NAME="Encryption Algorithm" VALUE="XOR, Variable Key, etc."/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373555185773" ID="ID_1514020722" MODIFIED="1374006078226" STYLE="fork" TEXT="Phone Home Update">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381517998615" FOLDED="true" ID="ID_1076577697" MODIFIED="1389366325747" STYLE="fork" TEXT="Change/Add Content">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381518024336" ID="ID_111231203" MODIFIED="1381518085419" STYLE="fork" TEXT="Add Images to SMS Message">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://nakedsecurity.sophos.com/2012/06/14/top-five-android-malware/
    </p>
    <p>
      attempts to evade detection by adding a random number of images&#160;therefore making the APK file binary different every few downloads
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1373469166242" ID="ID_1452841565" MODIFIED="1389366327270" TEXT="Hide Non-Executing Code">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378579794161" FOLDED="true" ID="ID_863303859" MODIFIED="1389278160773" STYLE="fork" TEXT="Hide Code in File (steganography)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://blog.sucuri.net/2013/07/malware-hidden-inside-jpg-exif-headers.html
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<attribute NAME="File Type" VALUE="Image"/>
<attribute NAME="Code Location" VALUE="EXIF Header, etc."/>
<attribute NAME="Image File Format" VALUE="JPG, GIF, BMP, etc."/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378579886187" FOLDED="true" ID="ID_846402518" MODIFIED="1389278160773" STYLE="fork" TEXT="Execute Image Header Content">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378579859604" ID="ID_1079422678" MODIFIED="1378579956573" STYLE="fork" TEXT="exif_read_data PHP Function">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378579910715" ID="ID_1761025570" MODIFIED="1378580111026" STYLE="fork" TEXT="preg_replace PHP Function">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Will execute content instead of replace if &quot;/e&quot; modifier is used.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ccccff" CREATED="1305639112542" ID="Freemind_Link_1380674342" MODIFIED="1389278176230" TEXT="Persistence">
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372784939452" ID="ID_1302397122" MODIFIED="1389366287389" TEXT="Persist to Continuously Execute on System">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372784994974" ID="ID_142533722" MODIFIED="1389726233679" TEXT="Persist After OS Install/Reinstall">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1305639558657" ID="Freemind_Link_1275260376" MODIFIED="1372170071018" TEXT="Infect/Replace Master Boot Record"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1305639568186" ID="Freemind_Link_1914831238" MODIFIED="1372170071018" TEXT="Infect/Replace Partition Boot Record"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372784915280" ID="ID_1004373429" MODIFIED="1389726232411" TEXT="Persist Independent of Hard Disk/OS Changes">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1305639141241" ID="Freemind_Link_480760753" MODIFIED="1372170071018" TEXT="Infect/Replace BIOS"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1305639174827" ID="Freemind_Link_1236130643" MODIFIED="1372170071018" TEXT="Infect/Replace PCI Option ROM"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372784871535" ID="ID_1093721398" MODIFIED="1389726210797" TEXT="Persist After System Reboot">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1305639369153" ID="Freemind_Link_1111906197" MODIFIED="1372170071018" TEXT="Infect/Replace Executable File"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1305639123624" FOLDED="true" ID="ID_397895229" MODIFIED="1389726229017" TEXT="Use Native Auto-start Mechanism">
<node BACKGROUND_COLOR="#cccc00" CREATED="1305639447204" ID="Freemind_Link_1965568861" MODIFIED="1389726214648" TEXT="Invoked at startup">
<node BACKGROUND_COLOR="#cccc00" CREATED="1305639656753" ID="Freemind_Link_1363686644" MODIFIED="1372183239555" TEXT="Boot-start service"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1369321848640" ID="ID_1101248857" MODIFIED="1372183239556" TEXT="Programs\Startup folder">
<arrowlink DESTINATION="ID_1101248857" ENDARROW="Default" ENDINCLINATION="0;0;" ID="Arrow_ID_262845703" STARTARROW="None" STARTINCLINATION="0;0;"/>
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1101248857" ENDARROW="Default" ENDINCLINATION="0;0;" ID="Arrow_ID_262845703" SOURCE="ID_1101248857" STARTARROW="None" STARTINCLINATION="0;0;"/>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1305639458045" ID="Freemind_Link_1736465128" MODIFIED="1389726216102" TEXT="Invoked at login">
<node BACKGROUND_COLOR="#cccc00" CREATED="1305639791758" FOLDED="true" ID="Freemind_Link_686555217" MODIFIED="1389726218552" TEXT="Registry Run Keys">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1305639808694" ID="Freemind_Link_168072024" MODIFIED="1372173410294" TEXT="HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1305640213499" ID="Freemind_Link_911211037" MODIFIED="1372173410312" TEXT="HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1305640228395" ID="Freemind_Link_1946049663" MODIFIED="1372173410311" TEXT="HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1305640284340" ID="Freemind_Link_1314424172" MODIFIED="1372173410310" TEXT="HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Runonce"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1305640287532" ID="Freemind_Link_422248756" MODIFIED="1372173410309" TEXT="HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\RunonceEx"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369251862751" ID="ID_206691743" MODIFIED="1372173410308" TEXT="HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252014994" FOLDED="true" ID="ID_964496746" MODIFIED="1389278160770" TEXT="">
<node CREATED="1369252104291" ID="ID_1382999886" MODIFIED="1369252109403" TEXT="HKLM\SOFTWARE\Classes\Protocols\Filter"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252030558" ID="ID_880243409" MODIFIED="1372173410308" TEXT="HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252048022" ID="ID_914305785" MODIFIED="1372173410307" TEXT="HKLM\SOFTWARE\Wow6432Node\Microsoft\Active Setup\Installed Components"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252073051" ID="ID_958291360" MODIFIED="1372173410307" TEXT="HKCU\Software\Microsoft\Windows\CurrentVersion\Run"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252115921" ID="ID_984300920" MODIFIED="1372173410307" TEXT="HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\ShellExecuteHooks"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252135786" ID="ID_870344990" MODIFIED="1372173410307" TEXT="HKCU\Software\Classes\*\ShellEx\ContextMenuHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252147598" ID="ID_1446658380" MODIFIED="1372173410306" TEXT="HKLM\Software\Classes\*\ShellEx\ContextMenuHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252160906" ID="ID_1917072818" MODIFIED="1372173410306" TEXT="HKLM\Software\Wow6432Node\Classes\*\ShellEx\ContextMenuHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252177383" ID="ID_289603724" MODIFIED="1372173410306" TEXT="HKLM\Software\Classes\*\ShellEx\PropertySheetHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252187007" ID="ID_79203567" MODIFIED="1372173410305" TEXT="HKLM\Software\Wow6432Node\Classes\*\ShellEx\PropertySheetHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252205223" ID="ID_216500023" MODIFIED="1372173410305" TEXT="HKLM\Software\Classes\AllFileSystemObjects\ShellEx\ContextMenuHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252266810" ID="ID_1456947882" MODIFIED="1372173410305" TEXT="HKCU\Software\Classes\Directory\ShellEx\ContextMenuHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252278421" ID="ID_444336591" MODIFIED="1372173410305" TEXT="HKLM\Software\Classes\Directory\ShellEx\ContextMenuHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252289911" ID="ID_1189523811" MODIFIED="1372173410304" TEXT="HKLM\Software\Wow6432Node\Classes\Directory\ShellEx\ContextMenuHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252302005" ID="ID_1637394134" MODIFIED="1372173410304" TEXT="HKLM\Software\Classes\Directory\Shellex\DragDropHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252312267" ID="ID_1479957411" MODIFIED="1372173410304" TEXT="HKLM\Software\Wow6432Node\Classes\Directory\Shellex\DragDropHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252325060" ID="ID_1301695113" MODIFIED="1372173410303" TEXT="HKLM\Software\Classes\Directory\Shellex\PropertySheetHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252333953" ID="ID_517477502" MODIFIED="1372173410303" TEXT="HKLM\Software\Wow6432Node\Classes\Directory\Shellex\PropertySheetHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252396638" ID="ID_1074120485" MODIFIED="1372173410303" TEXT="HKLM\Software\Classes\Directory\Shellex\CopyHookHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252411186" ID="ID_1555144440" MODIFIED="1372173410303" TEXT="HKLM\Software\Wow6432Node\Classes\Directory\Shellex\CopyHookHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252423347" ID="ID_501109583" MODIFIED="1372173410302" TEXT="HKCU\Software\Classes\Directory\Background\ShellEx\ContextMenuHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252438967" ID="ID_995319803" MODIFIED="1372173410302" TEXT="HKLM\Software\Classes\Directory\Background\ShellEx\ContextMenuHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252470407" ID="ID_1042328968" MODIFIED="1372173410302" TEXT="HKLM\Software\Wow6432Node\Classes\Directory\Background\ShellEx\ContextMenuHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252484234" ID="ID_829145412" MODIFIED="1372173410302" TEXT="HKCU\Software\Classes\Folder\Shellex\ColumnHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369252495508" ID="ID_244094884" MODIFIED="1372173410301" TEXT="HKLM\Software\Classes\Folder\Shellex\ColumnHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369318833295" ID="ID_1349929044" MODIFIED="1372173410301" TEXT="HKLM\Software\Wow6432Node\Classes\Folder\Shellex\ColumnHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369318847395" ID="ID_629749267" MODIFIED="1372173410301" TEXT="HKCU\Software\Classes\Folder\ShellEx\ContextMenuHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369318856900" ID="ID_1595880261" MODIFIED="1372173410300" TEXT="HKLM\Software\Classes\Folder\ShellEx\ContextMenuHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369318865797" ID="ID_977465306" MODIFIED="1372173410300" TEXT="HKLM\Software\Wow6432Node\Classes\Folder\ShellEx\ContextMenuHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369318883055" ID="ID_1689391300" MODIFIED="1372173410300" TEXT="HKLM\Software\Classes\Folder\ShellEx\DragDropHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320252861" ID="ID_1004609414" MODIFIED="1372173410300" TEXT="HKLM\Software\Wow6432Node\Classes\Folder\ShellEx\DragDropHandlers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320265355" ID="ID_438252781" MODIFIED="1372173410299" TEXT="HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320279685" ID="ID_1252583946" MODIFIED="1372173410299" TEXT="HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320296261" ID="ID_118281068" MODIFIED="1372173410299" TEXT="HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320310556" ID="ID_498419456" MODIFIED="1372173410298" TEXT="HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320321005" ID="ID_1212267902" MODIFIED="1372173410298" TEXT="HKLM\Software\Microsoft\Internet Explorer\Extensions"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320334282" ID="ID_1691680824" MODIFIED="1372173410298" TEXT="HKLM\Software\Wow6432Node\Microsoft\Internet Explorer\Extensions"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320346895" ID="ID_1326958045" MODIFIED="1372173410298" TEXT="HKLM\System\CurrentControlSet\Services"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320404555" ID="ID_1066016271" MODIFIED="1372173410297" TEXT="HKLM\Software\Microsoft\Windows NT\CurrentVersion\Drivers32"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320428924" ID="ID_1823517404" MODIFIED="1372173410297" TEXT="HKLM\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Drivers32"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320517403" ID="ID_1803493976" MODIFIED="1372173410297" TEXT="HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320533485" ID="ID_593635073" MODIFIED="1372173410296" TEXT="HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320546375" ID="ID_1464447584" MODIFIED="1372173410296" TEXT="HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Credential Providers"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320561759" ID="ID_232654427" MODIFIED="1372173410296" TEXT="HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Credential Provider Filters"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320572494" ID="ID_1683826624" MODIFIED="1372173410296" TEXT="HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320585371" ID="ID_441432303" MODIFIED="1372173410295" TEXT="HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\Protocol_Catalog9\Catalog_Entries"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320595208" ID="ID_538370469" MODIFIED="1372173410295" TEXT="HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\Protocol_Catalog9\Catalog_Entries64"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320604571" ID="ID_1905247605" MODIFIED="1372173410295" TEXT="HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369320614073" ID="ID_969617306" MODIFIED="1372173410294" TEXT="HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order"/>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1305639465506" ID="Freemind_Link_738232347" MODIFIED="1389726219594" TEXT="Invoked at program launch">
<node BACKGROUND_COLOR="#cccc00" CREATED="1305639497865" ID="Freemind_Link_555693619" MODIFIED="1389726220966" TEXT="DLL Search Path Hijacking">
<node BACKGROUND_COLOR="#cccc00" CREATED="1372273814352" ID="ID_333431112" MODIFIED="1374000269748" TEXT="Binary Planting">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://blog.trendmicro.com/trendlabs-security-intelligence/zaccesssirefef-arrives-with-new-infection-technique/
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1305639776478" ID="Freemind_Link_647241759" MODIFIED="1389726224296" TEXT="AppInit_DLLs">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1305639900534" ID="Freemind_Link_420789474" MODIFIED="1372273860591" TEXT="HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls"/>
</node>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372785947812" ID="ID_654370270" MODIFIED="1389366285917" TEXT="Persist to Re-infect System">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372786357160" ID="ID_1086335793" MODIFIED="1389726235665" TEXT="Reinstantiate Self after Initial Detection">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372786419778" FOLDED="true" ID="ID_1228902655" MODIFIED="1389278160769" TEXT="File Association Hijacking">
<arrowlink DESTINATION="ID_1228902655" ENDARROW="Default" ENDINCLINATION="0;0;" ID="Arrow_ID_1261010390" STARTARROW="None" STARTINCLINATION="0;0;"/>
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1228902655" ENDARROW="Default" ENDINCLINATION="0;0;" ID="Arrow_ID_1261010390" SOURCE="ID_1228902655" STARTARROW="None" STARTINCLINATION="0;0;"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1372786456974" ID="ID_437739552" MODIFIED="1374000279673" TEXT="HKEY_CLASSES_ROOT">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      https://isc.sans.edu/diary/Wipe+the+drive+Stealthy+Malware+Persistence+Mechanism+-+Part+1/15394
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372786809836" FOLDED="true" ID="ID_1024666521" MODIFIED="1389278160769" TEXT="Scheduled File Download">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1372786855432" ID="ID_266272235" MODIFIED="1374000287868" TEXT="BITS Backdoor">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      https://isc.sans.edu/diary/Wipe+the+drive+Stealthy+Malware+Persistence+Mechanism+-+Part+1/15394
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372787465572" FOLDED="true" ID="ID_1099118283" MODIFIED="1389278160769" TEXT="Add Automatic Recovery Action">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1372787545482" ID="ID_1893768877" MODIFIED="1374000295613" TEXT="Service Failure Recovery Startup">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      https://isc.sans.edu/diary/Wipe+the+drive+Stealthy+Malware+Persistence+-+Part+2/15406
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372787648289" FOLDED="true" ID="ID_1147963593" MODIFIED="1389278160769" TEXT="Exploit Unquoted Path Vulnerability">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1372787691847" ID="ID_1994082" MODIFIED="1374000303938" TEXT="Program.exe">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      https://isc.sans.edu/diary/Wipe+the+drive+Stealthy+Malware+Persistence+-+Part+2/15406
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372789182952" FOLDED="true" ID="ID_1990155764" MODIFIED="1389278160769" TEXT="Attach Debugger to Infrequently Used Process">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1372789211552" ID="ID_1177871816" MODIFIED="1374000312930" TEXT="ImageFileExecutionOptions">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      https://isc.sans.edu/diary/Wipe+the+drive!++Stealthy+Malware+Persistence+-+Part+3/15448
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372789337261" FOLDED="true" ID="ID_1631439788" MODIFIED="1389278160769" TEXT="Attach Self to Logon/Logoff Event">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1372789555589" ID="ID_574638315" MODIFIED="1374000408735">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="rgb(0, 0, 0)" face="Lucida Grande, Lucida Sans Unicode, Helvetica, Arial, Verdana, sans-serif" size="3">HKEY_LOCAL_MACHINESoftwareMicrosoftWindows NTCurrentVersionWinlogonNotify</font>
    </p>
  </body>
</html></richcontent>
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      https://isc.sans.edu/diary/Wipe+the+drive!++Stealthy+Malware+Persistence+-+Part+4/15460
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1378528109997" ID="ID_1604125248" MODIFIED="1389366296475" STYLE="fork" TEXT="Gather Information for Improvement">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378481611265" ID="ID_174380483" MODIFIED="1378528147969" STYLE="fork" TEXT="Drop/Retrieve Debug Log File">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      capture errors about malware to improve tools and learn; http://blog.trendmicro.com/trendlabs-security-intelligence/unplugging-plugx-capabilities/
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ccccff" CREATED="1354303929388" ID="ID_948765614" MODIFIED="1389278177082" TEXT="Security Degradation">
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372183124958" ID="ID_1164126749" MODIFIED="1389713569377" TEXT="Disable Service Provider Security Features">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381517464210" FOLDED="true" ID="ID_558116332" MODIFIED="1389366282033" STYLE="fork" TEXT="Remove SMS Warning Messages">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://nakedsecurity.sophos.com/2012/06/14/top-five-android-malware/&#160;&#160;
    </p>
    <p>
      Scan your incoming SMS messages and automatically remove warnings that you are being charged a fee for using premium rate services it has signed you up for
    </p>
    <p>
      .
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381517521407" ID="ID_1970840678" MODIFIED="1381517562292" STYLE="fork" TEXT="Scan Incoming SMS Messages">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381517537625" ID="ID_604957710" MODIFIED="1381517562296" STYLE="fork" TEXT="Remove SMS Messages">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372183124958" ID="ID_1877039231" MODIFIED="1389713570372" TEXT="Disable OS Security Features">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372446338555" FOLDED="true" ID="ID_1358813701" MODIFIED="1389278160768" TEXT="Disable Kernel Patching Protection">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1354303993426" FOLDED="true" ID="ID_5183068" MODIFIED="1389278160768" TEXT="Disable Windows Kernel Patch Protection (KPP aka PatchGuard)">
<node BACKGROUND_COLOR="#cccc00" CREATED="1354304036344" FOLDED="true" ID="ID_391805994" MODIFIED="1389278160768" TEXT="v2">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354305460463" ID="ID_448921203" MODIFIED="1374000433589" TEXT="Exception Handler Hooking">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://uninformed.org/index.cgi?v=3&amp;a=3&amp;p=16
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354305513106" ID="ID_1757072513" MODIFIED="1374000439964" TEXT="KeBugCheckEx Hook">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://uninformed.org/index.cgi?v=3&amp;a=3&amp;p=17
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354305526986" ID="ID_1823338319" MODIFIED="1374000449061" TEXT="Finding the Timer">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=3&amp;a=3&amp;p=18
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354305543442" ID="ID_479804280" MODIFIED="1374000456549" TEXT="Hybrid Interception">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=3&amp;a=3&amp;p=19
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354305580138" ID="ID_636052112" MODIFIED="1374000466190" TEXT="Simulated Hot Patching">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=3&amp;a=3&amp;p=20
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354305606546" ID="ID_260642324" MODIFIED="1374000473403" TEXT="Interception of _C_specific_handler">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=6&amp;a=1&amp;p=14
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354305673193" ID="ID_393859407" MODIFIED="1374000480536" TEXT="Interception of DPC Exception Registration">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=6&amp;a=1&amp;p=15
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354305696530" ID="ID_1255653220" MODIFIED="1374000488331" TEXT="Interception of PsInvertedFunctionTable">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=6&amp;a=1&amp;p=16
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354305714857" ID="ID_1859465512" MODIFIED="1374000502956" TEXT="Interception of KiDebugTrapOrFault">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=6&amp;a=1&amp;p=17
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354305729809" ID="ID_810468939" MODIFIED="1374000509505" TEXT="General Detect Bit Interception">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=6&amp;a=1&amp;p=18
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354305747834" ID="ID_972142018" MODIFIED="1374000515709" TEXT="Patching the Kernel Timer DPC Dispatcher">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=6&amp;a=1&amp;p=19
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354305762346" ID="ID_1576643354" MODIFIED="1374000524276" TEXT="Searching for the PatchGuard DPC">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=6&amp;a=1&amp;p=20
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354305771178" ID="ID_1859903741" MODIFIED="1374000531320" TEXT="TLB Desynchronization (Split TLB)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=6&amp;a=1&amp;p=21
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354305785778" ID="ID_1058284743" MODIFIED="1374000539333" TEXT="DPC Routine Patching">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=6&amp;a=1&amp;p=22
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1354304038394" FOLDED="true" ID="ID_210267385" MODIFIED="1389278160767" TEXT="v3">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354304446842" ID="ID_173450428" MODIFIED="1374000578769" TEXT="Hybrid Exception Interception and Memory Searching">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=8&amp;a=5&amp;p=16
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354304488226" ID="ID_103361713" MODIFIED="1374000586690" TEXT="Timer DPC Dispatcher and DPC Dispatching">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=8&amp;a=5&amp;p=17
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354304506474" ID="ID_1862191410" MODIFIED="1374000593711" TEXT="Canceling the PatchGuard Timer(s)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=8&amp;a=5&amp;p=18
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354304528547" ID="ID_232791223" MODIFIED="1374000599404" TEXT="Page-Table Swap (TOCTOU)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=8&amp;a=5&amp;p=19
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354304537906" ID="ID_1514052249" MODIFIED="1374000608552" TEXT="DPC Exception Handler Patching">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=8&amp;a=5&amp;p=20
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354304583929" ID="ID_144448312" MODIFIED="1374000618660" TEXT="System Call MSR Swap">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: http://uninformed.org/index.cgi?v=8&amp;a=5&amp;p=21
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354304074858" ID="ID_315820000" MODIFIED="1374000628349" TEXT="Modify winload.exe &amp; ntoskrnl.exe">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://fyyre.ivory-tower.de/projects/bootloader.txt, http://fyyre.ivory-tower.de/projects/no_pg_ds_v3.rar
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354306246553" ID="ID_826644909" MODIFIED="1374000635215" TEXT="Patching Nt!KiTimerListExpire, nt!KiRetireDpcList, nt!ExpWorkerThread, nt!KeBugCheckEx">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: EasyHook - The reinvention of Windows API Hooking http://easyhook.codeplex.com
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354308295441" ID="ID_49762463" MODIFIED="1374000642796" TEXT="Encrypted Return Hook">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Discussion: (page 12) http://www.mcafee.com/us/resources/reports/rp-defeating-patchguard.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372442777131" FOLDED="true" ID="ID_1100915912" MODIFIED="1389278160767" TEXT="Disable System File Overwrite Protection">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1354461175849" ID="ID_1139825950" MODIFIED="1373914691682" TEXT="Disable Windows File Protection">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://www.ntcore.com/files/wfp.htm
    </p>
    <p>
      ITW: http://www.fortiguard.com/analysis/pushdoanalysis.html
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372448737530" FOLDED="true" ID="ID_1180869995" MODIFIED="1389278160767" TEXT="Disable OS Security Alerts">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1354411298894" FOLDED="true" ID="ID_153123013" MODIFIED="1389278160767" TEXT="Disable Windows Security Alert notifications (Windows built in)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354411307534" ID="ID_1977823658" MODIFIED="1373914672746" TEXT="Delete key HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\explorer\ShellServiceObjects\{FD6905CE-952F-41F1-9A6F-135D9C6622CC}">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.symantec.com/security_response/writeup.jsp?docid=2008-112203-2408-99&amp;tabid=2
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378618086525" FOLDED="true" ID="ID_913966552" MODIFIED="1389278160767" STYLE="fork" TEXT="Disable User Account Control (UAC)">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378618044053" ID="ID_1301718325" MODIFIED="1378618852889" STYLE="fork" TEXT="Disable Software">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378618115417" ID="ID_274901476" MODIFIED="1378618852891" STYLE="fork" TEXT="Trick User Into Clicking OK">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1354304654434" ID="ID_329526321" MODIFIED="1389713571314" TEXT="Disable Access Controls">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1354303951698" ID="ID_1486843019" MODIFIED="1374006096695" TEXT="Disable Firewall">
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372442865223" FOLDED="true" ID="ID_1517542117" MODIFIED="1389278160766" TEXT="Disable Access Right Checking">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1354304660138" ID="ID_1242269027" MODIFIED="1373914682264" TEXT="Disable SeAccessCheck">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://phrack.org/issues.html?issue=55&amp;id=5
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372443454723" FOLDED="true" ID="ID_324928577" MODIFIED="1389278160766" TEXT="Disable Privilege Limiting">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1354304666290" ID="ID_740652668" MODIFIED="1372443512810" TEXT="Disable UAC"/>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1354304014458" ID="ID_511770625" MODIFIED="1389713572406" TEXT="Disable System Updates">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372446819060" FOLDED="true" ID="ID_1936658241" MODIFIED="1389278160766" TEXT="Disable System Service Pack/Patch Installation">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1354410410086" FOLDED="true" ID="ID_663931227" MODIFIED="1389278160766" TEXT="Disable XP SP2 Installation">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354410419814" ID="ID_1413352628" MODIFIED="1373914663033" TEXT="Set Key&#xa;HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate DoNotAllowXPSP2 = 1">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.symantec.com/security_response/writeup.jsp?docid=2005-022614-4627-99&amp;tabid=2
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372447246427" FOLDED="true" ID="ID_576611445" MODIFIED="1389278160766" TEXT="Disable System Update Services/Daemons">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1354411359895" FOLDED="true" ID="ID_152076617" MODIFIED="1389278160766" TEXT="Disable Windows Services">
<node BACKGROUND_COLOR="#cccc00" CREATED="1354411364703" FOLDED="true" ID="ID_1535395021" MODIFIED="1389278160766" TEXT="BITS (a service that downloads and delivers Windows updates in the background)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354410419814" ID="ID_776262641" MODIFIED="1373914632041" TEXT="Set Key&#xa;HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\BITS\Start = 4">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.symantec.com/security_response/writeup.jsp?docid=2008-112203-2408-99&amp;tabid=2
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1354411503391" FOLDED="true" ID="ID_647226549" MODIFIED="1389278160766" TEXT="wuauserv (the on-demand Windows Update service)">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354410419814" ID="ID_384464029" MODIFIED="1373914636930" TEXT="Set Key&#xa;HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\wuauserv\Start = 4">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.symantec.com/security_response/writeup.jsp?docid=2008-112203-2408-99&amp;tabid=2
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372448876146" ID="ID_862081974" MODIFIED="1389713573578" TEXT="Degrade Security Programs">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378393421304" ID="ID_790243328" MODIFIED="1378619046962" STYLE="fork" TEXT="Gather Security Product Info">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1354459413538" FOLDED="true" ID="ID_529296449" MODIFIED="1389713613691" TEXT="Prevent Security Program from Running">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1354459836208" FOLDED="true" ID="ID_990533009" MODIFIED="1389278160765" TEXT="Set Image File Execution Options Debugger Option for Security Program File Name">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354459880064" ID="ID_6089602" MODIFIED="1373914476242" TEXT="Set Key&#xa;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\&lt;exename&gt;\debugger = &lt;debugger exe&gt;">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.mcafee.com/threat-intelligence/malware/default.aspx?id=355726
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1354459421842" FOLDED="true" ID="ID_741069663" MODIFIED="1389278160765" TEXT="Set Image File Execution Options for Security Program File Name">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354459853872" ID="ID_827511781" MODIFIED="1373914467725" TEXT="Set Key&#xa;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\&lt;exe name&gt;">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.mcafee.com/threat-intelligence/malware/default.aspx?id=355726
    </p>
    <p>
      ITW: http://www.symantec.com/security_response/writeup.jsp?docid=2008-112203-2408-99&amp;tabid=2
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1354459527330" ID="ID_1362151071" MODIFIED="1373914358011" TEXT="Set File ACL to Non-Executable">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.prevxresearch.com/zeroaccess_analysis.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1354304231810" FOLDED="true" ID="ID_621533332" MODIFIED="1389278160765" TEXT="Modify Security Program Configuration">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1354411664393" ID="ID_45708975" MODIFIED="1373914364047" TEXT="Disable WinDefend (a service for Windows Defender)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.symantec.com/security_response/writeup.jsp?docid=2008-112203-2408-99&amp;tabid=2
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1354411560666" FOLDED="true" ID="ID_360006604" MODIFIED="1389278160765" TEXT="Delete Windows Defender Autorun">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1354411574490" ID="ID_273334277" MODIFIED="1373914300917" TEXT="Delete Key&#xa;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\&quot;Windows Defender&quot; ">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.symantec.com/security_response/writeup.jsp?docid=2008-112203-2408-99&amp;tabid=2
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372449226900" FOLDED="true" ID="ID_1005926034" MODIFIED="1389278160765" TEXT="Stop Execution of Security Program">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326901061924" FOLDED="true" ID="ID_1550637634" MODIFIED="1389278160765" TEXT="Kill Security Programs&apos; Processes">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326922147018" ID="ID_775165959" MODIFIED="1373914271251" TEXT="Queue APC to ExitProcess() if scanned">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://blogs.mcafee.com/mcafee-labs/zeroaccess-rootkit-launched-by-signed-installers
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372449226900" FOLDED="true" ID="ID_540389334" MODIFIED="1389278160765" TEXT="Prevent Access to Security Websites">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326901061924" ID="ID_257114651" MODIFIED="1382626646403" TEXT="DNS Filtration">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      A DNS filter program blocks access to well known security websites.
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1367952826569" ID="ID_1855918133" MODIFIED="1389278403042" POSITION="left" TEXT="Payload Capabilities">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &quot;Payload Capabilities&quot; rather than just &quot;Capabilities&quot; seems to better indicate that the capabilities are within the code of the malware instance.
    </p>
  </body>
</html></richcontent>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1371228408246" ID="ID_1171342120" MODIFIED="1389278180640" TEXT="Supporting">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ccccff" CREATED="1367952882540" ID="ID_262649388" MODIFIED="1389278181420" STYLE="fork" TEXT="Command and Control (C2)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Included &quot;Botnet&quot; to distinguish it from other remote machine control (backdoors, RATs, etc.)
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<attribute_layout NAME_WIDTH="96" VALUE_WIDTH="171"/>
<attribute NAME="Proxy Awareness" VALUE="(yes/no)"/>
<attribute NAME="Protocol" VALUE="IRC, HTTP, etc."/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1378510718234" ID="ID_1395919333" MODIFIED="1389278183080" STYLE="fork" TEXT="Maintain Botnet">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <a href="https://www.damballa.com/downloads/r_pubs/WP_Botnet_Communications_Primer.pdf">https://www.damballa.com/downloads/r_pubs/WP_Botnet_Communications_Primer.pdf</a>
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<attribute NAME="Topology" VALUE="star, multi-server, hierarchical, random"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1368125758015" FOLDED="true" ID="ID_282315241" MODIFIED="1389278160764" TEXT="Update Bot Configuration">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372439776281" FOLDED="true" ID="ID_679377935" MODIFIED="1389278160764" TEXT="Download Configuration File">
<node BACKGROUND_COLOR="#cccc00" CREATED="1369320848897" ID="ID_1937388640" MODIFIED="1372179127156" TEXT="Custom Protocol"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1370875198176" FOLDED="true" ID="ID_1859997077" MODIFIED="1389278160764" TEXT="Existing Protocol">
<node BACKGROUND_COLOR="#cccc00" CREATED="1367957968349" FOLDED="true" ID="ID_572089185" MODIFIED="1389278160764" TEXT="HTTP">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368043392823" ID="ID_149647347" MODIFIED="1372173351197" TEXT="HTTP GET request"/>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1368042507234" FOLDED="true" ID="ID_207808351" MODIFIED="1389278160763" TEXT="Update Bot List (Beaconing)">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372429867874" FOLDED="true" ID="ID_861220721" MODIFIED="1389278160763" TEXT="Send Email w/ System Details">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368039147037" ID="ID_513127394" MODIFIED="1372170260769" TEXT="SMTP Send Email"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372440234520" FOLDED="true" ID="ID_1544368886" MODIFIED="1389278160763" TEXT="Send System Details Through HTTP">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1368043392823" ID="ID_657385477" MODIFIED="1374001022538" TEXT="HTTP Request user_agent field">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.us-cert.gov/ncas/alerts/TA13-141A
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1381808056569" ID="ID_626416296" MODIFIED="1389378388011" STYLE="fork" TEXT="Communicate with C2 Servers">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Instead of using hardcoded server addresses, some malware families now use a domain generating algorithm (DGA) in order to dynamically determine remote download server address and C2 server addresses at run time.&#160;&#160;(Crowdstrike; End-To-End Analysis of a DGA Malware Family.&quot;
    </p>
    <p>
      Also: <a href="https://www.damballa.com/downloads/r_pubs/WP_Botnet_Communications_Primer.pdf">https://www.damballa.com/downloads/r_pubs/WP_Botnet_Communications_Primer.pdf</a>
    </p>
  </body>
</html>
</richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<attribute NAME="Uses Fluxing" VALUE="(yes/no)"/>
<attribute NAME="IP Fluxing Type" VALUE="single-flux, double-flux"/>
<attribute NAME="DNS Fluxing type" VALUE="Domain Wildcarding, Domain Generation Algorithm"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1389378463100" ID="ID_1148602792" MODIFIED="1389378477562" TEXT="Determine C2 Server"/>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1378520492672" ID="ID_442168383" MODIFIED="1389278183082" STYLE="fork" TEXT="Botnet-Based Attacks">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<node CREATED="1378526856663" ID="ID_806202964" MODIFIED="1378526895801" TEXT="see Objective-Oriented Capabilities"/>
</node>
</node>
<node BACKGROUND_COLOR="#ccccff" CREATED="1373121684458" ID="ID_1557812849" MODIFIED="1389278181422" STYLE="fork" TEXT="Remote Machine Manipulation">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1388506510300" ID="ID_768852662" MODIFIED="1388506633293" TEXT="Search For Remote Machines">
<font NAME="SansSerif" SIZE="14"/>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1388506525348" ID="ID_527947337" MODIFIED="1389278183084" TEXT="Access Remote Machine">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font face="SansSerif">Functionality that enables malware to have remote machine access, whether for self-propagation or for other purposes, should be considered a supporting capability, along with capabilities such as &#8220;remote machine control&#8221;, &#160;&#8220;data exfiltration&#8221;, etc.&#160;&#160;Once *access* is achieved, a machine is infected via mechanism defined under &quot;Infection.&quot;</font>
    </p>
  </body>
</html></richcontent>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373040004549" ID="ID_1726691143" MODIFIED="1389643020995" STYLE="fork" TEXT="Compromise Remote Machine">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<attribute_layout NAME_WIDTH="66" VALUE_WIDTH="204"/>
<attribute NAME="vulnerability" VALUE="zero-day, known"/>
<attribute NAME="target" VALUE="email client, application, browser, OS"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381348704838" FOLDED="true" ID="ID_231185865" MODIFIED="1389278160762" STYLE="fork" TEXT="Exploit Near Field Communications (NFC)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Android-related:&#160;
    </p>
    <div style="font-family: monospace; font-size: 11.9552px" data-canvas-width="232.229766920986" dir="ltr" data-font-name="g_font_9_0">
      http://www.extremetech.com/computing/133501-black-hat-hacker-lays-waste-to-android-and-meego-using-nfc-exploits The malware would be on one phone and it would be compromising another phone in close physical proximity.
    </div>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381446692822" FOLDED="true" ID="ID_1540302217" MODIFIED="1389278160762" STYLE="fork" TEXT="Exploit Memory Corruption Bug">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Android 2.3 Gingerbread - memory corruption bug allows control of the NFC daemon with a specially designed RFID tag.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1381449768109" ID="ID_1041568284" MODIFIED="1381461420375" STYLE="fork" TEXT="Send Special RFID tag">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381356020437" ID="ID_642335378" MODIFIED="1381515902959" STYLE="fork" TEXT="Exploit Android WebKit Browser">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.h-online.com/security/news/item/Android-smartphones-infected-via-drive-by-exploit-Update-1446992.html
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381433842527" ID="ID_451576202" MODIFIED="1381461378240" STYLE="fork" TEXT="Exploit Kernel">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.androidcentral.com/samsung-exynos-kernel-exploit-what-you-need-know
    </p>
    <p>
      one-click root APK.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373041472355" FOLDED="true" ID="ID_496585044" MODIFIED="1389278160762" STYLE="fork" TEXT="Exploit Application Vulnerability">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      This is really a behavior.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373039987820" ID="ID_1962582008" MODIFIED="1374006134822" STYLE="fork" TEXT="Scan for Vulnerabilities">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373035168667" FOLDED="true" ID="ID_126117474" MODIFIED="1389278160762" STYLE="fork" TEXT="Exploit Configuration Vulnerabiity">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      This is really a behavior. This can be done by malware code or by an attacker directly (i.e., also included as initial infection item)
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<attribute NAME="Network" VALUE="tcp/ip,bluetooth,mobilephone"/>
<attribute NAME="Vulnerability Type" VALUE="Weak Password, Default Password, ACL Issues, Single-factor Authentication"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373044233622" ID="ID_897559925" MODIFIED="1382637422276" STYLE="fork" TEXT="Abuse Feature">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372431571200" ID="ID_1269771666" MODIFIED="1389278183089" STYLE="fork" TEXT="Control Remote Machine">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      This node covers general capabilities that a backdoor or RAT would offer to support object-oriented capabilities
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<attribute_layout NAME_WIDTH="116" VALUE_WIDTH="116"/>
<attribute NAME="Remote Access Type" VALUE=""/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1369332194541" FOLDED="true" ID="ID_139106050" MODIFIED="1389278160761" TEXT="Execute Remote Command">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://blog.trendmicro.com/trendlabs-security-intelligence/unplugging-plugx-capabilities/ (remote access tool XPlug)
    </p>
  </body>
</html></richcontent>
<font NAME="SansSerif" SIZE="13"/>
<attribute NAME="obfuscation" VALUE="yes, no"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378500983276" FOLDED="true" ID="ID_954796460" MODIFIED="1389278160761" STYLE="fork" TEXT="Perform Disk Operations">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378501078859" ID="ID_1396608995" MODIFIED="1378510501057" STYLE="fork" TEXT="Get Drive Information">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378501356676" FOLDED="true" ID="ID_528345676" MODIFIED="1389278160761" STYLE="fork" TEXT="Perform Registry Operations">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378501372088" ID="ID_1174344801" MODIFIED="1378510501056" STYLE="fork" TEXT="Enumerate Registry Key">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378501383640" ID="ID_1525719873" MODIFIED="1378510501054" STYLE="fork" TEXT="Create Registry Key">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378501394608" ID="ID_1600140058" MODIFIED="1378510501051" STYLE="fork" TEXT="Delete Registry Key">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378501404466" ID="ID_1691817103" MODIFIED="1378510501049" STYLE="fork" TEXT="Copy Registry Key">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378501411826" ID="ID_1606372813" MODIFIED="1378510501048" STYLE="fork" TEXT="Enumerate Registry Entry">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378501426040" ID="ID_1545096900" MODIFIED="1378510501046" STYLE="fork" TEXT="Modify Registry Entry">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378501437101" ID="ID_1393560515" MODIFIED="1378510501045" STYLE="fork" TEXT="Delete Registry Value">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378501535149" FOLDED="true" ID="ID_1182416207" MODIFIED="1389278160761" STYLE="fork" TEXT="Perform File Operations">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378509194915" ID="ID_331860725" MODIFIED="1378510501020" STYLE="fork" TEXT="Copy File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378501046353" ID="ID_514834506" MODIFIED="1378510501043" STYLE="fork" TEXT="Create File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378509186134" ID="ID_1514438147" MODIFIED="1378510501042" STYLE="fork" TEXT="Delete File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378501069631" ID="ID_1611358918" MODIFIED="1378510501040" STYLE="fork" TEXT="Execute File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378509203351" ID="ID_620885479" MODIFIED="1378510501038" STYLE="fork" TEXT="Find File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378501058604" ID="ID_804756067" MODIFIED="1378510501035" STYLE="fork" TEXT="Get File Attributes">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378501095780" ID="ID_135091072" MODIFIED="1378510501032" STYLE="fork" TEXT="Modify File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378509254036" ID="ID_1833294486" MODIFIED="1378510501029" STYLE="fork" TEXT="Move File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378509269274" ID="ID_1182976799" MODIFIED="1378510501026" STYLE="fork" TEXT="Open File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378501010058" ID="ID_404282207" MODIFIED="1378510501023" STYLE="fork" TEXT="Rename File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378509475366" FOLDED="true" ID="ID_1651465169" MODIFIED="1389278160761" STYLE="fork" TEXT="Perform Directory Operations">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378501022599" ID="ID_122899981" MODIFIED="1378510510918" STYLE="fork" TEXT="Create Directory">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378509499650" ID="ID_646902305" MODIFIED="1378510510926" STYLE="fork" TEXT="Delete Directory">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369332475557" ID="ID_567833222" MODIFIED="1378510510925" STYLE="fork" TEXT="Get Directory Listing">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378509519277" FOLDED="true" ID="ID_1064201801" MODIFIED="1389278160760" STYLE="fork" TEXT="Perform Network Operations">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1372440378399" ID="ID_1981095072" MODIFIED="1378510510948" STYLE="fork" TEXT="Launch DOS Attack Command">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369344858855" ID="ID_1943102522" MODIFIED="1378527514635" STYLE="fork" TEXT="Send Email">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369332376665" ID="ID_290300320" MODIFIED="1378527517377" STYLE="fork" TEXT="Upload File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369332389607" ID="ID_1386238543" MODIFIED="1378527530194" STYLE="fork" TEXT="Download File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378509722244" FOLDED="true" ID="ID_720722396" MODIFIED="1389278160760" STYLE="fork" TEXT="Perform System Operations">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369332347699" ID="ID_355339720" MODIFIED="1378527535721" STYLE="fork" TEXT="Reboot PC">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369332353858" ID="ID_313711324" MODIFIED="1378527541218" STYLE="fork" TEXT="Shutdown PC">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378511519152" FOLDED="true" ID="ID_1354555879" MODIFIED="1389278160760" STYLE="fork" TEXT="Perform Service Operations">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378527493129" ID="ID_1226618773" MODIFIED="1378527705110" STYLE="fork" TEXT="Delete Service">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378527620260" ID="ID_818521227" MODIFIED="1378527705128" STYLE="fork" TEXT="Enumerate Services">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378527630418" ID="ID_366970517" MODIFIED="1378527705126" STYLE="fork" TEXT="Get Service Information">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378527637301" ID="ID_689302107" MODIFIED="1378527705124" STYLE="fork" TEXT="Modify Service">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378527647007" ID="ID_1141565899" MODIFIED="1378527705121" STYLE="fork" TEXT="Start Service">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378527667787" ID="ID_1447582909" MODIFIED="1378527705118" STYLE="fork" TEXT="Create Service">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378527687818" ID="ID_1137176695" MODIFIED="1378527705114" STYLE="fork" TEXT="Open Service">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1378527310337" FOLDED="true" ID="ID_389409799" MODIFIED="1389643310345" STYLE="fork" TEXT="Remote Attacks">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<node CREATED="1378526856663" ID="ID_1283084310" MODIFIED="1378527343791" TEXT="see Objective-Oriented Capabilities"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ccccff" CREATED="1381356187956" ID="ID_386249546" MODIFIED="1389369654504" STYLE="fork" TEXT="Privilege Escalation">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://blog.avecto.com/2011/05/windows-7-sees-increase-in-malware-infection-rate/
    </p>
  </body>
</html>
</richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1381768238118" ID="ID_1878530430" MODIFIED="1389369676383" STYLE="fork" TEXT="Escalate User Privilege">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<attribute NAME="Type" VALUE="horizontal privilege escalation, vertical privilege escalation"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381461971960" ID="ID_839649938" MODIFIED="1388420002822" STYLE="fork" TEXT="Trick User into Running with Elevated Privilege">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381462003098" ID="ID_912545714" MODIFIED="1388419996620" STYLE="fork" TEXT="Auto-Elevate User UAC">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381462032776" ID="ID_231335337" MODIFIED="1388419991192" STYLE="fork" TEXT="Exploit Vulnerability">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.zdnet.com/exploit-beamed-via-nfc-to-hack-samsung-galaxy-s3-android-4-0-4-7000004510/
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381768255251" ID="ID_1863325434" MODIFIED="1389368672621" STYLE="fork" TEXT="Elevate CPU Mode">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Unsure if this belong here, or is simply a child of escalate user privilege?
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381768523685" FOLDED="true" ID="ID_1927078355" MODIFIED="1389368554858" STYLE="fork" TEXT="Exploit Vulnerability">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381768533836" ID="ID_587068760" MODIFIED="1382637517753" STYLE="fork" TEXT="Overwrite Interrupt Descriptor Table">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      CIH/Chernobyl exploited privilege bug in Windows 9x OS to overwrite interrupt descriptor table with own payload from user mode, then trigger the overwritten interrupt handler and malware is executed in kernel mode.&#160; (http://www.webroot.com/blog/2011/09/13-mebromi-the-first-bios-rootkit-in-the-wild/)
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381768786632" ID="ID_1289116980" MODIFIED="1389368205369" STYLE="fork" TEXT="Load Own Kernel Mode Driver">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381768913483" ID="ID_1834602551" MODIFIED="1381769235572" STYLE="fork" TEXT="Load (own) Library">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      extract and load own library to load the driver.&#160;&#160;Mebromi:&#160; http://www.webroot.com/blog/2011/09/13/mebromi-the-first-bios-rootkit-in-the-wild
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381768959099" ID="ID_1671730702" MODIFIED="1381769235574" STYLE="fork" TEXT="Use beep.sys Service Key">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      stop the beep.sys service key, overwrite the beep.sys driver with owncode, restart the service key, and restore the original beep.sys code (Mebromi:&#160;&#160;http://www.webroot.com)
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1389369629196" ID="ID_1895022620" MODIFIED="1389369742290" TEXT="Impersonate User">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://blog.mindedsecurity.com/2009/01/shields-up-against-domain-escalation.html
    </p>
    <p>
      
    </p>
    <p>
      The act of impersonating another user who may have a higher set of privileges.
    </p>
  </body>
</html>
</richcontent>
<font NAME="SansSerif" SIZE="14"/>
</node>
</node>
<node BACKGROUND_COLOR="#ccccff" CREATED="1367952869425" ID="ID_1636351301" MODIFIED="1389278181426" TEXT="Data Exfiltration">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.darkreading.com/perimeter/tech-insight-cutting-edge-techniques-for/231500364
    </p>
  </body>
</html></richcontent>
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1389376755901" ID="ID_541358710" MODIFIED="1389377093525" TEXT="Stage Data for Exfiltration">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      See: https://media.blackhat.com/bh-dc-11/Coyne/BlackHat_DC_2011_Coyne_Gateway-Slides.pdf
    </p>
  </body>
</html>
</richcontent>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1389377088393" ID="ID_120105635" MODIFIED="1389377502519" TEXT="Move Data to Staging Server">
<font NAME="SansSerif" SIZE="14"/>
<attribute NAME="Protocol" VALUE="(name of transfer protocol)?"/>
<attribute NAME="Staging Location" VALUE=""/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1389376971857" ID="ID_1395030747" MODIFIED="1389377086711" TEXT="Package Data">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      See: https://media.blackhat.com/bh-dc-11/Coyne/BlackHat_DC_2011_Coyne_Gateway-Slides.pdf
    </p>
    <p>
      
    </p>
  </body>
</html>
</richcontent>
<font NAME="SansSerif" SIZE="14"/>
<attribute NAME="Archive Type" VALUE="(name of archive format)"/>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1378564250085" ID="ID_1085497146" MODIFIED="1389376559234" STYLE="fork" TEXT="Obfuscate Data for Exfiltration">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378564342419" FOLDED="true" ID="ID_1875685311" MODIFIED="1389278160756" STYLE="fork" TEXT="Encrypt Data">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<attribute NAME="Encryption Algorithm" VALUE="RC2, RC4, DES, Triple DES, AES"/>
<attribute NAME="File Type" VALUE="Zip, PDF"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378566884238" ID="ID_1205955650" MODIFIED="1384284100581" STYLE="fork" TEXT="Invoke Program for Encryption">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378579149611" FOLDED="true" ID="ID_270463137" MODIFIED="1389376517516" STYLE="fork" TEXT="Hide Data in Other Formats (steganography)">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378566884238" ID="ID_593761674" MODIFIED="1378579185329" STYLE="fork" TEXT="Embed Data in Image File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378579244291" ID="ID_1902570748" MODIFIED="1378579383573" STYLE="fork" TEXT="Embed Data in PDF File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378579266764" ID="ID_451317868" MODIFIED="1378579383575" STYLE="fork" TEXT="Embed Data in HTML File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378579276895" ID="ID_823262334" MODIFIED="1378579383574" STYLE="fork" TEXT="Embed Data in MP3 File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372429271838" ID="ID_115058106" MODIFIED="1389376780620" TEXT="Exfiltrate Stolen Data">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372429507704" FOLDED="true" ID="ID_1138621696" MODIFIED="1389366600716" STYLE="fork" TEXT="Exfiltrate via Network">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.csoonline.com/article/570813/data-exfiltration-how-data-gets-out
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1378534566089" FOLDED="true" ID="ID_1990588561" MODIFIED="1389366599632" STYLE="fork" TEXT="SMTP">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378565639070" ID="ID_851172300" MODIFIED="1378577785445" STYLE="fork" TEXT="Use Native Email Client">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378565605082" ID="ID_1831923722" MODIFIED="1378577789669" STYLE="fork" TEXT="Use Multifunction Printer to Email">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378575933818" ID="ID_1842992226" MODIFIED="1378577794135" STYLE="fork" TEXT="Use Malware SMTP Capability">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378577590236" ID="ID_99720186" MODIFIED="1378577632014" STYLE="fork" TEXT="Install Malicious SMTP Server">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      attackers often opted to install a malicious SMTP server directly on the compromised system to ensure the data is properly routed; http://www.csoonline.com/article/570813/data-exfiltration-how-data-gets-out?page=2
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1378564503498" FOLDED="true" ID="ID_1430553440" MODIFIED="1389278160758" STYLE="fork" TEXT="FTP">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<attribute_layout NAME_WIDTH="105" VALUE_WIDTH="105"/>
<attribute NAME="FTPServer has SSL" VALUE="yes, no"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378534253292" ID="ID_126047541" MODIFIED="1378577801013" STYLE="fork" TEXT="Use Anonymous FTP">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378534191539" ID="ID_554097077" MODIFIED="1378577804923" STYLE="fork" TEXT="Use Native FTP Client">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378575787790" ID="ID_239104001" MODIFIED="1378577814467" STYLE="fork" TEXT="Use Malware FTP Capability">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1378566240083" FOLDED="true" ID="ID_1869138746" MODIFIED="1389278160758" STYLE="fork" TEXT="HTTP">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<attribute NAME="HTTPServer has SSL" VALUE="yes, no"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378534156906" ID="ID_281849154" MODIFIED="1378577818548" STYLE="fork" TEXT="Use Native HTTP Client:  File Upload">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378564664556" ID="ID_438347900" MODIFIED="1378577834259" STYLE="fork" TEXT="Upload to Social Network Site">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<attribute NAME="Site" VALUE="WordPress, Blogger, Facebook, Wikipedia"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378534206937" ID="ID_663236017" MODIFIED="1378577839539" STYLE="fork" TEXT="Use PHP-based Web Shell">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378533930655" ID="ID_473473200" MODIFIED="1378577843797" STYLE="fork" TEXT="Use Exposed Private Web Application Interface">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1378576057774" FOLDED="true" ID="ID_1994734128" MODIFIED="1389278160758" STYLE="fork" TEXT="IRC">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378576084373" ID="ID_1069628195" MODIFIED="1378577847926" STYLE="fork" TEXT="Use Malware IRC Capability">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372429519376" FOLDED="true" ID="ID_1932574642" MODIFIED="1389366593377" STYLE="fork" TEXT="Exfiltrate via Physical Media">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372440518099" ID="ID_1202115379" MODIFIED="1378566115968" TEXT="Write Data to CDROM"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378564843235" ID="ID_1905236526" MODIFIED="1378566134657" STYLE="fork" TEXT="Write Data to USB Drive">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378566416789" FOLDED="true" ID="ID_87383542" MODIFIED="1389366591108" STYLE="fork" TEXT="Exfiltrate via Covert Channel">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378578804928" FOLDED="true" ID="ID_954075278" MODIFIED="1389278160757" STYLE="fork" TEXT="Hide in Network Packet">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378566871145" ID="ID_552545747" MODIFIED="1378578865299" STYLE="fork" TEXT="Chunk Data">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378577236016" ID="ID_973488738" MODIFIED="1378577273755" STYLE="fork" TEXT="Network Packet Insertion">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378564841747" FOLDED="true" ID="ID_919796588" MODIFIED="1389368425159" STYLE="fork" TEXT="Exfiltrate via Dumpster Dive">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      encode the data and send it to a network printer in the hopes that anyone who finds it will view it as gibberish and trash it. When the trash is taken outside, the attacker can dumpster-dive for the discarded paper, scan it in, and decode it.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378564929743" ID="ID_1967632997" MODIFIED="1378564978647" STYLE="fork" TEXT="Encode Data">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378564931367" ID="ID_1359206345" MODIFIED="1378564978650" STYLE="fork" TEXT="Print Data">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378565127163" FOLDED="true" ID="ID_1944393680" MODIFIED="1389375937957" STYLE="fork" TEXT="Exfiltrate via VoIP/Phone">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      leverage the VoIP or phone system for the data exfiltration. First, encode the data to audio. Then, make a call out to a voicemail system or conference calling service and play the audio through the phone to record it. When ready, call to retrieve the recording and decode it.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378565185576" ID="ID_291153424" MODIFIED="1378565238615" STYLE="fork" TEXT="Encode Data to Audio">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378565200580" ID="ID_650954011" MODIFIED="1378565238610" STYLE="fork" TEXT="Play Audio During Outgoing Call">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378565542263" FOLDED="true" ID="ID_1329088093" MODIFIED="1389375939797" STYLE="fork" TEXT="Exfiltrate via Fax">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378565816833" ID="ID_1422344735" MODIFIED="1378565851207" STYLE="fork" TEXT="Fax from Multifunction Printer">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1371228412905" ID="ID_1657808347" MODIFIED="1389278187975" TEXT="Objective-Oriented">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ccccff" CREATED="1368127637549" ID="ID_1095104190" MODIFIED="1389278188762" STYLE="fork" TEXT="Data Theft">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      DOS/Cheeba virus
    </p>
    <p>
      W32/Bo2k
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372360949826" ID="ID_26895563" MODIFIED="1389368360437" TEXT="Steal Authentication Credentials">
<font NAME="SansSerif" SIZE="14"/>
<attribute NAME="Targeted Application" VALUE="(name of application)"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1327093428152" FOLDED="true" ID="Freemind_Link_1807670552" MODIFIED="1389278160755" TEXT="Steal Cookie">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372438436509" FOLDED="true" ID="ID_916315679" MODIFIED="1389278160755" TEXT="Cookie Data Export">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1369330474847" ID="ID_991023340" MODIFIED="1381522962318" TEXT="Wininit.dll: InternetGetCookie()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.ioactive.com/pdfs/ZeusSpyEyeBankingTrojanAnalysis.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1327093585514" FOLDED="true" ID="Freemind_Link_1463589718" MODIFIED="1389278160755" TEXT="Steal PKI Software Certificate">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327271720977" FOLDED="true" ID="Freemind_Link_1013191072" MODIFIED="1389278160755" TEXT="Inline/IAT/EAT Hooking">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327271744121" ID="Freemind_Link_788942782" MODIFIED="1381522962319" TEXT="PFXImportCertStore()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.joesecurity.org/resources/spyeye.html
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1327093434984" ID="Freemind_Link_1453956397" MODIFIED="1382637651685" TEXT="Steal Password Hashes">
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372437677362" FOLDED="true" ID="ID_1974736051" MODIFIED="1389278160755" TEXT="Steal Web/Network Credential">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      log on data theft (username/password)
    </p>
  </body>
</html></richcontent>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327093288022" FOLDED="true" ID="Freemind_Link_1396583448" MODIFIED="1389278160755" TEXT="Theft via Network Sniffing">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326901211254" FOLDED="true" ID="Freemind_Link_1261486173" MODIFIED="1389278160755" TEXT="Kernel">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326901446488" ID="Freemind_Link_1067119420" MODIFIED="1381853787038" TEXT="nt*.exe:{Nt,Zw}DeviceIoControlFile()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      (can be used to intercept FTP send() - http://www.virusbtn.com/virusbulletin/archive/2011/01/vb201101-Carberp
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326901214238" FOLDED="true" ID="Freemind_Link_1713803586" MODIFIED="1389278160755" TEXT="Userspace">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326901277646" ID="Freemind_Link_1704103602" MODIFIED="1381853787039" TEXT="wininet.dll:HttpSendRequest{Ex}{A,W}()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.virusbtn.com/virusbulletin/archive/2011/01/vb201101-Carberp
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326901309511" ID="Freemind_Link_448517519" MODIFIED="1381853787039" TEXT="wininet.dll:InternetReadFile{Ex}{A,W}()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.virusbtn.com/virusbulletin/archive/2011/01/vb201101-Carberp
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326901335487" ID="Freemind_Link_1275727102" MODIFIED="1381853787039" TEXT="wininet.dll:InternetQueryDataAvailable()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.virusbtn.com/virusbulletin/archive/2011/01/vb201101-Carberp
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326901365591" ID="Freemind_Link_808354970" MODIFIED="1381853787039" TEXT="wininet.dll:InternetCloseHandle()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://www.virusbtn.com/virusbulletin/archive/2011/01/vb201101-Carberp
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327018714091" ID="Freemind_Link_902465352" MODIFIED="1381853787039" TEXT="wininet.dll:InternetWriteFile()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://pxnow.prevx.com/content/blog/carberp-a_modular_information_stealing_trojan.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327018732034" ID="Freemind_Link_157983544" MODIFIED="1381853787039" TEXT="user32.dll:TranslateMessage()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://pxnow.prevx.com/content/blog/carberp-a_modular_information_stealing_trojan.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327018632299" ID="Freemind_Link_31204573" MODIFIED="1381853787039" TEXT="kernel32.dll:CreateFile{A,W}">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW:http://pxnow.prevx.com/content/blog/carberp-a_modular_information_stealing_trojan.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326901446488" ID="Freemind_Link_875854984" MODIFIED="1381853787039" TEXT="ntdll.dll:{Nt,Zw}DeviceIoControlFile()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      (can be used to intercept FTP send() - http://www.virusbtn.com/virusbulletin/archive/2011/01/vb201101-Carberp
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327333492765" ID="Freemind_Link_1688701545" MODIFIED="1381853787039" TEXT="PR_OpenTCPSocket">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.norman.com/security_center/virus_description_archive/w32_spyeye
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327333499182" ID="Freemind_Link_229381643" MODIFIED="1381853787039" TEXT="PR_Read"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327333510901" ID="Freemind_Link_1365100059" MODIFIED="1381853787039" TEXT="PR_Write"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327410449591" ID="Freemind_Link_1194766026" MODIFIED="1381853787039" TEXT="mswsock.dll:WSPRecv()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://go.eset.com/us/resources/white-papers/TDL3-Analysis.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327410449591" ID="Freemind_Link_494339184" MODIFIED="1381853787039" TEXT="mswsock.dll:WSPSend();">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://go.eset.com/us/resources/white-papers/TDL3-Analysis.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381852968608" ID="ID_22930484" MODIFIED="1381853681853" STYLE="fork" TEXT="Theft via Install Browser Extension">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Browser extensions hijack account credentials.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372439150250" ID="ID_468317327" MODIFIED="1389278189438" TEXT="Steal Stored Information">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372364136262" ID="ID_546758126" MODIFIED="1381522962323" TEXT="Steal Serial Numbers">
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372364240884" ID="ID_1014689367" MODIFIED="1381522962323" TEXT="Steal Documents">
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381509664082" ID="ID_281791401" MODIFIED="1381509708178" STYLE="fork" TEXT="Steal Images">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Images can be stolen from smartphone.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378576487359" FOLDED="true" ID="ID_1350598973" MODIFIED="1389278160754" STYLE="fork" TEXT="Steal Database Content">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://en.wikipedia.org/wiki/SQL_injection
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378576576961" ID="ID_1780451483" MODIFIED="1378576663475" STYLE="fork" TEXT="Incorrectly Filted Escape Characters">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378576599319" ID="ID_1316748967" MODIFIED="1378576663484" STYLE="fork" TEXT="Incorrect Type Handling">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378576614994" ID="ID_1687725372" MODIFIED="1378576663480" STYLE="fork" TEXT="Blind SQL Injection">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1371834899769" ID="ID_159387437" MODIFIED="1384285288120" TEXT="Steal Cryptocurrency Data">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://labs.alienvault.com/labs/index.php/2013/how-cybercriminals-are-exploiting-bitcoin-and-other-virtual-currencies/
    </p>
  </body>
</html></richcontent>
<font NAME="SansSerif" SIZE="13"/>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372428600063" ID="ID_348351481" MODIFIED="1389278189448" TEXT="Steal User Data">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372364274544" ID="ID_587518080" MODIFIED="1381522962323" TEXT="Steal Contact List Data">
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372364004221" ID="ID_1205749181" MODIFIED="1381522962323" TEXT="Steal Email Data">
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381509720871" ID="ID_875720681" MODIFIED="1381509789089" STYLE="fork" TEXT="Steal SMS (Text) Database">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372363176903" FOLDED="true" ID="ID_501698646" MODIFIED="1389278160753" TEXT="Steal Referer URLs">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1327270807118" FOLDED="true" ID="Freemind_Link_1031279735" MODIFIED="1389278160753" TEXT="Network Sniffing">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327270801022" ID="Freemind_Link_1088219651" MODIFIED="1381522962323" TEXT="HttpQueryInfoA?"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372364245884" ID="ID_1777199756" MODIFIED="1381522962323" TEXT="Steal Browser History">
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381516406867" ID="ID_673085116" MODIFIED="1381516416241" STYLE="fork" TEXT="Steal Dialed Phone Numbers">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372361075544" ID="ID_1104454536" MODIFIED="1389278189452" TEXT="Steal System Information">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1327093462160" ID="Freemind_Link_898413903" MODIFIED="1382637705363" TEXT="Steal Network Address">
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1326893225178" ID="Freemind_Link_639358753" MODIFIED="1382637716230" TEXT="Steal Open Port">
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1327093451128" ID="Freemind_Link_1365932336" MODIFIED="1382637724215" TEXT="Steal Make/Model">
<font NAME="SansSerif" SIZE="13"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ccccff" CREATED="1367952929540" ID="ID_870653376" MODIFIED="1389278188772" TEXT="Spying">
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372360486811" ID="ID_593559326" MODIFIED="1389278189461" TEXT="Capture System Peripheral Data">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372424450001" FOLDED="true" ID="ID_1731505743" MODIFIED="1389278160752" TEXT="Capture Keyboard Input">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1304626296497" FOLDED="true" ID="Freemind_Link_1642367367" MODIFIED="1389278160752" TEXT="Key Logging">
<node BACKGROUND_COLOR="#cccc00" CREATED="1326894795280" FOLDED="true" ID="Freemind_Link_381803278" MODIFIED="1389278160752" TEXT="Userspace">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326893434005" ID="ID_553191153" MODIFIED="1372179093110" TEXT="Javascript"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326893437901" ID="Freemind_Link_697424700" MODIFIED="1372179093110" TEXT="Browser Helper Object (BHO)"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1304865372946" ID="Freemind_Link_1650566939" MODIFIED="1372179093110" TEXT="SetWindowsHookEx()"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327089563644" ID="Freemind_Link_1545206933" MODIFIED="1374001775796" TEXT="GetAsyncKeyState()">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://web.archive.org/web/20061017030029/http://www.rootkit.com/newsread.php?newsid=346
    </p>
    <p>
      (probably can find older and better references)
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1305670088260" ID="Freemind_Link_1355172097" MODIFIED="1372179093110" TEXT="Inline/IAT Hooking"/>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326894804216" FOLDED="true" ID="Freemind_Link_1371343653" MODIFIED="1389278160752" TEXT="Kernel">
<node BACKGROUND_COLOR="#cccc00" CREATED="1304865303065" FOLDED="true" ID="Freemind_Link_218577432" MODIFIED="1389278160752" TEXT="IDT Hooking">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326809337183" ID="Freemind_Link_1258752172" MODIFIED="1374003912485" TEXT="Normal">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://uninformed.org/?v=8&amp;a=2&amp;t=sumry
    </p>
    <p>
      Better citation is the former rootkit.com code
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326809342175" ID="Freemind_Link_1297827715" MODIFIED="1374003925883" TEXT="Segment-modifying">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      me, only current citation: http://www.mcafee.com/us/resources/reports/rp-predicting-stealth-attacks.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326809349575" FOLDED="true" ID="Freemind_Link_744208301" MODIFIED="1389278160751" TEXT="KINTERRUPT function pointer">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327071623996" ID="Freemind_Link_1705429389" MODIFIED="1374001787361" TEXT="KINTERRUPT.ServiceRoutine">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Possibility mentioned but dismissed as undesirable in http://www.phrack.org/issues.html?issue=65&amp;id=4
    </p>
    <p>
      PoC: http://web.archive.org/web/20061017021312/http://www.rootkit.com/newsread.php?newsid=561
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1327071631428" ID="Freemind_Link_100423174" MODIFIED="1372179068323" TEXT="KINTERRUPT.DispatchRoutine"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326809359592" ID="Freemind_Link_1350822241" MODIFIED="1374001795079" TEXT="KINTERRUPT.DispatchCode inline">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://www.phrack.org/issues.html?issue=65&amp;id=4
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326809791011" FOLDED="true" ID="Freemind_Link_1508681208" MODIFIED="1389278160751" TEXT="virtualized">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326809798059" ID="Freemind_Link_167740770" MODIFIED="1372179025593" TEXT="bluepill/intel manual"/>
</node>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1304628332913" ID="Freemind_Link_1866588335" MODIFIED="1374001884228" TEXT="KOH">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: http://www.cs.berkeley.edu/~dawnsong/papers/2010%20hookscout.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1304628314475" ID="Freemind_Link_392422871" MODIFIED="1374001892306" TEXT="I/O hardware breakpoint">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      PoC: chpie.tistory.com/attachment/ck13.txt
    </p>
    <p>
      PoC: http://chpie.tistory.com/attachment/ck14.zip
    </p>
    <p>
      PoC (from SMM): http://ivanlef0u.fr/repo/todo/chpie_smm_keysniff_ENG.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1305670088260" ID="Freemind_Link_938206331" MODIFIED="1372178237032" TEXT="Inline/IAT Hooking"/>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326894807352" FOLDED="true" ID="Freemind_Link_960774496" MODIFIED="1389278160751" TEXT="VMM">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1304865303065" FOLDED="true" ID="Freemind_Link_841476916" MODIFIED="1389278160751" TEXT="IDT Hooking">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326809337183" ID="Freemind_Link_1893834097" MODIFIED="1374001904580" TEXT="Normal">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://uninformed.org/?v=8&amp;a=2&amp;t=sumry
    </p>
    <p>
      Better citation is the former rootkit.com code
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326809342175" ID="Freemind_Link_1698340724" MODIFIED="1374002133254" TEXT="Segment-modifying">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      me, only current citation: http://www.mcafee.com/us/resources/reports/rp-predicting-stealth-attacks.pdf
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326809349575" ID="Freemind_Link_43645081" MODIFIED="1372178253334" TEXT="KINTERRUPT function pointer"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326809359592" ID="Freemind_Link_1286805002" MODIFIED="1374002143060" TEXT="KINTERRUPT inline">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      POC: http://www.phrack.org/issues.html?issue=65&amp;id=4
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1326809791011" FOLDED="true" ID="Freemind_Link_300583394" MODIFIED="1389278160751" TEXT="virtualized">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1326809798059" ID="Freemind_Link_1860669227" MODIFIED="1372178274291" TEXT="bluepill/intel manual"/>
</node>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372424462064" FOLDED="true" ID="ID_122985856" MODIFIED="1389278160751" TEXT="Capture Mouse Input">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1326893242002" ID="Freemind_Link_865358631" MODIFIED="1381811475846" TEXT="Local System Screen Capture">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.channelregister.co.uk/2006/03/16/mouse_click_capturing_trojan/
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1388154534345" FOLDED="true" ID="ID_348061001" MODIFIED="1389278160751" TEXT="Capture Touchscreen Input">
<font NAME="SansSerif" SIZE="12"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381516454066" ID="ID_1828681263" MODIFIED="1388154970186" STYLE="fork" TEXT="Capture Dialed Numbers">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Capture numbers as they are being dialed.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1368119217311" ID="ID_21504319" MODIFIED="1388413054912" TEXT="Capture Microphone">
<font NAME="SansSerif" SIZE="13"/>
<attribute NAME="Microphone Type" VALUE="Mobile Phone Microphone, Local System Microphone"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372425480525" ID="ID_881978264" MODIFIED="1388413074279" TEXT="Capture Camera">
<font NAME="SansSerif" SIZE="13"/>
<attribute NAME="Camera Type" VALUE="Mobile Phone Camera, Local System Camera"/>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372360505467" ID="ID_627553550" MODIFIED="1389278189464" TEXT="Capture System Interface Data">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372426049148" ID="ID_258001918" MODIFIED="1388413111103" TEXT="Capture System Network Traffic">
<font NAME="SansSerif" SIZE="13"/>
<attribute NAME="Interface Type" VALUE="WLAN, Ethernet"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381516323452" ID="ID_861389349" MODIFIED="1388155904672" STYLE="fork" TEXT="Capture GPS Data">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.h-online.com/security/news/item/Android-smartphones-infected-via-drive-by-exploit-Update-1446992.html
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372360505467" ID="ID_1478254336" MODIFIED="1389278189469" TEXT="Capture System State Data">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378527204228" FOLDED="true" ID="ID_972147783" MODIFIED="1389278160750" STYLE="fork" TEXT="Capture System Screenshot">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<arrowlink DESTINATION="ID_972147783" ENDARROW="Default" ENDINCLINATION="0;0;" ID="Arrow_ID_1395703957" STARTARROW="None" STARTINCLINATION="0;0;"/>
<linktarget COLOR="#b0b0b0" DESTINATION="ID_972147783" ENDARROW="Default" ENDINCLINATION="0;0;" ID="Arrow_ID_1395703957" SOURCE="ID_972147783" STARTARROW="None" STARTINCLINATION="0;0;"/>
<font NAME="SansSerif" SIZE="13"/>
<attribute NAME="Type" VALUE="Image, Video"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372426525443" ID="ID_1830450752" MODIFIED="1372426536862" TEXT="Local System Screen Capture"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381516323452" ID="ID_656341519" MODIFIED="1388171035397" STYLE="fork" TEXT="Capture System Memory Dump">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381516323452" ID="ID_1429346707" MODIFIED="1388414049211" STYLE="fork" TEXT="Capture File System Dump">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ccccff" CREATED="1371230364127" ID="ID_363237434" MODIFIED="1389278188780" TEXT="Destruction">
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372423799628" ID="ID_1717704146" MODIFIED="1389278189473" TEXT="Destroy Physical Entity">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372359408420" FOLDED="true" ID="ID_1249103838" MODIFIED="1389278160750" TEXT="Destroy Hardware">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371230722920" FOLDED="true" ID="ID_1905239057" MODIFIED="1389278160750" TEXT="Battery Destruction">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1372353273722" ID="ID_1371703385" MODIFIED="1374004845546" TEXT="Malicious Firmware Installation">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Notional: http://www.pcworld.com/article/236440/Apple_Laptop_Batteries_Found_Vulnerable_to_malware_destruction.html
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381766723689" FOLDED="true" ID="ID_832389976" MODIFIED="1389278160750" STYLE="fork" TEXT="Destroy Firmware">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381766734625" ID="ID_1768652375" MODIFIED="1381766765735" STYLE="fork" TEXT="Flash BIOS">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372423827929" ID="ID_1299953383" MODIFIED="1389278189476" TEXT="Destroy Virtual Entity">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1368120956815" FOLDED="true" ID="ID_707577049" MODIFIED="1389278160749" TEXT="Erase Data">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371231043515" ID="ID_368304114" MODIFIED="1372359187132" TEXT="Whole Disk Erasure"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371231954467" ID="ID_337490519" MODIFIED="1372359187132" TEXT="Targeted File Erasure"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ccccff" CREATED="1371230369689" ID="ID_189400299" MODIFIED="1389278188788" STYLE="fork" TEXT="Integrity Violation">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372423656364" ID="ID_392424037" MODIFIED="1389278189479" TEXT="Compromise System Operational Integrity ">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1368118982093" FOLDED="true" ID="ID_1796659043" MODIFIED="1389278160749" TEXT="Manipulate Industrial Control System (ICS)">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372355695220" ID="ID_1783432857" MODIFIED="1381523668179" TEXT="PLC Infection">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_stuxnet_dossier.pdf
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1374059756611" ID="ID_959219131" MODIFIED="1389278189481" TEXT="Compromise System Data Integrity ">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1371230654768" FOLDED="true" ID="ID_1463278569" MODIFIED="1389278160749" TEXT="Corrupt System Data">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371231035824" FOLDED="true" ID="ID_96907550" MODIFIED="1389278160749" TEXT="Whole Disk Corruption">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1381523172985" ID="ID_1663185402" MODIFIED="1381523363430" STYLE="fork" TEXT="Overwrite Sector">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Dark Avenger virus randomly overwrites part of a sector after each sixteenth file is infected.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371231431920" FOLDED="true" ID="ID_1623074443" MODIFIED="1389278160748" TEXT="Database Corruption">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1371231450761" ID="ID_300305467" MODIFIED="1381523668179" TEXT="Targeted Table Corruption">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.securelist.com/en/blog/208193954/
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371232495626" FOLDED="true" ID="ID_1313853580" MODIFIED="1389278160748" TEXT="System File Corruption">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1371232503092" ID="ID_396332685" MODIFIED="1381523668179" TEXT="System File Overwriting">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.symantec.com/security_response/writeup.jsp?docid=2012-081608-0202-99
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371231029970" FOLDED="true" ID="ID_1835487096" MODIFIED="1389278160748" TEXT="MBR Corruption">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1371231293495" ID="ID_985535802" MODIFIED="1381523668180" TEXT="MBR Overwriting">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://labs.alienvault.com/labs/index.php/2013/information-about-the-south-korean-banks-and-media-systems-attacks/
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381769825689" FOLDED="true" ID="ID_371040721" MODIFIED="1389278160748" STYLE="fork" TEXT="BIOS Corruption">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Mebromi (www.webroot.com/blog/2011/09/13/mebromi-the-first-bios-rootkit-in-the-wild
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1381769857985" ID="ID_1309467606" MODIFIED="1381769921466" STYLE="fork" TEXT="Map Physical Memory">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1381769868121" ID="ID_444419812" MODIFIED="1381769921484" STYLE="fork" TEXT="Verify BIOS Version">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1381769882100" ID="ID_183694061" MODIFIED="1381769921479" STYLE="fork" TEXT="Locate SMI Port">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1381769890855" ID="ID_570491298" MODIFIED="1381769921474" STYLE="fork" TEXT="Erase BIOS Flash">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1381769902662" ID="ID_1451436801" MODIFIED="1381769921470" STYLE="fork" TEXT="Write New BIOS ROM Code">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1378650303983" ID="ID_1143932347" MODIFIED="1389278189484" STYLE="fork" TEXT="Compromise User Data Integrity ">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378650318445" FOLDED="true" ID="ID_123263937" MODIFIED="1389278160748" STYLE="fork" TEXT="Corrupt User Data">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378650330474" ID="ID_297725484" MODIFIED="1381523809800" STYLE="fork" TEXT="Use Data Diddler">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      make small, random changes to data (e.g., spreadsheet) to make data inaccurate/worthless; The MAL: A Malware Analysis Lexicon, CMU.
    </p>
    <p>
      Wazzu randomly moves 0 to 3 words in infected documents each time they are opened.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372424104535" ID="ID_943510116" MODIFIED="1389278189488" TEXT="Annoy User">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372359613415" FOLDED="true" ID="ID_1885892606" MODIFIED="1389278160748" TEXT="Annoy Local System User">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1370873328115" ID="ID_549396750" MODIFIED="1382638439336" TEXT="Create Continuous Popups"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371669039700" ID="ID_109635485" MODIFIED="1382638445682" TEXT="Invert Screen"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378616383078" ID="ID_710753591" MODIFIED="1378616448112" STYLE="fork" TEXT="Render Advertisements">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381423983228" ID="ID_1389887220" MODIFIED="1381463103113" STYLE="fork" TEXT="Replace Icons">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      typically done to smartphones to annoy user
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381515623804" FOLDED="true" ID="ID_1091060034" MODIFIED="1389278160747" STYLE="fork" TEXT="Restart System">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381515631865" FOLDED="true" ID="ID_854059443" MODIFIED="1389278160747" STYLE="fork" TEXT="Send Malformed SMS Message">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.theregister.co.uk/2009/10/12/google_android_security_update
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1381515685563" ID="ID_1510445219" MODIFIED="1381515711312" STYLE="fork" TEXT="Send Badly Formed WAP Push Message">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381765496200" FOLDED="true" ID="ID_1923121354" MODIFIED="1389278160747" STYLE="fork" TEXT="Browser Hijack">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381766013770" ID="ID_1847911715" MODIFIED="1381766064651" STYLE="fork" TEXT="Modify Browser Settings">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372359763030" FOLDED="true" ID="ID_1714907572" MODIFIED="1389278160747" TEXT="Annoy Remote User">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369344904699" ID="ID_1388050718" MODIFIED="1372170089166" TEXT="Send Spam Email"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ccccff" CREATED="1371230369689" ID="ID_1993234354" MODIFIED="1389278188794" STYLE="fork" TEXT="Availability Violation">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372422932192" ID="ID_1113633835" MODIFIED="1389278189493" TEXT="Consume System Resources">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1371834459483" FOLDED="true" ID="ID_1543320611" MODIFIED="1389725861846" TEXT="Mine for CryptoCurrency">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Hlux/Kelihos contains a Bitcoin miner feature (creates Bitcoin).
    </p>
  </body>
</html></richcontent>
<font NAME="SansSerif" SIZE="13"/>
<attribute NAME="CryptoCurrency Type" VALUE="BitCoin, LiteCoin"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372355325612" FOLDED="true" ID="ID_823096324" MODIFIED="1389725702220" TEXT="CPU Consumption">
<node CREATED="1371834764657" ID="ID_1561606613" MODIFIED="1381523924478" TEXT="ITW: http://labs.alienvault.com/labs/index.php/2013/how-cybercriminals-are-exploiting-bitcoin-and-other-virtual-currencies/"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372355330830" ID="ID_60861163" MODIFIED="1381523924480" TEXT="GPU Consumption"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1371834454633" FOLDED="true" ID="ID_1147433509" MODIFIED="1389725696295" TEXT="Crack Passwords">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372355325612" ID="ID_730634898" MODIFIED="1381523924481" TEXT="CPU Consumption"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372355330830" ID="ID_967232471" MODIFIED="1381523924481" TEXT="GPU Consumption"/>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1372423436387" ID="ID_625069105" MODIFIED="1389278189497" TEXT="Compromise System Availability ">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372353033640" FOLDED="true" ID="ID_284365663" MODIFIED="1389278160746" TEXT="Compromise Network Server Availability (DOS)">
<font NAME="SansSerif" SIZE="13"/>
<attribute_layout NAME_WIDTH="70" VALUE_WIDTH="90"/>
<attribute NAME="Server Type" VALUE="Web, DNS, BGP"/>
<attribute NAME="Distributed" VALUE="Yes/No"/>
<node BACKGROUND_COLOR="#cccc00" CREATED="1372351992610" FOLDED="true" ID="ID_862467988" MODIFIED="1389278160746" TEXT="HTTP">
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369334827160" FOLDED="true" ID="ID_444277274" MODIFIED="1389278160746" TEXT="HTTP GET Request Flood">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1372351792894" FOLDED="true" ID="ID_1135145670" MODIFIED="1389278160746" TEXT="&quot;Apache-Killer/ARME&quot;">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.slideshare.net/arborjjones/aserts-ddos-malware-corral-volume-1-by-dennis-schwarz-and-jason-jones
    </p>
  </body>
</html></richcontent>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1381762214674" ID="ID_844477956" MODIFIED="1381762243394" STYLE="fork" TEXT="Send &quot;Range&quot; HTTP Header">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1372351978550" ID="ID_759529627" MODIFIED="1381523924481" TEXT="Slowloris">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.slideshare.net/arborjjones/aserts-ddos-malware-corral-volume-1-by-dennis-schwarz-and-jason-jones
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372352007804" ID="ID_1310823896" MODIFIED="1381523924481" TEXT="HTTP POST Request Flood">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ITW: http://www.slideshare.net/arborjjones/aserts-ddos-malware-corral-volume-1-by-dennis-schwarz-and-jason-jones
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1369334763031" FOLDED="true" ID="ID_1852366316" MODIFIED="1389278160745" TEXT="ICMP">
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369335057161" ID="ID_1894651760" MODIFIED="1381523924482" TEXT="Echo Reflector Flood"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369335077842" ID="ID_111843181" MODIFIED="1381523924482" TEXT="Ping Flood"/>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1369334810169" FOLDED="true" ID="ID_168529810" MODIFIED="1389278160745" TEXT="TCP">
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369335117101" ID="ID_1332728982" MODIFIED="1381523924482" TEXT="SYN Flood"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369335123293" ID="ID_288950690" MODIFIED="1381523924482" TEXT="Packet Flood"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372351534205" ID="ID_737850334" MODIFIED="1381523924482" TEXT="SYN/ACK Flood"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372351546035" ID="ID_1213707261" MODIFIED="1381523924482" TEXT="Connection Flood"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369334822072" ID="ID_1854803872" MODIFIED="1381523924482" TEXT="UDP Flood"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369334839831" ID="ID_1625273675" MODIFIED="1381523924482" TEXT="DNS Request Flood"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1369334846116" ID="ID_486807575" MODIFIED="1381523924482" TEXT="Binary Packet Flood"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372355240755" FOLDED="true" ID="ID_947193984" MODIFIED="1389278160745" TEXT="Compromise Local System Availability">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371834411701" FOLDED="true" ID="ID_1565746820" MODIFIED="1389278160745" TEXT="CPU Consumption">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378649939387" ID="ID_1343583741" MODIFIED="1378649996655" STYLE="fork" TEXT="fork bomb">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      process repeatedly makes copies of itself using fork() system call.&#160;&#160;The MAL: A Malware Analysis Lexicon, CMU.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371834428056" FOLDED="true" ID="ID_1565413281" MODIFIED="1389278160745" TEXT="Memory (RAM) Consumption">
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378649704156" ID="ID_226560865" MODIFIED="1378649814730" STYLE="fork" TEXT="zip bomb">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      compressed file that expands to an enormous size, looping over extraction code until system resources are exhausted. &quot;The MAL: A Malware Analysis Lexicon&quot;, CMU.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1371834433994" ID="ID_614407889" MODIFIED="1381523924483" TEXT="Hard Disk Space Consumption"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372355342567" ID="ID_1770374856" MODIFIED="1381523924483" TEXT="GPU Consumption"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1368120962583" ID="ID_1027385680" MODIFIED="1381523924483" TEXT="Disk Encryption"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378618261800" FOLDED="true" ID="ID_355862" MODIFIED="1389278160745" STYLE="fork" TEXT="Blue Screen of Death (BSOD)/Crash System">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378649855937" ID="ID_551568888" MODIFIED="1378649913205" STYLE="fork" TEXT="bit flipping">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      invert a single bit in hopes of causing crash; The MAL: A Malware Analysis Lexicon, CMU.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381348884687" ID="ID_1150468369" MODIFIED="1381348963346" STYLE="fork" TEXT="Send Malformed SMS Message">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      in Android 1.5, a malformed SMS message can cause the crash of the system.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381431140380" FOLDED="true" ID="ID_1469403599" MODIFIED="1389278160744" STYLE="fork" TEXT="Lockout Message Delivery">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <div style="width: 1px; height: 1px">
      <div style="text-decoration: none; background-color: rgb(255, 255, 255); text-align: left; color: rgb(0, 0, 0)">
        <p>
          http://www.itworldcanada.com/article/logic-flaw-allows-sms-exploit/45605
        </p>
        <p>
          A SIM Toolkit service message is malformed and requests the phone to reply via SMS to the operator's message center (SMS-DELIVER-REPORT) where it is interpreted as a message delivery failure.&#160;&#160;If a message can't be delivered, it is placed in a queue and a loop is created between message center and the phone, preventing reception of legitimate messages.
        </p>
      </div>
    </div>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381432108910" FOLDED="true" ID="ID_1252253624" MODIFIED="1389278160744" STYLE="fork" TEXT="Send Malformed SIM Toolkit Service Message">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1381431049423" ID="ID_717569934" MODIFIED="1381432127612" STYLE="fork" TEXT="SMS-DELIVER-REPORT">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381508574419" ID="ID_1564889518" MODIFIED="1381508951273" STYLE="fork" TEXT="Bricked Phone">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.phonetipsandtricks.com/unlock-your-phone-guide/
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1378650577092" ID="ID_1011578361" MODIFIED="1389278189500" STYLE="fork" TEXT="Compromise Data Availability ">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378650624310" FOLDED="true" ID="ID_231309787" MODIFIED="1389278160744" STYLE="fork" TEXT="Compromise Access to Information Assets">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      encrypt data on a compromised system for blackmail purposes - can only be decrypted by malware owner.&#160;&#160;The MAL: A Malware Analysis Lexicon, CMU
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372355330830" ID="ID_1102786010" MODIFIED="1384269833110" TEXT="Encrypt Information Assets"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ccccff" CREATED="1381422331145" ID="ID_776127845" MODIFIED="1389278188798" STYLE="fork" TEXT="Fraud">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1381423068287" ID="ID_541018048" MODIFIED="1389278189502" STYLE="fork" TEXT="Premium Rate Fraud">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Mobile phones are made to send text messages or dial phone numbers that are charged at premium rates.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1372359763030" FOLDED="true" ID="ID_1593799490" MODIFIED="1389278160744" TEXT="Access Premium Service">
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381423148526" FOLDED="true" ID="ID_1912113472" MODIFIED="1389278160744" STYLE="fork" TEXT="Cause Target to Send Text Message">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1381423572710" ID="ID_1151119089" MODIFIED="1381423701895" STYLE="fork" TEXT="SEND_SMS">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Short Message Service (SMS).
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1381431424179" FOLDED="true" ID="ID_65535863" MODIFIED="1389278160744" STYLE="fork" TEXT="Send Malformed SIM Toolkit Servoce Message">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.itworldcanada.com/article/logic-flaw-allows-sms-exploit/45605
    </p>
    <p>
      A SIM Toolkit service message is malformed and requests the phone to reply via SMS to the sender's number (SMS-SUBMIT).&#160;&#160;SMS spoofing is used to have the message sent to a premium-rate number.&#160;&#160;See also &quot;Availability Violation&quot; version where request is to reply to the operator's message center.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1381431637084" ID="ID_376950056" MODIFIED="1381431652039" STYLE="fork" TEXT="SMS-SUBMIT">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381423640545" FOLDED="true" ID="ID_20998725" MODIFIED="1389278160743" STYLE="fork" TEXT="Cause Target to Dial Phone Number">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1381446826966" ID="ID_1219039230" MODIFIED="1381449439822" STYLE="fork" TEXT="Send NFC request">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.extremetech.com/computing/133501-black-hat-hacker-lays-waste-to-android-and-meego-using-nfc-exploits
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1381811517256" ID="ID_1665012509" MODIFIED="1381811574613" STYLE="fork" TEXT="Click Fraud">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Malware-infected machine simulates clicks on website advertisements.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ccccff" CREATED="1372599997408" ID="ID_1309574589" MODIFIED="1389728593360" POSITION="right" STYLE="fork" TEXT="Infection">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &quot;Infection&quot; as defined here encompasses infection that malware does to infect a machine or infect a file after executing on a system.&#160;&#160;This capability includes malware that infects actively (gaining access to a machine directly) or passively (e.g., sending malicious email).&#160;&#160;
    </p>
    <p>
      This assumes that the initial infection is done outside of the malware itself.&#160;&#160;See &quot;Initial Infection&quot; node under &quot;Additional MAEC Package Content (Non-Bundle)&quot; for details.
    </p>
  </body>
</html>
</richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font BOLD="true" NAME="SansSerif" SIZE="16"/>
<attribute_layout NAME_WIDTH="60" VALUE_WIDTH="214"/>
<attribute NAME="Scope" VALUE="Local, Remote (propagation)"/>
<node BACKGROUND_COLOR="#ff9900" CREATED="1389716514479" ID="ID_847528486" MODIFIED="1389726850581" TEXT="Post-Infection">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1389725609928" ID="ID_1221521265" MODIFIED="1389731124491" TEXT="Install Secondary Components">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373045725010" FOLDED="true" ID="ID_1252586898" MODIFIED="1389730924976" STYLE="fork" TEXT="Download File">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font size="2">Malware connects to a remote host to retrieve additional files for further infection and drops/executes them on the local machine.</font>
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<attribute NAME="file type" VALUE="office doc, shockwave flash file, image file"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373347669008" ID="ID_1644397959" MODIFIED="1381338372508" STYLE="fork" TEXT="Initiate Network Connection to Download Location">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372775778749" ID="ID_1394442026" MODIFIED="1381338375994" STYLE="fork" TEXT="Download File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381259744951" ID="ID_822911088" MODIFIED="1381338770106" STYLE="fork" TEXT="Execute File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373045725010" ID="ID_1271847457" MODIFIED="1389730932477" STYLE="fork" TEXT="Drop File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<attribute NAME="file type" VALUE="office doc, shockwave flash file, image file"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1389726058982" ID="ID_330853075" MODIFIED="1389727851033" TEXT="Remove Self">
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1389716541639" ID="ID_1594405871" MODIFIED="1389716864478" TEXT="Delete File"/>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1381333233841" ID="ID_1077560158" MODIFIED="1389728519780" STYLE="fork" TEXT="Infect Remote Machine">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Includes self-propagation as well as malware infecting a machine with other malware or malicious code.
    </p>
  </body>
</html>
</richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<attribute NAME="Targeting" VALUE="Targeted, Semi-Targeted, Untargeted"/>
<attribute NAME="Autonomy" VALUE="Semi-Autonomous, Autonomous"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373484696181" ID="ID_686099018" MODIFIED="1389646278772" STYLE="fork" TEXT="Identify Target">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      includes machines to be targeted both by email and across the network.
    </p>
  </body>
</html>
</richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373484795939" ID="ID_1663169928" MODIFIED="1373552709044" STYLE="fork" TEXT="Search for File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373477588532" ID="ID_251165532" MODIFIED="1373479448442" STYLE="fork" TEXT="Scan for Network Shares">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373478077100" ID="ID_1966224554" MODIFIED="1373479448442" STYLE="fork" TEXT="Search for Email Addresses">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373481751154" ID="ID_971828574" MODIFIED="1373481761636" STYLE="fork" TEXT="DNS Queries">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373479417913" ID="ID_591261070" MODIFIED="1373479448442" STYLE="fork" TEXT="Scan for Bluetooth Devices">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373478245674" ID="ID_1898383434" MODIFIED="1373479448458" STYLE="fork" TEXT="Scan for Removable Devices">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373121684458" ID="ID_1290136860" MODIFIED="1389731018236" STYLE="fork" TEXT="User-involved Remote Infection">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373345642100" FOLDED="true" ID="ID_505217525" MODIFIED="1389730251759" STYLE="fork" TEXT="Send Malicious Email">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      send malware in an email.
    </p>
  </body>
</html>
</richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372776314530" ID="ID_990660616" MODIFIED="1372776367419" STYLE="fork" TEXT="Create Email">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372775966167" ID="ID_845592838" MODIFIED="1373211170547" STYLE="fork" TEXT="Embed Manipulated Link">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373346647735" ID="ID_1684145188" MODIFIED="1373346662794" STYLE="fork" TEXT="Attach File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381810574548" ID="ID_809575748" MODIFIED="1381810588899" STYLE="fork" TEXT="Send Email">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381810517468" FOLDED="true" ID="ID_1022628665" MODIFIED="1389730251759" STYLE="fork" TEXT="Send Malicious Social Network Message">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Koobface; directs to third party, malicious web site.
    </p>
  </body>
</html>
</richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381810538221" ID="ID_1610004658" MODIFIED="1381810588892" STYLE="fork" TEXT="Create Message">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381810553144" ID="ID_899332060" MODIFIED="1381810985368" STYLE="fork" TEXT="Send/Post Message">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381524181212" ID="ID_33635342" MODIFIED="1389730251759" STYLE="fork" TEXT="Send Malicious SMS Message">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381524198673" ID="ID_459637215" MODIFIED="1381524226060" STYLE="fork" TEXT="Create Text">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381524205378" ID="ID_862000060" MODIFIED="1381524226063" STYLE="fork" TEXT="Send Text">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373121684458" ID="ID_1540369343" MODIFIED="1389730333774" STYLE="fork" TEXT="Autonomous Remote Infection">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381258430227" ID="ID_598935382" MODIFIED="1389730366869" STYLE="fork" TEXT="File Upload">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Upload files to location where they will be downloaded or executed later.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1372740362150" FOLDED="true" ID="ID_1121986341" MODIFIED="1389712965880" STYLE="fork" TEXT="Run via Autorun: USB">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Store on a USB device where they will be autorun
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1373347669008" ID="ID_124944003" MODIFIED="1381258484979" STYLE="fork" TEXT="Initiate Network Connection to Upload Location">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1372775778749" ID="ID_1969463581" MODIFIED="1373345912817" STYLE="fork" TEXT="Upload File to Removable Media">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373414681720" FOLDED="true" ID="ID_1409088248" MODIFIED="1389712961571" STYLE="fork" TEXT="Run Via Autorun: Network">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1373347669008" ID="ID_1990718806" MODIFIED="1381258496961" STYLE="fork" TEXT="Initiate Network Connection to Upload Location">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1372887299727" ID="ID_43866392" MODIFIED="1373414808901" STYLE="fork" TEXT="Upload File to (Mapped) Drive">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373032694020" FOLDED="true" ID="ID_1475509113" MODIFIED="1389643276391" STYLE="fork" TEXT="Run as Remote Service">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1373347669008" ID="ID_1184109609" MODIFIED="1381258506506" STYLE="fork" TEXT="Initiate Network Connection to Upload Location">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1372887299727" ID="ID_1124431122" MODIFIED="1373413557164" STYLE="fork" TEXT="Upload File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373032731320" FOLDED="true" ID="ID_1256621979" MODIFIED="1389643280633" STYLE="fork" TEXT="Run via psexec.exe">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1373347669008" ID="ID_575074278" MODIFIED="1381259577759" STYLE="fork" TEXT="Initiate Network Connection to Upload Location">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1372887299727" ID="ID_1959277105" MODIFIED="1373413562645" STYLE="fork" TEXT="Upload File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ff9900" CREATED="1373213628687" ID="ID_1680373043" MODIFIED="1389728366624" STYLE="fork" TEXT="Infect File">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font size="2">BulgrinE - CD411 Paper-1.doc, Viruses, Worms, and Distributed Denial of Service (DDoS) Attacks </font>
    </p>
    <p>
      
    </p>
    <p>
      <font size="2">Some methods of infection are used for anti-detection purposes, but the Actions/Behaviors would be seen as an Infection capability, not as an active anti-detection action.&#160;&#160;Unless it is real-time self-modification.</font>
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<attribute NAME="targeted file type" VALUE="exe, document, etc."/>
<attribute NAME="platform" VALUE="32-bit, 64-bit, 32&amp;64-bit"/>
<attribute NAME="infection type" VALUE="appending, prepending, overwriting, companion, variable key, polymorphic, metamorphic"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381327356172" ID="ID_1814696766" MODIFIED="1382630193385" STYLE="fork" TEXT="Identify File">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="14"/>
<attribute NAME="location" VALUE="local, removeable, network"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373516923348" ID="ID_1705156467" MODIFIED="1389640472223" STYLE="fork" TEXT="Inject Code">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373516980475" ID="ID_649297338" MODIFIED="1389640455962" STYLE="fork" TEXT="Inject Code">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1378649567417" ID="ID_703785669" MODIFIED="1378649671019" STYLE="fork" TEXT="NOP Slide">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      insert NOP instructions to account for approximate jump addresses.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1373516955608" ID="ID_427621695" MODIFIED="1373517062178" STYLE="fork" TEXT="Modify Entry Point">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#000000" COLOR="#ffffff" CREATED="1378650918569" ID="ID_1685953984" MODIFIED="1389278145756" POSITION="right" STYLE="fork" TEXT="ADDITIONAL MAEC PACKAGE CONTENT (NON-BUNDLE)">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Assuming that &quot;Mechanisms&quot; pertain to a specific malware instance (i.e., a piece of binary code), data such as initial infection information and file infection method would be captured as meta data in a Package.
    </p>
    <p>
      Android:&#160; http://qz.com/131436/contrary-to-what-youve-heard-android-is-almost-impenetrable-to-malware/
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node CREATED="1378651333957" ID="ID_313075147" MODIFIED="1389640327966" TEXT="FIeld Data">
<node COLOR="#000000" CREATED="1367952710657" ID="ID_1376426847" MODIFIED="1389711310496" TEXT="INITIAL Infection">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Captures activity NOT done by the malware instance being analyzed.&#160;&#160;Capture details of what an other malware or an active attack does (or can reference a malware instance that is described by MAEC).
    </p>
  </body>
</html></richcontent>
<edge STYLE="bezier"/>
<attribute NAME="Targeting" VALUE="un,semi,targeted"/>
<attribute NAME="Autonomy" VALUE="Semi-Autonomous, Autonomous"/>
<attribute NAME="Access" VALUE="physical,remote,indirect"/>
<attribute NAME="Vector" VALUE="network,physical media"/>
<attribute NAME="IDRef" VALUE="Bundle (points to other malware that caused infection)"/>
<node CREATED="1373068049986" FOLDED="true" ID="ID_1231685832" MODIFIED="1389278160738" TEXT="Active Attacker Host Compromise">
<node BACKGROUND_COLOR="#ffffff" CREATED="1368043570333" FOLDED="true" ID="ID_1931182445" MODIFIED="1389278160738" STYLE="fork" TEXT="Vulnerability Exploitation">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Exploit vulnerable application and OSes.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ffffff" CREATED="1378497428904" ID="ID_1427032978" MODIFIED="1378500373711" STYLE="fork" TEXT="Buffer Overflow">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffffff" CREATED="1378497437703" ID="ID_1892602792" MODIFIED="1378500373711" STYLE="fork" TEXT="Injection Attack">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node CREATED="1368642378005" FOLDED="true" ID="ID_852032297" MODIFIED="1389278160738" STYLE="fork" TEXT="Configuration Exploitation">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node BACKGROUND_COLOR="#ffffff" CREATED="1372887663706" ID="ID_1571008409" MODIFIED="1378500657784" STYLE="fork" TEXT="Password Brute Force">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffffff" CREATED="1373044233622" ID="ID_1412611639" MODIFIED="1378500657783" STYLE="fork" TEXT="Feature Abuse">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffffff" CREATED="1373045278176" ID="ID_550840743" MODIFIED="1378500657782" STYLE="fork" TEXT="Default Passwords">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffffff" CREATED="1372887650971" ID="ID_361059046" MODIFIED="1378500657782" STYLE="fork" TEXT="Exploit ACL Issues">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
<node BACKGROUND_COLOR="#ffffff" CREATED="1378499417712" ID="ID_1001408127" MODIFIED="1381510195102" STYLE="fork" TEXT="Stolen Credentials">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      configuration allows credentials to be stolen (i.e., single factor authentication)
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
</node>
<node CREATED="1381448857387" FOLDED="true" ID="ID_278015656" MODIFIED="1389278160738" TEXT="NFC Access">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.zdnet.com/exploit-beamed-via-nfc-to-hack-samsung-galaxy-s3-android-4-0-4-7000004510/
    </p>
    <p>
      Exploits can be beamed via NFC to smartphones.
    </p>
  </body>
</html></richcontent>
<node CREATED="1381449179376" ID="ID_1382448365" MODIFIED="1381501685653" TEXT="Deliver Malicious File">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Exploit document viewer:&#160;&#160;some Android document viewers automatically open files (Galaxy S3).&#160; http://www.zdnet.com/exploit-beamed-via-nfc-to-hack-samsung-galaxy-s3-android-4-0-4-7000004510/
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1381448915458" ID="ID_807129821" MODIFIED="1381510148402" TEXT="RFID Attack">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.extremetech.com/computing/133501-black-hat-hacker-lays-waste-to-android-and-meego-using-nfc-exploits
    </p>
    <p>
      An RFID tag affixed to the bottom of a wireless POS &#8212; and voila, your phone can be hacked.
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1373045210329" FOLDED="true" ID="ID_562595096" MODIFIED="1389278160737" TEXT="Drive-by Download">
<node CREATED="1372600936844" FOLDED="true" ID="ID_391868245" MODIFIED="1389278160737" STYLE="fork" TEXT="Trojanized Link">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<linktarget COLOR="#b0b0b0" DESTINATION="ID_391868245" ENDARROW="Default" ENDINCLINATION="368;0;" ID="Arrow_ID_399666899" SOURCE="ID_714045707" STARTARROW="None" STARTINCLINATION="368;0;"/>
<attribute NAME="link_type" VALUE="email, website"/>
<node CREATED="1372600958990" ID="ID_986306971" MODIFIED="1373212043990" STYLE="fork" TEXT="JavaScript Exploit">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node CREATED="1373207281964" ID="ID_1958066725" MODIFIED="1373207966264" TEXT="Flash Exploit"/>
<node CREATED="1373212887367" ID="ID_684872864" MODIFIED="1373212904263" TEXT="ActiveX Control Exploit"/>
<node CREATED="1373563762055" FOLDED="true" ID="ID_1349388255" MODIFIED="1389278160737" TEXT="Document Infection">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1349388255" ENDARROW="Default" ENDINCLINATION="249;0;" ID="Arrow_ID_425014975" SOURCE="ID_271100803" STARTARROW="None" STARTINCLINATION="249;0;"/>
<node CREATED="1372740353446" FOLDED="true" ID="ID_950987098" MODIFIED="1389278160737" STYLE="fork" TEXT="Malicious Office Doc">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node CREATED="1373038893504" ID="ID_884419725" MODIFIED="1373346514792" STYLE="fork" TEXT="VBA Macro">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node CREATED="1373209173670" ID="ID_1253773867" MODIFIED="1373346514802" STYLE="fork" TEXT="Shellcode to Exploit MS Office Application">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node CREATED="1373208866116" ID="ID_1590077175" MODIFIED="1373346514802" STYLE="fork" TEXT="Embedded Flash Program">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node CREATED="1373039477829" ID="ID_1197808698" MODIFIED="1373346514802" STYLE="fork" TEXT="Embedded JavaScript">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node CREATED="1373208645141" ID="ID_141410323" MODIFIED="1373346514792" STYLE="fork" TEXT="VBScript">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node CREATED="1373038930211" ID="ID_1852050004" MODIFIED="1373346514802" STYLE="fork" TEXT="Executable PDF ">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node CREATED="1372601043810" ID="ID_477361713" MODIFIED="1373345055296" STYLE="fork" TEXT="Trojanized Software Download">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node CREATED="1373038527559" ID="ID_1212652233" MODIFIED="1373345055296" STYLE="fork" TEXT="Watering Hole">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node CREATED="1373212735973" ID="ID_836712640" MODIFIED="1373345055296" STYLE="fork" TEXT="Fake Website">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node CREATED="1372603772983" ID="ID_389103900" MODIFIED="1373345055296" STYLE="fork" TEXT="Malvertising">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node CREATED="1373068528504" ID="ID_1986576767" MODIFIED="1373345055296" STYLE="fork" TEXT="Exploit Kit Landing Page">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node CREATED="1372600973605" ID="ID_752906784" MODIFIED="1373345055296" STYLE="fork" TEXT="iFrames">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node CREATED="1368125153106" ID="ID_1284915281" MODIFIED="1381524636723" TEXT="Local File Drop/Download">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      File is dropped/downloaded by another piece of malware.
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1373121253004" FOLDED="true" ID="ID_920314578" MODIFIED="1389278160736" TEXT="Social Engineering">
<node CREATED="1372691081412" FOLDED="true" ID="ID_582956853" MODIFIED="1389278160736" STYLE="fork" TEXT="Phishing">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node CREATED="1373210260190" ID="ID_613900871" MODIFIED="1373346462306" STYLE="fork" TEXT="Phishing">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node CREATED="1373038493348" ID="ID_98244919" MODIFIED="1373346462306" STYLE="fork" TEXT="Spear Phishing">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node CREATED="1373210271316" ID="ID_476641161" MODIFIED="1373346462306" STYLE="fork" TEXT="Clone Phishing">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node CREATED="1373210280005" ID="ID_199528625" MODIFIED="1373346462306" STYLE="fork" TEXT="Whaling">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node CREATED="1372775993255" FOLDED="true" ID="ID_1754343968" MODIFIED="1389278160736" STYLE="fork" TEXT="Malicious Email Attachment">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<node CREATED="1373563762055" ID="ID_271100803" MODIFIED="1381524494914" TEXT="Document Infection">
<arrowlink DESTINATION="ID_1349388255" ENDARROW="Default" ENDINCLINATION="249;0;" ID="Arrow_ID_425014975" STARTARROW="None" STARTINCLINATION="249;0;"/>
</node>
</node>
<node CREATED="1381511303297" ID="ID_714045707" MODIFIED="1381524524413" TEXT="Malicious Shared Social Media Link">
<arrowlink DESTINATION="ID_391868245" ENDARROW="Default" ENDINCLINATION="368;0;" ID="Arrow_ID_399666899" STARTARROW="None" STARTINCLINATION="368;0;"/>
</node>
</node>
<node CREATED="1378533827227" FOLDED="true" ID="ID_164410020" MODIFIED="1389278160736" TEXT="Physical Access">
<node CREATED="1370872537589" ID="ID_630997586" MODIFIED="1381348244423" TEXT="&quot;Evil Maid&quot; AKA &quot;Janitor&quot; Attack"/>
<node CREATED="1381347805710" FOLDED="true" ID="ID_1522852212" MODIFIED="1389278160736" TEXT="USB Cable Connection">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      phones can be compromised like this.&#160;&#160;Syncing devices via cable can allow one to infect another.
    </p>
  </body>
</html></richcontent>
<node CREATED="1381348115413" ID="ID_1238265766" MODIFIED="1381348133285" TEXT="Use adb program"/>
<node CREATED="1381348135537" FOLDED="true" ID="ID_1671937959" MODIFIED="1389278160736" TEXT="Use phone recovery mode">
<node CREATED="1381348194627" ID="ID_953107966" MODIFIED="1381348209008" TEXT="Customize Firmware"/>
</node>
</node>
<node CREATED="1370872508712" ID="ID_1627455673" MODIFIED="1373211833328" STYLE="fork" TEXT="Baiting - &quot;Dropped/Lost&quot; USB/CD Placement">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node CREATED="1381348486671" FOLDED="true" ID="ID_222989427" MODIFIED="1389278160736" TEXT="Pharming">
<node CREATED="1381348498151" ID="ID_1098241051" MODIFIED="1381348504376" TEXT="DNS Poisoning"/>
<node CREATED="1381348526482" ID="ID_876080476" MODIFIED="1381348541932" TEXT="Change hosts File"/>
</node>
<node CREATED="1381348347999" ID="ID_115603018" MODIFIED="1381348436058" TEXT="Code Injection">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Decompile application, inject malicious code to Trojanize.
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1381510297596" ID="ID_1719588025" MODIFIED="1389725449149" TEXT="Auto Execution">
<node CREATED="1368120141025" ID="ID_20148004" MODIFIED="1378651399892" TEXT="USB Autorun"/>
<node CREATED="1370873257278" ID="ID_1682320064" MODIFIED="1378651399892" TEXT="CD Autorun"/>
<node CREATED="1381510224838" FOLDED="true" ID="ID_946996095" MODIFIED="1389278160735" TEXT="File Auto-Read">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      malicious file is sent to mail reader or text message reader and is read by default.
    </p>
  </body>
</html></richcontent>
<node CREATED="1381462717400" ID="ID_1378749611" MODIFIED="1381499465281" TEXT="Text Message Install">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      most Android malware was installed via text message.&#160; http://qz.com/131436/contrary-to-what-youve-heard-android-is-almost-impenetrable-to-malware/
    </p>
    <p>
      in 2012, half of all threats came by way of text messages installing attacking apps.
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1378651538469" ID="ID_147667751" MODIFIED="1389640331430" TEXT="Malware Instance Object Attributes">
<node CREATED="1368119900273" ID="ID_414067143" MODIFIED="1389640333189" TEXT="File Infection Method">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font size="2">REF:&#160;&#160;http://www.foocodechu.com/?q=node/54</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1373482347980" ID="ID_1853214194" MODIFIED="1389646861087" TEXT="Metamorphism (Semantic Changes)">
<node CREATED="1373482363221" ID="ID_165660042" MODIFIED="1378651399890" TEXT="Code Insertion"/>
<node CREATED="1373482373969" ID="ID_574185288" MODIFIED="1378651399890" TEXT="Code Deletion"/>
<node CREATED="1373482381535" ID="ID_523490062" MODIFIED="1378651399890" TEXT="Code Substitution"/>
<node CREATED="1373482390006" ID="ID_1299085316" MODIFIED="1378651399890" TEXT="Code Transposition"/>
<node CREATED="1381163800929" ID="ID_300924704" MODIFIED="1381163807484" TEXT="Variable Algorithm"/>
</node>
<node CREATED="1373482608894" ID="ID_1466673662" MODIFIED="1389646860025" TEXT="Polymorphism (Syntactic Changes)">
<node CREATED="1373482549399" ID="ID_1750500757" MODIFIED="1378651399891" TEXT="Code Packing"/>
<node CREATED="1381163626620" ID="ID_1551475889" MODIFIED="1381163634901" TEXT="Simple Encryption"/>
<node CREATED="1381163683936" FOLDED="true" ID="ID_1120485556" MODIFIED="1389278160734" TEXT="Morphing">
<node CREATED="1373482453605" ID="ID_815095478" MODIFIED="1378651399891" TEXT="Dead Code Insertion"/>
<node CREATED="1373482463121" ID="ID_1701374269" MODIFIED="1378651399891" TEXT="Instruction Substitution"/>
<node CREATED="1373482474680" ID="ID_103697264" MODIFIED="1378651399891" TEXT="Variable Renaming"/>
<node CREATED="1373482483056" ID="ID_329996160" MODIFIED="1378651399891" TEXT="Code Reordering"/>
<node CREATED="1373482492073" ID="ID_1325501642" MODIFIED="1378651399891" TEXT="Branch Obfuscation"/>
<node CREATED="1373482502571" ID="ID_1145437320" MODIFIED="1378651399891" TEXT="Branch Inversion and Flipping"/>
<node CREATED="1373482522023" ID="ID_1662883217" MODIFIED="1378651399891" TEXT="Branch Flipping"/>
<node CREATED="1373482534783" ID="ID_634757877" MODIFIED="1378651399891" TEXT="Opaque Predicate Insertion"/>
</node>
</node>
<node CREATED="1373554805387" ID="ID_1169905583" MODIFIED="1389646857782" TEXT="Code Addition">
<node CREATED="1368124565892" ID="ID_32959571" MODIFIED="1378651399891" TEXT="Appending"/>
<node CREATED="1368124539636" ID="ID_1652375874" MODIFIED="1378651399891" TEXT="Prepending"/>
<node CREATED="1373301762435" ID="ID_1893996664" MODIFIED="1373552530154" STYLE="fork" TEXT="Over-writing">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node CREATED="1373554846713" ID="ID_887652319" MODIFIED="1389646858801" TEXT="File Renaming">
<node CREATED="1373301770855" ID="ID_1321870047" MODIFIED="1378651900692" STYLE="fork" TEXT="Companion Virus">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
<node CREATED="1381162854927" ID="ID_984103807" MODIFIED="1381162900738" TEXT="Plurality of Environments">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Can the malware run on multiple environments?
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#cccc00" CREATED="1389647660333" ID="ID_1229394981" MODIFIED="1389727613904" POSITION="right" TEXT="Unknown">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Nodes moved from other places that don't have a clear or yet known place in the hierarchy.
    </p>
  </body>
</html>
</richcontent>
<node BACKGROUND_COLOR="#ff9900" CREATED="1382630278400" ID="ID_329451957" MODIFIED="1389711154112" TEXT="Bypass Security Filter">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Not sure where this goes? Seems to be specific to remote exploits such as SQL injection?
    </p>
  </body>
</html>
</richcontent>
<font NAME="SansSerif" SIZE="14"/>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378616606991" FOLDED="true" ID="ID_1585172695" MODIFIED="1389278201539" STYLE="fork" TEXT="Use Alternate Encoding">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      used to bypass web filters; http://books.google.com/books?id=54o232A5juIC&amp;pg=PA93&amp;lpg=PA93&amp;dq=malware+alternate+encoding&amp;source=bl&amp;ots=aSSWl62_e_&amp;sig=EJprQjUBXxsggXV5FrPf-W7bOcI&amp;hl=en&amp;sa=X&amp;ei=YAUsUvmvN4z_4AOKj4CoBA&amp;ved=0CC8Q6AEwAQ#v=onepage&amp;q=malware%20alternate%20encoding&amp;f=false
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<attribute NAME="EncodingType" VALUE="hexadecimal, octal, Unicode, base64"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1378616920866" ID="ID_214348767" MODIFIED="1378618166419" STYLE="fork" TEXT="Modify Injection String">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1378648501040" ID="ID_788602395" MODIFIED="1382626591466" STYLE="fork" TEXT="Use Bridge Building">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Use opcodes with alphanumeric bytes to write the real shellcode; used to defeat alphanumeric filters; The MAL: A Malware Analysis Lexicon, CMU.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381810801303" ID="ID_1044455511" MODIFIED="1389727575691" STYLE="fork" TEXT="Commandeer Search Engine Use">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Koobface (commandeer search engine use and direct browser to contaminated website).
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381852855269" ID="ID_1233791149" MODIFIED="1389727575709" STYLE="fork" TEXT="Install Browser Extension">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Browser extensions are used to redirect the user to a malicious URL.
    </p>
    <p>
      http://www.welivesecurity.com/2013/07/30/versatile-and-infectious-win64expiro-is-a-cross-platform-file-infector/
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381513239903" ID="ID_1040744540" MODIFIED="1389729961613" STYLE="fork" TEXT="Exploit Application/OS to Bypass Security Features">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      http://www.darkreading.com/applications/flaw-in-microsofts-hypervisor-lets-attac/223900141 (Microsoft Virtual PC versions)
    </p>
    <p>
      http://www.zdnet.com/exploit-beamed-via-nfc-to-hack-samsung-galaxy-s3-android-4-0-4-7000004510/&#160;(Android)
    </p>
    <p>
      requires a flaw in an application...
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="13"/>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381513258569" ID="ID_1945759063" MODIFIED="1381513320645" STYLE="fork" TEXT="Bypass Address Space Layout Randomization (ASLR)">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381513281528" ID="ID_724715500" MODIFIED="1381513320649" STYLE="fork" TEXT="Bypass Data Execution Prevention (DEP)">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1381513688726" ID="ID_1410902091" MODIFIED="1381513713167" STYLE="fork" TEXT="Bypass Code Signing">
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1373302041973" ID="ID_713088247" MODIFIED="1389727836923" STYLE="fork" TEXT="Self-extraction">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      self-extract to infect local host with code contained within the malware instance.
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
<font NAME="SansSerif" SIZE="12"/>
</node>
<node BACKGROUND_COLOR="#ffcc66" CREATED="1381509983210" ID="ID_1233454741" MODIFIED="1389716537238" STYLE="fork" TEXT="Sync Connection">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Infection can occur during a sync between devices.&#160;&#160;E.g., an infected PC could infect a smartphone (and vice versa).
    </p>
  </body>
</html></richcontent>
<edge COLOR="#808080" STYLE="bezier" WIDTH="thin"/>
</node>
</node>
</node>
</map>
